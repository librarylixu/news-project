<extend name="angular-base.html" />
<block name="momentjs">
    <link rel="stylesheet" href="{$Think.const.CSS_URL}my-comments.css" />
</block>
<block name="headcss">

    <style>
        .table tr td {
            border: 1px solid #ccc;
            background-color: #fff;
            padding-left: 12px;
            padding-right: 12px;
            padding-top: 6px;
            padding-bottom: 6px;
            box-sizing: border-box;
            word-break: break-all;
            line-height: 20px;
            color: #666;
        }
        i {
            font-style: normal;
        }

            i b {
                font-style: italic;
            }
    </style>
</block>
<block name="headjs">
    <script src="{$Think.const.BOOTSTRAP_URL}angular-sanitize/{$Think.const.ANGULAR_VERSION}angular-sanitize.min.js"></script>
    <script src="{$Think.const.BOOTSTRAP_URL}angular-file-upload/angular-file-upload.min.js"></script>
    <script src='{$Think.const.BOOTSTRAP_URL}textAngular/textAngular-rangy.min.js'></script>
    <script src='{$Think.const.BOOTSTRAP_URL}textAngular/textAngular-sanitize.min.js'></script>
    <script src='{$Think.const.BOOTSTRAP_URL}textAngular/textAngular.min.js'></script>
    <script>
        var _id = '{$id}';
        //存一份userid
        var _userid = "{$userid}";
    </script>
</block>
<block name="pageContent">
        <!--页头-->
        <div class="container" style="font-family: 微软雅黑;width:1040px;">
            <div class="row">
                <div class="page-header clearfix col-xs-12" style="padding:30px 30px; border-bottom-style: solid; ">
                    <h1 class="col-xs-3 text-left" style="width:100%;">
                        《<span ng-bind="project.name"></span>》
                        <small>
                            项目负责人：<span ng-bind="service.privateDateObj.usersData[project.userid].description"></span>
                        </small>
                    </h1>
                    <div class="col-xs-4 text-right noprint f-r">
                        <a ng-click="print()" class="btn btn-warning btn-sm">
                            <!-- 此处可暂时保留原方法（防止带有编辑/添加/删除等按钮） -->
                            <i class="ace-icon fa fa-print"></i>&nbsp;打印
                        </a>
                        <a ng-click="refresh()" class="btn btn-success btn-sm">
                            <!-- 此处可暂时保留原方法（防止带有编辑/添加/删除等按钮） -->
                            <i class="glyphicon glyphicon-refresh"></i>&nbsp;刷新
                        </a>
                    </div>
                </div>
            </div>
            <div class="row">
                <table class="table" style="width:1040px;">
                    <tr class="info">
                        <td colspan="5">基本信息</td>
                    </tr>
                    <tr>
                        <td class="text-right" style="width:150px"><b style="color: red;">*</b> 项目名称</td>
                        <td style="width:370px" class="text-center">
                            <span ng-bind="project.name"></span>
                        </td>
                        <td class="text-right" style="width:150px">集成项目</td>
                        <td style="width:370px" colspan="2" class="text-center">
                            <span ng-bind="project.integrate == 0?'否':'是'"></span>
                        </td>
                    </tr>
                    <tr>
                        <td class="text-right"><b style="color: red;">*</b> 当前阶段</td>
                        <td class="text-center">
                            <span ng-bind="service.privateDateObj.projectstatusData[project.statusid].name"></span>
                        </td>
                        <td class="text-right"><b style="color: red;">*</b> 项目把握度</td>
                        <td colspan="2" class="text-center">
                            <span ng-bind="project.grasp"></span>%
                        </td>
                    </tr>
                    <tr>
                        <td class="text-right">预计合同时间</td>
                        <td class="text-center">
                            <span ng-bind="formatDate(project.contracttime)"></span>
                        </td>
                        <td></td>
                        <td colspan="2"></td>
                    </tr>
                    <tr>
                        <td class="text-right">客户</td>
                        <td colspan="4" class="text-center">
                            <span ng-bind="(project.customerinfoData?project.customerinfoData:service.privateDateObj.tempcustomerinfoData[project.refcustomers]).name"></span>
                        </td>
                    </tr>
                    <tr>
                        <td class="text-right">重要联系人</td>
                        <td class="text-center">
                            <span ng-if="project.refinformant"><span ng-bind="service.privateDateObj.contactData[project.refinformant].name"></span>(职位：<span ng-bind="service.privateDateObj.contactData[project.refinformant].position"></span>;&nbsp;联系方式：<span ng-bind="service.privateDateObj.contactData[project.refinformant].mobilephone"></span>)</span>
                        </td>
                        <td class="text-right">使用者</td>
                        <td colspan="2" class="text-center">
                            <span ng-if="project.refusing"><span ng-bind="service.privateDateObj.contactData[project.refusing].name"></span>(职位：<span ng-bind="service.privateDateObj.contactData[project.refusing].position"></span>;&nbsp;联系方式：<span ng-bind="service.privateDateObj.contactData[project.refusing].mobilephone"></span>)</span>
                        </td>
                    </tr>
                    <tr>
                        <td class="text-right">技术把关者</td>
                        <td class="text-center">
                            <span ng-if="project.reftechnical"><span ng-bind="service.privateDateObj.contactData[project.reftechnical].name"></span>(职位：<span ng-bind="service.privateDateObj.contactData[project.reftechnical].position"></span>;&nbsp;联系方式：<span ng-bind="service.privateDateObj.contactData[project.reftechnical].mobilephone"></span>)</span>
                        </td>
                        <td class="text-right">决策者</td>
                        <td colspan="2" class="text-center">
                            <span ng-if="project.refdecision"><span ng-bind="service.privateDateObj.contactData[project.refdecision].name"></span>(职位：<span ng-bind="service.privateDateObj.contactData[project.refdecision].position"></span>;&nbsp;联系方式：<span ng-bind="service.privateDateObj.contactData[project.refdecision].mobilephone"></span>)</span>
                        </td>
                    </tr>
                    <tr>
                        <td class="text-right">产品决策地</td>
                        <td class="text-center">
                            <span ng-bind="decisioncityData"></span>
                        </td>
                        <td class="text-right">产品使用地</td>
                        <td colspan="2" class="text-center">
                            <span ng-bind="cityData"></span>
                        </td>
                    </tr>

                    <tr class="info">
                        <td colspan="4">关联产品</td>
                        <td class="text-right" style="border-left:hidden;">当前总价：<span ng-bind="project.allmoney | currency:'￥':0"></span>&nbsp;(<span ng-bind="toupcase(project.allmoney)"></span>)</td>
                    </tr>
                    <tr ng-if="project.__refprojectdevicelist.length">
                        <td class="text-center" style="width:10%;">序号</td>
                        <td class="text-center">产品名称</td>
                        <td class="text-center">产品型号</td>
                        <td class="text-center">数量</td>
                        <td class="text-center">总价(元)</td>
                    </tr>
                    <tr ng-if="project.__refprojectdevicelist.length<1">
                        <td colspan="5">暂无产品</td>
                    </tr>
                    <tbody ng-repeat="item in project.__refprojectdevicelist">
                        <tr>
                            <td class="text-center" style="width:10%;" ng-bind="$index+1"></td>
                            <td class="text-center" ng-bind="service.privateDateObj.productData[service.privateDateObj.productmodelData[item.productmodelid].productid].name"></td>
                            <td class="text-center" ng-bind="service.privateDateObj.productmodelData[item.productmodelid].name"></td>
                            <td class="text-center" ng-bind="item.number"></td>
                            <td class="text-center"><span ng-bind="item.money | currency:'￥':0"></span></td>
                        </tr>
                        <tr>
                            <td colspan="5" ng-bind="service.privateDateObj.productmodelData[item.productmodelid].description"></td>
                        </tr>
                    </tbody>

                    <tr class="info">
                        <td colspan="5">其他信息</td>
                    </tr>
                    <tr>
                        <td class="text-right">项目备注</td>
                        <td colspan="4">
                            <span ng-bind="project.mark"></span>
                        </td>
                    </tr>
                    <tr>
                        <td class="text-right">抄送人</td>
                        <td colspan="4">
                            <span ng-repeat="item in project.refusers">
                                <span ng-bind="service.privateDateObj.usersData[item].description"></span>
                                &nbsp; &nbsp;
                            </span>
                        </td>
                    </tr>
                    <tr>
                        <td class="text-right">附件</td>
                        <td colspan="4">
                            <span ng-repeat="item in project.refannexs.split(',');">
                                <span class="blue mousehand" ng-click="downLoad(annexData[item].idannex)">
                                    <span ng-bind="annexData[item].name"></span>
                                    <span style="color:black;">(<span ng-bind="(annexData[item].filesize/1024/1024).toFixed(1)<0.1?0.1:(annexData[item].filesize/1024/1024).toFixed(1)"></span>MB)</span>
                                </span>
                                <i ng-if="project.refannexs.split(',').length>1 && item != project.refannexs.split(',')[project.refannexs.split(',').length-1]">；</i>
                            </span>
                        </td>
                    </tr>
                    <tr class="info">
                        <td colspan="5">工单信息</td>
                    </tr>
                    <tr ng-repeat="(key,item) in workorderData">
                        <td class="text-right" ng-bind="service.privateDateObj.usersData[key].description"></td>
                        <td colspan="4">
                            <div ng-repeat="value in item">
                                <span class="blue" style="cursor:pointer;border-bottom:1px dashed #478FCA" ng-click="openwork(value)" ng-bind="value.title"></span>(<span ng-bind="formatDate(value.createtime)"></span>&nbsp;&nbsp;<span class="label" ng-class="service.privateDateObj.workerorderStatus[value.status].type" ng-bind="service.privateDateObj.workerorderStatus[value.status].name"></span>)<span ng-if="value.length>1">;&nbsp;&nbsp;</span>
                            </div>

                        </td>
                    </tr>
                    <tr ng-if="!isnullproject(workorderData)">
                        <td colspan="5">暂无工单</td>
                    </tr>
                </table>
                <!--评论组件-->
                <div page-comment />
            </div>
           


        </div>
    
</block>

<block name="scriptTemplate">

</block>

<block name="footjs">
    <script type="text/javascript" src="{$Think.const.PAGE_URL}js/Crmproject/Project/detailmodal.js"></script>
    <script type="text/javascript" src="{$Think.const.BOOTSTRAP_URL}ueditor/1.4.3.3/ueditor.config.js"></script>
    <!-- 编辑器源码文件 -->
    <script type="text/javascript" src="{$Think.const.BOOTSTRAP_URL}ueditor/1.4.3.3/ueditor.all.js"></script>
    <script type="text/javascript" src="{$Think.const.JS_URL}directive.pagecomment.js"></script>
</block>
