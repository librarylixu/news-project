var $jscomp=$jscomp||{};$jscomp.scope={};$jscomp.defineProperty="function"==typeof Object.defineProperties?Object.defineProperty:function(h,z,G){h!=Array.prototype&&h!=Object.prototype&&(h[z]=G.value)};$jscomp.getGlobal=function(h){return"undefined"!=typeof window&&window===h?h:"undefined"!=typeof global&&null!=global?global:h};$jscomp.global=$jscomp.getGlobal(this);
$jscomp.polyfill=function(h,z,G,M){if(z){G=$jscomp.global;h=h.split(".");for(M=0;M<h.length-1;M++){var R=h[M];R in G||(G[R]={});G=G[R]}h=h[h.length-1];M=G[h];z=z(M);z!=M&&null!=z&&$jscomp.defineProperty(G,h,{configurable:!0,writable:!0,value:z})}};$jscomp.polyfill("Array.prototype.fill",function(h){return h?h:function(h,G,M){var z=this.length||0;0>G&&(G=Math.max(0,z+G));if(null==M||M>z)M=z;M=Number(M);0>M&&(M=Math.max(0,z+M));for(G=Number(G||0);G<M;G++)this[G]=h;return this}},"es6-impl","es3");
var svManager={getInstance:function(){var h=window.$rdp;return h&&h.running&&h.running()?h:null}};svGlobal.getInstance=svManager.getInstance;
function connvertServer(h){var z={};z.id=h.id;z.server=h.id;z.displayName=h.displayName||h.id;if(h=h.rdp){for(var G in h)z[G]=h[G];z.user=h.username||"";z.pwd=h.password||"";z.useConsole=h.console||!1;z.legacyMode=h.leagacyMode||h.legacyMode||!1;z.server_bpp=h.color||16;z.exe=h.remoteProgram||"";z.args=h.remoteArgs||"";z.startProgram=0<z.exe.length?"app":z.command&&0<z.command.length?"shell":"noapp"}return z}
function Rdp2(h){h=svGlobal.util.getServerArgs(h);if(!h||!h.gateway)return hi5.notifications.notify({msg:__svi18n.noauth}),null;var z=h.gateway||"",G=0,M=0,R=16,Z=1==h.useSSL||"true"==h.useSSL||"on"==h.useSSL||null;h.width&&(G=parseInt(h.width,10));h.height&&(M=parseInt(h.height,10));h.color&&(R=parseInt(h.color,10));h.server_bpp&&(R=parseInt(h.server_bpp,10));h=hi5.browser.obj2url(h);null===Z&&(Z="https:"==location.protocol);return new Rdp((Z?"wss://":"ws://")+z+"/RDP?"+h,G,M,R)}
svGlobal.Rdp2||(svGlobal.Rdp2=Rdp2);
function Rdp(h,z,G,M){var R,Z;function V(a){return"on"==a||"true"==a||1==a}function oa(){var a=f.gateway;f.ongetgatewayaddress&&(a=f.ongetgatewayaddress(a));return a}function xb(){var a=hi5.storage.get("SV_CONN_SHARE_ID");a||(a=hi5.tool.uuid(),hi5.storage.set("SV_CONN_SHARE_ID",a));return a}function pa(){return m.displayName||m.server||m.symlink||m.id||"undefined"}function Ca(a,b,c){f.ontitlechange&&(a=f.ontitlechange(a,c));f.setTitle&&a&&(b=b||window,b.document.title=a)}function Wa(a,b){v?v.resize(a,
b):v=new Xa(a,b);return v}function qa(a,b){switch(a){case 16:case 8:case 24:case 32:break;case 15:return m.invitation||f.showMessage("15 bit color is not supported anymore."),!1;default:return!1}la=a;b&&(L?L.postMessage({type:0,cmd:1,data:a}):C&&C.setColor(a));return!0}function Ya(){T?(I=(m.waWidth||hi5.browser.getScreenWidth())|0,D=(m.waHeight||hi5.browser.getScreenHeight())|0):(I&=-4,D&=-4);m.minWidth&&I<m.minWidth&&(I=m.minWidth|0);m.minHeight&&D<m.minHeight&&(D=m.minHeight|0)}function ga(a,b,
c,e){I=a;D=b;Da=Ea=0;Fa=I-1;Ga=D-1;Ya();svGlobal.logger.warn("resolution changed, w:"+a+" h:"+b);v=Wa(I,D);q.setSize(I,D,T?"hidden":null);c&&(L?L.postMessage({type:0,cmd:2,data:{w:I,h:D}}):C&&C.setResolution(I,D));if(f.onresolutionchange&&!e)f.onresolutionchange(a,b)}function A(a){aa||(L?(Ha.data=a,"string"!=typeof a?L.postMessage(Ha,[a]):L.postMessage(Ha)):C.writeRawInput(a))}function Za(a){switch(a){case "\r":break;case "\n":f.writeScancode(28);break;case "\t":f.writeScancode(15);break;default:A("86"+
a)}}function Ia(a){if(f){var b=__svi18n.errorCode[a];b||(b="error "+a);if(f.onerror)f.onerror({name:a,message:b});f.displayMsg&&hi5.notifications.notify({msg:b});0<svGlobal.log&&console.error&&console.error(b)}}function Ja(a){if(f){var b=__svi18n.info[a];b||(b="info "+a);f.displayMsg&&hi5.notifications.notify({msg:b});svGlobal.logger.info(b)}}function Ka(){ha=J=!1;L?L.postMessage({type:0,cmd:3}):C&&C.resetStatus()}function yb(){var a=q.getFocused(),a=a?a.getWindow():window;return"&waWidth="+m.waWidth+
"&waHeight="+m.waHeight+"&dpWidth="+a.innerWidth+"&dpHeight="+a.innerHeight}function zb(a){var b={},c=0,e=a;this.enabled=!0;hi5.EventControl(this);var d=this,g=null,k=0,y=!0,E=!0;this.setDownload=function(a){y=a};this.setUpload=function(a){E=a};this.release=function(){b=e=a=d=null};this.read=function(g,k,e){var l=b[b[g]];if("undefined"!=typeof l){var p=l.name;if(1>l.size)f.showMessage(__svi18n.file.zero+p,null,3E3);else{var p=l.slice(k,k+e),y=new FileReader;y.onloadend=function(b){b.target.readyState==
FileReader.DONE&&(b=new Uint8Array(b.target.result),a.send(g,k,e,b,l.preferPaste),c+=e,d.fireEvent("progress",[c]))};y.readAsArrayBuffer(p)}}};this.mkdirs=function(b){d.enabled&&("/"!=b.charAt(b.length-1)&&(b+="/"),a.start([b],0,!0))};this.addFiles=function(c,g){var e=c.length;if(e&&d.enabled&&E){var l=g&&!!(Y&65536);k=Date.now();for(var y=0;y<e;y++){var p=c[y];g&&(p.preferPaste=!0);var r=p.fullPath||p.name;if(f.beforeupload&&f.beforeupload(p,r,l))return;d.fireEvent("beforeupload",[p,r,l]);r=encodeURIComponent(r);
b[r]=p}a.start(c,g);d.fireEvent("uploadstarted",[l])}};this.removeFile=function(a){e.remove(a)};this.confirmId=function(a,d,g){b[a]=d;g&&(c+=parseInt(g))};this.close=function(a){var g=!0,e={size:c,duration:Date.now()-k};if(a){var l=b[a];if(l){g=b[l].preferPaste;delete b[a];delete b[l];a=decodeURIComponent(l);if(f.onfileuploaded)f.onfileuploaded(a,g,e);d.fireEvent("fileuploaded",[a,g&&!!(Y&65536),e])}for(var y in b)return}else b={};k=c=0;d.fireEvent("uploaded",[g&&!!(Y&65536),e]);if(f.onuploaded)f.onuploaded(g&&
!!(Y&65536),e)};this.cancelAll=function(){e.cancelAll();if(f.onuploadingCancelled)f.onuploadingCancelled();d.fireEvent("uploadingCancelled");d.close()};this.list=function(a,b){g=b;e.list(a)};this.notifyFiles=function(a){g&&g(a);d.fireEvent("files")};this.download=function(){y&&e.download()}}function Ab(){function a(a,c){var b=c.length,d=new Uint8Array(2+2*b);d[0]=58;d[1]=a;for(var g,k=2,f=0;f<b;f++)g=c.charCodeAt(f),d[k++]=g&255,d[k++]=g>>8&255;A(d.buffer)}this.start=function(a,c,e){for(var b=a.length,
g=20*b+2,k=0,f=new Uint8Array(8),E=2,p,r,m;k<b;k++)g=e?g+2*(encodeURIComponent(a[k]).length+1):g+2*(encodeURIComponent(a[k].fullPath||a[k].name).length+1);g=new Uint8Array(g);g[0]=58;g[1]=0;c&&(g[1]|=128);for(k=0;k<b;k++){c=e?0:a[k].size;g[E++]=c&255;g[E++]=c>>8&255;g[E++]=c>>16&255;g[E++]=c>>24&255;4294967296>c?E+=4:(c=hi5.NumUtils.splitInt64(c).high,g[E++]=c&255,g[E++]=c>>8&255,g[E++]=c>>16&255,g[E++]=c>>24&255);e||hi5.NumUtils.toBytes(a[k].lastModified||a[k].lastModifiedDate.getTime(),f);g.set(f,
E);E+=12;c=encodeURIComponent(e?a[k]:a[k].fullPath||a[k].name);p=c.length;for(r=0;r<p;r++)m=c.charCodeAt(r),g[E++]=m&255,g[E++]=m>>8&255;E+=2}A(g.buffer)};this.send=function(a,c,e,d,g){var b=new Uint8Array(22+e);b[0]=58;b[1]=3;g&&(b[1]|=128);g=2;b[g++]=a&255;b[g++]=a>>8&255;b[g++]=a>>16&255;b[g++]=a>>24&255;b[g++]=c&255;b[g++]=c>>8&255;b[g++]=c>>16&255;b[g++]=c>>24&255;4294967296>c?g+=4:(c=hi5.NumUtils.splitInt64(c).high,b[g++]=c&255,b[g++]=c>>8&255,b[g++]=c>>16&255,b[g++]=c>>24&255);b[g++]=e&255;
b[g++]=e>>8&255;b[g++]=e>>16&255;b[g++]=e>>24&255;b.set(d,g+4);A(b.buffer)};this.remove=function(b){a(6,b)};this.list=function(b){a(5,b)};this.cancelAll=function(){a(7,"")};this.download=function(){a(136,"")}}function $a(a){H||(H=new zb(new Ab));a.setFileHandler(H)}function ab(a,b,c){var e=!1;this.exe=a;this.args=b||"";this._dir=c||"";var d=this;this.close=function(){!e&&J&&(e=!0,A("8C5"+d.exe+"\t"+d.args+"\t"+f.sessionInfo.appInfo.session))}}function La(a){var b=this;a||(a=143);this.send=function(c){var e=
!!c.buffer,d=e?c:c.getData(),g=64==a;c=e?d.length:c.getEnd()||d.length;c<d.length&&(d=e?d.subarray(0,c):d.slice(0,c));e=g?5:9;c=new Uint8Array(e+c);c[0]=a;if(g)c[1]=b.id,c[2]=b.id>>8,c[3]=b.id>>16,c[4]=b.id>>24;else for(var g=b.name,k=Math.min(g.length,8),f=0;f<k;f++)c[1+f]=g.charCodeAt(f);c.set(d,e);A(c.buffer)};this.name="";this.count=this.id=this.flags=0}function Bb(){var a=window.opener;if(a)try{if(a.__sparkUser&&a.__sparkUser.session)return a.__sparkUser;if(a.opener&&a.opener.__sparkUser.session)return a.opener.__sparkUser}catch(b){}return null}
function bb(){var a="";m&&V(m.connectif)&&m.symlink&&"sessionStorage"in window&&(a="SV_"+m.symlink,m.domain&&(a+=m.domain),m.user&&(a+=m.user));return a}function Cb(){var a=bb(),b="";a&&(b=sessionStorage[a]||"")&&(b="&preSymJoin="+b);return b}function Db(a,b){var c=0,e=q.size(),d=Array(e),g=Array(e),k=0,y=0,E=0,p=0,r=0,h=0,l="";if(a){g=v.parseMonitorDef(a);for(e=g.length;c<e;c++){var u=g[c];u[0]<E&&(E=u[0]);u[1]<p&&(p=u[1]);u[2]>r&&(r=u[2]);u[3]>h&&(h=u[3])}0>E&&(k=-E);0>p&&(y=-p);u=0>b?[E,p,r,h]:
g[b];m.width=u[2]-u[0]+1;m.height=u[3]-u[1]+1;c=q.getSurface(0);c.setMonitor(u[0],u[1],u[2],u[3]);if(k||y)for(u=c.getMousePosition(),u.left+=k,u.right+=k,u.top+=y,u.bottom+=y,c=0;c<e;c++)u=g[c],u[0]+=k,u[1]+=y,u[2]+=k,u[3]+=y;v.setMonitorLayout(g);0>b&&v.setMonitorCount(0);f.reconnectOnResize=!1;return"&monitorDef="+a+"&width="+m.width+"&height="+m.height}if(1<e&&!T){for(q.verifyMonitors();c<e;c++)u=q.getSurface(c),u=u.getMousePosition(),u.left<E&&(E=u.left),u.top<p&&(p=u.top),u.right>r&&(r=u.right),
u.bottom>h&&(h=u.bottom),d[c]=u,l&&(l+=","),l+=u.left+":"+u.top+":"+u.right+":"+u.bottom;0>E&&(k=-E);0>p&&(y=-p);for(c=0;c<e;c++){u=q.getSurface(c).getMousePosition();if(k||y)u.left+=k,u.right+=k,u.top+=y,u.bottom+=y;g[c]=[u.left,u.top,u.right,u.bottom,u.left==k&&u.top==y?1:0]}v.setMonitorLayout(g);f.reconnectOnResize=!1}l&&(svGlobal.logger.warn("MonitorDef:"+l),m.width=r-E+1,m.height=h-p+1,l="&monitorDef="+l+"&width="+m.width+"&height="+m.height);return l}function cb(){if(!J){ha=!1;T&&ga(I,D,!1,
!1);var a="";if(aa)K.init(!1,!0,!1,0);else{a=h+"&width="+I+"&height="+D+"&server_bpp="+la+"&audio="+(N.available||Ma)+Cb()+Db(m.monitorDef,m.monitor);0>h.indexOf("waWidth")&&(a+=yb());var b=new Date;m.tzOffset||(a+="&tzOffset="+b.getTimezoneOffset());a+="&time="+b.getTime();void 0==m.soundPref&&(m.soundPref=0,a+="&soundPref=0");var c="",e="";b="";for(b in da){var d=da[b];"flags"in d&&(c&&(c+=",",e+=","),c+=d.name,e+=d.flags)}c&&(a=a+("&channelName="+c)+("&channelFlags="+e));c="";for(b in ea)d=ea[b],
"flags"in d&&(c&&(c+=","),c+=d.name);c&&(a+="&gwChannelName="+c);if(d=Bb())b=d.account,d=d.session,b&&(a+="&account="+b),d&&(a+="&session="+d);b=hi5.browser.isTouch&&(1024<=window.innerWidth||768<=window.innerHeight);m.audioRecord=V(m.audioRecord)&&hi5.audio.recordable;K.init(b,!!m.remotefx,m.audioRecord,m.soundPref);m.audioRecord&&(a+="&audioRecord=on");m.decompressingRDP61&&(a+="&decompressingRDP61=on");0<K.count&&(a+="&dvcChannels="+K.names.join(","));hi5.browser.binaryWS()&&(a+="&binary=on");
t.existingFile&&(a+="&existingFile="+t.existingFile);a+="&isTouch="+b+"&gatewayAddr="+encodeURIComponent(oa());a=f.modifyURL(a);t.copyTextOnly&&V(m.mapClipboard)&&(a+="&copyTextOnly=on");(b=hi5.browser.cookie.get("__SV_TOKEN_A"))&&(a+="&__SV_TOKEN_A="+encodeURIComponent(b));(b=svGlobal.Rdp.languageToKeyboard.detect())&&(a+="&_keyboard="+b);t.numLock&&(a+="&numLock="+t.numLock);h=a}b=!0===t.updateFix;void 0==t.wsPost&&(t.wsPost=!1);L?(aa&&(aa.onopen=Na,aa.onclose=ra,aa.onmessage=function(a){Oa.data=
a.data;L.postMessage(Oa,[Oa.data])}),L.postMessage({type:0,cmd:0,data:{addr:a,width:I,height:D,server_bpp:la,libPath:hi5.libPath,libMin:hi5.libMin,updateFix:b,wsPost:t.wsPost}})):(C=new RdpGeneral(aa||a,I,D,la,v,!1,t.wsPost),b&&C.enableUpdateFix(),C.run());svGlobal.logger.info(h);L?L.addEventListener("message",db,!1):(C.onopen=Na,C.onmessage=eb,C.onclose=ra,C.onerror=Ia,C.oninfo=Ja,C.onloggedin=fb,C.onresolutionchange=function(a,b){ga(a,b,!1,m.monitorDef&&0<=m.monitor?!0:!1)},C.onAltSecWindows=gb,
C.onMoveCursor=Pa,C.onCloseSurface=hb,C.onColorChange=qa,C.onHistoryReceived=function(){Qa()},C.onLockKeyState=function(a){if(f.onLockKeyState)f.onLockKeyState(a)});if(a=q.getSurface(q.size()-1))T?a&&(a.remoteApp=new ab(m.exe,m.args,"")):Ca(pa(),a.getWindow());if(m.invitation){var g=null;a&&(g=a.initChat(m.expert));sa=new f.GatewayChannel;sa.name="C_H_A_T";sa.process=function(a){a=a.getUnicodeString(a.getEnd()-a.getPosition(),!0);g&&g.add(a,m.novice)};g&&(g.onchat=function(a){if(J){var b=Array(2*
a.length),b=new hi5.DataBuffer(b,0,b.length);b.setUnicodeString(a);b.markEnd();sa.send(b)}});f.addGatewayChannel(sa)}hi5.browser.isIE&&!ta&&(ta=hi5.browser.loadFlash(t.flash||hi5.libPath+"plugin.swf"))&&(ib=!0)}}function db(a){a=a.data;switch(a.type){case 1:switch(a.event){case 0:Na();break;case 1:ra(a.expected);break;case 2:Ia(a.code);break;case 3:Ja(a.code);break;case 4:fb();break;case 5:ga(a.w,a.h,!1,m.monitorDef&&0<=m.monitor?!0:!1);break;case 6:Pa(a.x,a.y,!0);break;case 7:hb();break;case 8:0==
a.id&&Qa();Q&&Q.check(1<a.id?15555:0);break;case 9:qa(a.color);break;case 10:if(f.onLockKeyState)f.onLockKeyState(a.state);break;default:svGlobal.logger.warn("Invalid worker event "+a.type)}break;case 2:v.setRGBs(a.x,a.y,a.w,a.h,a.pixel,a.offset,a.scansize);break;case 3:v.moveArea(a.srcx,a.srcy,a.cx,a.cy,a.dx,a.dy);break;case 5:v.fillRect(a.l,a.t,a.w,a.h,a.color);break;case 6:v.drawLine(a.x1,a.y1,a.x2,a.y2,a.color);break;case 7:v.bitBlt(a.opcode,a.dstwidth,a.x,a.y,a.cx,a.cy,a.src,a.srcwidth,a.srcx,
a.srcy);break;case 8:v.drawLineExt(a.x1,a.y1,a.x2,a.y2,a.color,a.opcode);break;case 9:jb(a);break;case 10:eb(a);break;case 11:O.attach(a.data,0,a.data.length);gb(O,a.size);break;case 12:v.drawText(a.font,a.flags,a.mixmode,a.foregroundColor,a.backgroundColor,a.clipLeft,a.clipTop,a.clipcx,a.clipcy,a.boxLeft,a.boxTop,a.boxcx,a.boxcy,a.x,a.y,a.length,a.text,a._left,a._top,a._right,a._bottom);break;case 13:v.drawBitmap(a.cacheID,a.cacheIDX,a.x,a.y,a.cx,a.cy,a.srcx,a.srcy,a.opcode);break;case 14:v.saveDesktop(a.x,
a.y,a.cx,a.cy,a.offset);break;case 15:v.restoreDesktop(a.x,a.y,a.cx,a.cy,a.offset);break;case 16:v.putFont(a.font,a.character,a.glyph);break;case 17:v.putCursor(a.idx,a.cursor);break;case 18:v.setCursor(a.idx);break;case 19:v.getHistory(A,function(){L.postMessage({type:0,cmd:7})});Q&&Q.check(15555);break;case 20:O.attach(a.data,a.off,a.data.length-a.off);v.setHistory(a.order,O);break;case 21:v.putBitmap(a.id,a.idx,a.bitmap);break;default:svGlobal.logger.warn("Invalid worker msg "+a.type)}}function kb(a){Q&&
Q.check(a)}function Na(){J=!0;if(f.onopen)f.onopen();t.joinCloseMode&&f.setJoinCloseMode(t.joinCloseMode)}function hb(){q&&q.close()}function eb(a){var b=a.data;if("string"!=typeof b){a=new Uint8Array(b);O.attach(a,0,b.byteLength);var c=O.getLittleEndian16();switch(c){case 28:a=O;b=a.getAscllString(8);c=ea[b];null!=c?c.process(a):svGlobal.logger.warn("Channel "+b+" not found");break;case 55:a=O;switch(a.getByte()){case 0:R=a.getLittleEndian16();Z=a.getLittleEndian16();ja=a.getLittleEndian32();a.skipPosition(6);
ka=a.getLittleEndian16();svGlobal.logger.info("Audio Format, tag="+R+" channels="+Z+" bitsPerSample="+ka+" samplePerSec="+ja);lb();break;case 1:Eb(a)}Q&&Q.check();break;case 56:mb(O.getUnicodeString(O.getEnd()-O.getPosition(),!1));break;case 60:nb(O);break;case 62:ob(O.getUnicodeString(O.getEnd()-O.getPosition(),!1));break;case 63:pb(O);Q&&Q.check();break;case 64:b=O;c=b.getByte();a=b.getLittleEndian32();switch(c){case 1:b=b.getAscllString();if(K[b]&&(K[b].id=a,svGlobal.logger.info("DVC create, name:"+
b+" id:"+a),K[a]=K[b],K[a].onopen))K[a].onopen();break;case 3:K[a]&&K[a].process(b);break;case 4:if(K[a]&&K[a].onclose)K[a].onclose();svGlobal.logger.info("close DVC, id:"+a)}Q&&Q.check();break;case 146:b=O;switch(b.getByte()){case 0:a=new Uint8Array(2);a[0]=146;a[1]=1;A(a.buffer);break;case 5:a=b.getByte();b=b.getLittleEndian32();0!=a||b&4||(Y^=65536,q.execute("setFeature",[Y]));break;case 6:P.remoteLockFlags=b.getLittleEndian32();P.checkLockFlags=!0;if(f.onLockKeyState)f.onLockKeyState({capsLock:0!=
(P.remoteLockFlags&4),numLock:0!=(P.remoteLockFlags&2),scrollLock:0!=(P.remoteLockFlags&1)},{capsLock:0!=(P.localLockFlags&4),numLock:0!=(P.localLockFlags&2),scrollLock:0!=(P.localLockFlags&1)});svGlobal.logger.info("remoteLockFlags: "+P.remoteLockFlags)}break;default:if(f.onunknownmessage)f.onunknownmessage(c,O);else svGlobal.logger.warn("@TODO:"+c+"\n")}}else switch(c=parseInt(b.substring(0,2),16),a=b.substring(2),c){case 0:a=h.substring(h.indexOf("?")+1);A("00"+a);A("87"+navigator.userAgent);break;
case 15:if(f){Ra=!1;ma=f.reconnectTimes;(f&&0==f.mode||V(m.connectif))&&Qa();c="";for(c in da)if((b=da[c])&&b.onopen)b.onopen();for(c in ea)if((b=ea[c])&&b.onopen)b.onopen();a&&(a=JSON.parse(a),a.capability&&f&&(f.sessionInfo.suppressOutput=a.capability.suppressOutput))}break;case 26:b=JSON.parse(a);if(f.onnotify)f.onnotify(b);if(b.name){svGlobal.logger.info("msg="+a);if(b.type&&f.onerror)f.onerror(b);a=__svi18n.errorCode["S"+b.name]||"";a+=b.message;f.showMessage(a,null)}else 0<svGlobal.log&&console.erro("No error code for message:"+
a);break;case 27:q.drawLicense(a);break;case 50:if(J)switch(b=parseInt(a.substring(0,1),10),a=a.substring(1),b){case 1:Fb(a);break;case 2:ua?(ua.type==a?f.writeRawInput("881"+a+"\t"+ua.text):f.writeRawInput("881ERROR\t"),ua=null):!(b=q.getFocused())||b.processClipReq(a)||!t.clipWarnAlways&&qb||!m||m.leagacyMode||(f.showMessage(__svi18n.info.menucopy,null,5E3),qb=!0);break;case 5:(b=q.getFocused())&&"0"!=a&&b.setIgnorePaste(!0)}break;case 51:q.setReadOnly("1"==a);break;case 54:b=a.split("\t");a=oa()+
b[0];a=f.modifyURL(a);svGlobal.logger.info("Downloading file:"+a+" name:"+b[1]+" driver:"+b[2]);f.onprintingready&&f.onprintingready({link:a,printerName:b[1],pinterDriver:b[2]})||(b=q.getFocused())&&b.showPDF(a);break;case 55:b=parseInt(a.substring(0,1),16);a=a.substring(1);switch(b){case 0:a=a.split("\t");R=parseInt(a[0],10);Z=parseInt(a[1],10);ka=parseInt(a[2],10);ja=parseInt(a[3],10);svGlobal.logger.debug("Audio Format, tag="+R+" channels="+Z+" bitsPerSample="+ka+" samplePerSec="+ja);lb();break;
case 1:Gb(a)}break;case 56:mb(a);break;case 57:b=a.split("\t");svGlobal.logger.debug(a);if(a=q.getWinById(parseInt(b[0]))){if(!q.hasApp(b[1])){(c=q.getOwnerSurface(a))&&c.railWin&&(c.railWin.appId=b[1],c.railWin.addApp(b[1]));if(f.onremoteappstart)f.onremoteappstart({id:b[1]});if(a.isVisible()&&a.titleInfo&&f.ontitlechange)f.ontitlechange(c.railWin.getFullTitle(a.id),b[1])}a.appId=b[1]}break;case 58:b=a;if(H)if(a=parseInt(b.charAt(0),10),b=b.substring(1),5==a)H.notifyFiles(JSON.parse(b));else switch(b=
b.split("\t"),a){case 1:H.confirmId(b[0],b[1],b[2]);break;case 2:H.read(b[0],parseInt(b[1],10),parseInt(b[2],10));break;case 4:H.close(b[0]);break;case 9:a='<a href="'+b[0]+'" download="'+b[1]+'" target="_blank">'+__svi18n.info.fileReady+"</a>",q.getFocused().showMessage({msg:a,title:__svi18n.info.download})}break;case 59:a=hi5.Base64.dec(a,0);Y=(new RdpBuffer(a,0,a.length)).getLittleEndian32();if(fa||!(Y&16||Y&65536))Sa=!1,H=null;Y&64&&f.showMessage(__svi18n.info.recording);H&&(H.setUpload(!(Y&128)),
H.setDownload(!(Y&131072)));q.execute("setFeature",[Y]);break;case 60:nb(b64ToBuffer(a));break;case 61:a=JSON.parse(a);switch(a.type){case 0:ga(a.width,a.height,!0,!1);qa(a.color);(b=a.server)&&f&&(f.server=a.server);rb=a.length;c=q.getFocused();T=1==a.isRail;c&&(c.setAutoScale(!T),b&&Ca(pa(),c.getWindow()),b=a.keyboard,"undefined"!=typeof b&&0==b&&c.setUnicode(!0),b=a.mapDisk)&&(Sa=!0,$a(c));if(f.onopened)f.onopened(a);break;case 1:a=a.duration;if(f.onprogress)f.onprogress(a,rb);break;case 2:2==
a.status?(Ka(),J=!0):(b=0==a.status,b==v.isPaused()||f.onsessionpause&&f.onsessionpause(b,a)||(v.pause(b),b||q.repaint(0,0,v.width-1,v.height-1),a.warn&&f.showMessage(b?__svi18n.info.sessionPaused:__svi18n.info.sessionResumed)))}break;case 62:ob(a);break;case 63:pb(b64ToBuffer(a));break;default:if(f.onunknownmessage)f.onunknownmessage(c,a);else svGlobal.logger.warn("@TODO:"+b+"\n")}}function Qa(){if(!fa&&!U&&(U=!0,f&&(t.pingInterval&&f.startPing(t.pingInterval),f.onready)))f.onready()}function Hb(a,
b){var c=0,e=!1;this.width=a;this.interval=b;var d=0;this.start=function(){e||(e=!0,c=setInterval(function(){var b=q.getFocused();b&&J&&(b=b.getThumbnail(a))&&b.length!=d&&(A("8E7"+b),d=b.length)},b))};this.stop=function(){clearInterval(c)}}function Ib(a,b){!W||W.width==a&&W.interval==b||(W.stop(),W=null);W||(W=new Hb(a,b));W.start()}function pb(a){var b=a.getAscllString(8);(b=da[b])&&b.process&&b.process(a)}function ob(a){var b=parseInt(a.substring(0,1),16),c=a.substring(1);a=!1;var e=f.sessionInfo.appInfo;
switch(b){case 0:var d=JSON.parse(c);Ka();J=!0;a=d.width;b=d.height;if(a==I&&b==D)break;ga(a,b,!1,!1);break;case 1:d=JSON.parse(c);f.sessionInfo.joinedSessions.push(d.numericId);e.sessions[d.numericId]=d.name||d.__ip;if(!e.joined||t.alertJoin)f.onsessionjoin&&(a=f.onsessionjoin(d)),a||f.showMessage(__svi18n.info.joinsession.applyArgs([d.numericId,d.__ip,d.name]));break;case 2:d=JSON.parse(c);f.sessionInfo.joinedSessions.removeElm(d.numericId);delete e.sessions[d.numericId];if(!e.joined||t.alertJoin)f.onsessionexit&&
(a=f.onsessionexit(d)),a||f.showMessage(__svi18n.info.exitsession.applyArgs([d.numericId,d.__ip,d.name]));break;case 3:d=JSON.parse(c);e.joinMode!=d.mode&&(e.joinMode=d.mode,b=hi5.$("joinSelect"))&&(b.value=d.mode);if(e.hasControl)break;e.hasControl=!0;q.setReadOnly(!1,2==d.mode);if(b=hi5.$("requestControl"))b.disabled=!0;f.ongivecontrol&&(a=f.ongivecontrol());if(a)break;f.showMessage(__svi18n.info.givecontrol,null,5E3);break;case 4:d=JSON.parse(c);q.setReadOnly(!0,2==d.mode);e.hasControl=!1;if(b=
hi5.$("requestControl"))b.disabled=!1;f.ontakebackcontrol&&(a=f.ontakebackcontrol());if(a)break;f.showMessage(__svi18n.info.nocontrol,null,5E3);break;case 5:d=JSON.parse(c);f.onrequirecontrol&&(a=f.onrequirecontrol(d));if(a)break;a=__svi18n.info.title.applyArgs([d.name,d.numericId,d.__ip]);b=__svi18n.info.recontrol;v.isPaused&&(b+="<br><br>"+(__svi18n.info.autoresume||""));hi5.notifications.notify({title:a,msg:b,cbYes:function(){f.giveControl(d.numericId);this.destroy();v.isPaused()&&f.pauseSession(f.sessionInfo.appInfo.numericId,
!1)},cbNo:function(){f.refuseControl(d.numericId);this.destroy()}});break;case 6:q.execute("setTouchRemoting",[!0]);break;case 7:d=JSON.parse(c);d.width&&d.height&&ga(d.width,d.height,!0,m.monitorDef&&0<=m.monitor?!0:!1);d.color&&(qa(d.color,!0),svGlobal.logger.warn("Color depth changed to:"+d.color));d.version&&(f.sessionInfo.protocolVersion=d.version);break;case 8:d=JSON.parse(c);Ra=!0;if(f.onrequestcredential&&f.onrequestcredential(d,P.reconnect))break;if(f.onautherror&&f.onautherror(d,P.reconnect))break;
q.getFocused().requestCredential(d,P.reconnect);break;case 9:d=JSON.parse(c);0<d.interval&&0<d.width?Ib(d.width,d.interval):W&&(W.stop(),W=null);break;case 11:d=JSON.parse(c),f.onrequirejoin&&(a=f.onrequirejoin(d)),a||(a=__svi18n.info.title.applyArgs([d.name,d.numericId,d.__ip]),hi5.notifications.notify({title:a,msg:__svi18n.info.reqjoin,cbYes:function(){f.allowJoin(d.numericId,!0);this.destroy()},cbNo:function(){f.allowJoin(d.numericId,!1);this.destroy()}}))}}function nb(a){switch(a.getByte()){case 32:if(!v.isPaused()){var b=
a.getLittleEndian16(),c=a.getLittleEndian16(),e=a.getLittleEndian16(),d=void 0,g=void 0;t.noCursorName||(d=a.getLittleEndian32(),f.sessionInfo.appInfo&&(g=f.sessionInfo.appInfo.sessions[d]));Pa(c,e,!0,g,d,b)}}}function Pa(a,b,c,e,d,g){v.isPaused()||q.getFocused().moveCursor(a,b,c,e,d,g)}function jb(a){q.setCursor(a)}function mb(a){a=JSON.parse(a);sb=a.session;a.server||(a.server=pa());var b=hi5.$("joinSelect");b&&(b.value=a.joinMode);if(b=hi5.$("requestControl"))b.disabled=a.hasControl;a.joined?q.execute("setAutoScale",
[!0]):(f.mode=0,V(m.connectif)&&q.setSize(I,D),t.disableJoinedAppResize&&(f.windowState=0));var b=t.page&&t.page.join||"join.html",c=oa(),b=c+"/"+b+"?id="+(a.joined||a.numericId),e=a.webAddress;e&&0<e.length&&e.toLowerCase()!=c.toLowerCase()&&(c=e.indexOf("://"),f.protocol="http"==e.substring(0,c)?"ws":"wss",f.gateway=e,b+="&gateway="+encodeURIComponent(e));b=f.modifyURL(b);a.joinLink=b;f.sessionInfo.appInfo=a;"isApp"in a&&T!==a.isApp&&(T=a.isApp,Ya(),q.setSize(I,D,T?"hidden":null),v=Wa(I,D),ha||
q.execute("setAutoScale",[!0]));a.ver&&a.ver!=svGlobal.version&&svGlobal.logger.warn("Client:"+svGlobal.version+" server:"+a.ver);t.cursorNameOnly=a.isAssistance;if(f.onsessionstart)f.onsessionstart(f.sessionInfo)}function Gb(a){function b(a){var b=0;a*=g;for(k=0;k<g;k++)b|=(d[a+k]&255)<<8*k;b>f?(b-=p,b/=-E):b/=f;return b}if(N.available&&!v.isPaused()){var c=a.indexOf("\t"),e=a.substring(0,c),d=hi5.Base64.dec(a,c+1);1!=R&&(na||(na=new MSGSM),d=na.decode(d,0,d.length));a=ka;var g=a>>3,k=0,f=Math.pow(2,
a-1)-1,E=-f-1,p=Math.pow(2,a);a=0;var c=Z,r=Math.floor(Math.floor(d.length/g)/c),m=N.getBuffer(r),l=m.getChannelData(0),u=m.getChannelData(1);for(a=0;a<r;){var h=2*a,q=b(h);1==c?(l[a]=q,u[a]=q):(l[a]=q,u[a]=b(h+1));a++}a=N.playBuffer(m);setTimeout(function(a){return function(){A("8A"+a)}}(e),1E3*(a-N.delay))}}function Eb(a){function b(a){return function(){A("8A"+a)}}var c=a.getByte(),e=a.getLittleEndian16(),d=Date.now();a.skipPosition(8);a=Jb(a,c,e,0);a=1E3*(a-N.delay);fa||(e+=Date.now()-d+a,setTimeout(b(c+
","+e),a))}function Jb(a,b,c,e){if(ib&&!v.isPaused()){var d=c=0,g=a.getPosition();b=a.getData();e||(e=a.getEnd()-g);var k=e;if(41222==R)(c=N.getContext())&&c.decodeAudioData(b.buffer.slice(g),function(a){a=N.playBuffer(a);fa||setTimeout(sendLater(Ja),1E3*(a-N.delay))},function(a){svGlobal.logger.warn(a)});else{if(d=1!=R)na||(na=new MSGSM),b=na.decode(b,g,k),g=0,k=b.length;var f=ka,m=f>>3,p=Math.floor(k/m),r=a=0,h=0;d||(a=Math.pow(2,f-1)-1,r=-a-1,h=Math.pow(2,f));f=Z;if(ta){g="";if(d){for(;c<k;c++)0<
c&&(g+=","),g+=b[c]+","+b[c]+","+b[c]+","+b[c];ta.write(g);return e/65*.025}for(;c<k;)0<c&&(g+=","),d=b[c++]|b[c++]<<8,9>d?d=0:d>a?(d-=h,d/=-r):d/=a,g+=d,1==f&&(g+=","+d);ta.write(g);return e/m/ja*.6}e=g;g=Math.floor(p/f);k=N.getBuffer(g);m=k.getChannelData(0);p=k.getChannelData(1);c=0;if(d)for(;c<g;)1==f?p[c]=m[c]=b[e++]:(m[c]=b[e++],p[c]=b[e++]),c++;else for(;c<g;)d=b[e++]|b[e++]<<8,d>a?(d-=h,d/=-r):d/=a,1==f?m[c]=d:(m[c]=d,d=b[e++]|b[e++]<<8,d>a?(d-=h,d/=-r):d/=a),p[c]=d,c++;return N.playBuffer(k)}}}
function lb(){L&&L.postMessage({type:0,cmd:5,data:{tag:R,channels:Z,samplePerSec:ja,bitsPerSample:ka}})}function Kb(a){if(!f.openLink||2E3<a.length)return!1;var b=a.indexOf(";");0<b&&(a=a.substring(b+1));b=a;a=a.toLowerCase();var c=0==a.indexOf("http://")||0==a.indexOf("https://")||0==a.indexOf("ftp://")||0==a.indexOf("mailto:")||0==a.indexOf("tel:")||0==a.indexOf("callto:");c||(0==a.indexOf("www.")?(c=!0,a="http://"+a):0==a.indexOf("ftp.")&&(c=!0,a="ftp://"+a));if(c){if(0<a.indexOf("\r")||0<a.indexOf("\n"))return!1;
if(f.onurlredirection&&f.onurlredirection(c))return!0;a=q.getFocused();if(!a)return!1;a.processLink(b);return!0}return!1}function Fb(a){"text/plain;"!=a&&(1666<Date.now()-P.reqCopyTime&&(f.onservercopy&&f.onservercopy(a)||Kb(a)||q.copyToClip(a)),setTimeout(function(){A("883")},999))}function fb(){if(!ha&&(setTimeout(function(){J&&A("884")},333),f.onloggedin))f.onloggedin();Ta=ha=!0;T&&q.execute("setAutoScale",[!1]);H&&(H.enabled=!0);Aa&&!T&&(v.setContext(q.getFocused().context),q.repaint(0,0,v.width-
1,v.height-1))}function ra(a){if(f){svGlobal.logger.warn("closed "+(f.sessionInfo.appInfo?f.sessionInfo.appInfo.numericId:0));var b=bb();b&&f.sessionInfo.appInfo&&0==f.mode&&(sessionStorage[b]=f.sessionInfo.appInfo.session);if(f&&(b=0==f.mode,!J&&b&&Ia("connection"),b=b&&(J||ma<f.reconnectTimes)&&0<ma&&!a,U=J=!1,b)){ma--;f.showMessage(__svi18n.info.reconnecting+" "+(f.reconnectTimes-ma)+"/"+f.reconnectTimes,null,3E3);setTimeout(cb,5);svGlobal.logger.info("Reconnecting..."+ma);return}if(Ra)svGlobal.logger.info("Req credential");
else{L&&(L.postMessage({type:0,cmd:4}),L.removeEventListener("message",db,!1));H&&(H.release(),H=null);F=h=null;K&&(K.close(),K=null);da&&hi5.Arrays.release(da);ea&&hi5.Arrays.release(ea);W&&(W.stop(),W=null);N&&(N.close(),N=null);try{if(f.onclose)f.onclose(a);else svGlobal.logger.info("onclose: null");q&&(q.close(),q=null)}catch(c){}O=null;C&&(C.onopen=null,C.onmessage=null,C.onclose=null,C.onerror=null,C.close(),C=null);q=P=null;v&&(v.release(),v=null);hi5.browser.isChromeApp?chrome.runtime.onSuspend.removeListener(f.close):
window.removeEventListener("unload",f.close,!1);f=null;window&&window.$rdp==this&&(window.$rdp=null)}}}function tb(){C&&J?C.close():ra(!0)}function gb(a,b){var c=a.getLittleEndian32();if(0!=(c&16777216)){var e=a.getLittleEndian32();if(0!=(c&1073741824)){a.getLittleEndian16();a.getByte();var c=a.getByte(),d=a.getLittleEndian16(),g=a.getLittleEndian16(),k=0;16>c&&(k=a.getLittleEndian16());var f=a.getLittleEndian16(),m=a.getLittleEndian16();a.getBytes(f);k&&a.getBytes(k);if(8<=c&&(k=q.getFocused())&&
k.onremoteappicon){f=new hi5.graphic.Bitmap(d,g,32);a.getPosition();for(var d=new Uint8Array(d*g*4),g=a.getPosition(),m=g+m,p,r=a.getData(),h=0,l,u;g<m;)switch(c){case 16:(p=r[g++]|r[g++]<<8)?(u=p>>7&248,l=p>>2&248,p=p<<3&248,u|=u>>5,l|=l>>5,p|=p>>5,d[h++]=p,d[h++]=l,d[h++]=u,d[h++]=255):h+=4;break;case 32:d[h++]=r[g++],d[h++]=r[g++],d[h++]=r[g++],d[h++]=r[g++]}f.putPixels(d,0,d.length);e=q.getWinById(e);k.onremoteappicon(e,f)}}else 0!=(c&2147483648)?svGlobal.logger.info("XXX rail cache icon, winId="+
e):0!=(c&536870912)?(svGlobal.logger.info("***** delete winId="+e),q.delWin(e)):Lb(a,c,e)}else if(0!=(c&33554432))svGlobal.logger.info("XXX Alt Sec window Notify="+c);else if(0!=(c&67108864))if(svGlobal.logger.info("*** -- Alt Sec window Desktop="+c),0!=(c&1))svGlobal.logger.info("Desktop non monitored flags="+c);else{if(0!=(c&32)&&(e=a.getLittleEndian32(),svGlobal.logger.info("Desktop monitored flags="+c+" winId="+e),q.setTitle(e),v.getContext()||(e=q.getFocused())&&v.setContext(e.context),0!=(c&
16)&&(e=a.getByte(),0<e)))for(c=q.zOrders,c.length=e,k=0;k<e;k++)c[k]=a.getLittleEndian32(),svGlobal.logger.info("---zorders:"+c[k])}else svGlobal.logger.info("XXX Alt Sec window order flgas="+c)}function Lb(a,b,c){T||(T=!0);var e=0==(b&268435456);svGlobal.logger.info("\n\n=========== winId="+c+" existed="+e);var d=q.getWinById(c);d?e=!0:d=new q.LocalWin(c);if(d){0!=(b&2)&&(d.ownerWinid=a.getLittleEndian32(),svGlobal.logger.info("***** ownerWinid="+d.ownerWinid));0!=(b&8)&&(d.style=a.getLittleEndian32(),
d.extStyle=a.getLittleEndian32(),svGlobal.logger.info("***** winId="+c+" style="+d.style+" extStyle="+d.extStyle),svGlobal.logger.info("*****--- WS_POPUP="+(0!=(d.style&2147483648))),svGlobal.logger.info("*****--- WS_DLGFRAME="+(0!=(d.style&4194304))),svGlobal.logger.info("*****--- DS_MODALFRAME="+(0!=(d.style&128))),svGlobal.logger.info("*****--- WS_EX_DLGMODALFRAME="+(0!=(d.extStyle&1))),svGlobal.logger.info("*****--- WS_EX_TOOLWINDOW="+(0!=(d.extStyle&128))),svGlobal.logger.info("*****--- WS_BORDER="+
(0!=(d.style&8388608))),svGlobal.logger.info("*****--- WS_CAPTION="+(0!=(d.style&12582912))),svGlobal.logger.info("*****--- WS_OVERLAPPED="+(0!=(d.style&0))),svGlobal.logger.info("*****--- WS_OVERLAPPEDWINDOW="+(0!=(d.style&13565952))),svGlobal.logger.info("*****--- WS_POPUPWINDOW="+(0!=(d.style&2156396544))),svGlobal.logger.info("*****--- WS_SIZEBOX="+(0!=(d.style&262144))),svGlobal.logger.info("*****--- WS_CHILD="+(0!=(d.style&1073741824))),svGlobal.logger.info("*****--- WS_SIZEBOX="+(0!=(d.style&
262144))),svGlobal.logger.info("*****--- WS_EX_MDICHILD="+(0!=(d.extStyle&64))),svGlobal.logger.info("*****--- WS_EX_LAYERED="+(0!=(d.extStyle&524288))));0!=(b&16)&&(d.setShowState(a.getByte()),svGlobal.logger.info("***** winId="+c+" showState="+d.showState),2==d.showState&&0!=t.noMinimize&&setTimeout(function(){d.exeCommand(61728)},50));var g=0!=(b&4);if(g){var k=a.getLittleEndian16();d.titleInfo=a.getUnicodeString(k,!1);svGlobal.logger.info("***** winId="+c+" title="+d.titleInfo)}0!=(b&16384)&&
(d.clientOffsetX=a.getLittleEndian32(),d.clientOffsetY=a.getLittleEndian32(),svGlobal.logger.info("***** winId="+c+" coffX"+d.clientOffsetX+" coffY="+d.clientOffsetY));0!=(b&65536)&&(d.clientAreaWidth=a.getLittleEndian32(),d.clientAreaHeight=a.getLittleEndian32(),svGlobal.logger.info("***** winId="+c+" cw"+d.clientAreaWidth+" ch="+d.clientAreaHeight));0!=(b&131072)&&(d.rpContent=a.getLittleEndian32());0!=(b&262144)&&(d.rootParentHandle=a.getLittleEndian32());if(0!=(b&2048)){var k=a.getLittleEndian32(),
f=a.getLittleEndian32();d.winOffsetX=k;d.winOffsetY=f;svGlobal.logger.info("***** winId="+c+" offX"+d.winOffsetX+" offY="+d.winOffsetY)}0!=(b&32768)&&(d.winClientDeltaX=a.getLittleEndian32(),d.winClientDeltaY=a.getLittleEndian32(),svGlobal.logger.info("***** winId="+c+" dX"+d.winClientDeltaX+" dY="+d.winClientDeltaY));0!=(b&1024)&&(d.winWidth=a.getLittleEndian32(),d.winHeight=a.getLittleEndian32(),svGlobal.logger.info("***** winId="+c+" w"+d.winWidth+" h="+d.winHeight));0!=(b&256)&&(k=a.getLittleEndian16(),
0<k&&a.skipPosition(8*k));0!=(b&4096)&&(d.visibleOffsetX=a.getLittleEndian32(),d.visibleOffsetY=a.getLittleEndian32());0!=(b&512)&&(b=a.getLittleEndian16(),d.numVisibilityRects=b,0<b&&a.skipPosition(8*b));if(e)q.onWinChange(d);else q.addWin(d);g&&q.setTitle(c)}else svGlobal.logger.warn("XXX, No win with id:"+c)}function Xa(a,b){function c(a,b,d,c,g){0<g.width?g.union(a,b,d,c):(g.x=a,g.y=b,g.width=d,g.height=c)}function e(a,b,d,g){for(L=0;L<M;L++){var n=K[L];if(a>=n[0]&&b>=n[1]&&d<=n[2]&&g<=n[3])return J[L]}return null}
function d(a,b,d,g){if(M){var n=e(a,b,a+d-1,b+g-1);n&&c(a,b,d,g,n)}else c(a,b,d,g,v)}function g(a,b,d,g,c,k,e){for(var n=c*d+g,w=a.setRGB,B=a.getRGB,x=0;x<e;x++){for(var f=0;f<k;f++){if(a){var X=B(g+f,c+x);w(g+f,c+x,~X&16777215)}else b[n]=~b[n]&16777215;n++}n+=d-k}}function k(a,b,d,g,c,k,f,e,l,r){b=r*e+l;null==f&&(f=a);for(a=0;a<k;a++){for(l=0;l<c;l++)q[g+a][d+l]=q[g+a][d+l]&f[b]&16777215|4278190080,b++;b+=e-c}}function f(a,b,d,g,c,k,f,e,l,r){b=r*e+l;l=a.setRGB;r=a.getRGB;null==f&&(f=a);for(a=0;a<
k;a++){for(var n=0;n<c;n++){var w=r(d+n,g+a);l(d+n,g+a,w|f[b]&16777215);b++}b+=e-c}}function m(a,b,d,g){var c=F;if(c){var n=c.getRGB(b,d);switch(a){case 0:c.setRGB(b,d,0);break;case 1:c.setRGB(b,d,~(n|g)&16777215);break;case 2:c.setRGB(b,d,n&~g&16777215);break;case 3:c.setRGB(b,d,~g&16777215);break;case 4:c.setRGB(b,d,16777215*(~n&g));break;case 5:c.setRGB(b,d,~n&16777215);break;case 6:c.setRGB(b,d,n^g&16777215);break;case 7:c.setRGB(b,d,~n&g&16777215);break;case 8:c.setRGB(b,d,n&g&16777215);break;
case 9:c.setRGB(b,d,n^~g&16777215);break;case 10:break;case 11:c.setRGB(b,d,n|~g&16777215);break;case 12:c.setRGB(b,d,g);break;case 13:c.setRGB(b,d,(~n|g)&16777215);break;case 14:c.setRGB(b,d,n|g&16777215);break;case 15:c.setRGB(b,d,16777215);break;default:svGlobal.logger.warn("unsupported pixel opcode: "+a),c.setRGB(b,d,g)}}}function p(a,b,d,g,c,k,f,e,l){a>e||b>l||(d=a+d-1,d>e&&(d=e),a<k&&(a=k),d=d-a+1,g=b+g-1,g>l&&(g=l),b<f&&(b=f),g=g-b+1,1>d||1>g||F.fillRect(a,b,d,g,c))}function r(a,b,d,g,c,k,
f,e,l,r,p,m){if(!(b>p||d>m)){var n=b+g-1;n>p&&(n=p);l=b<l?l:b;n=n-b+1;p=d+c-1;p>m&&(p=m);r=d<r?r:d;m=p-d+1;if(!(1>n||1>m)){p=128;var w=0;f|=4278190080;e|=4278190080;if(l==b&&r==d&&n==g&&m==c)if(0==a)for(var B=0;B<c;B++){a=d+B;for(var x=0;x<g;x++)0==p&&(w++,p=128),0!=(k[w]&p)&&(q[a][b+x]=e),p>>=1;w++;p=128;w==k.length&&(w=0)}else for(B=0;B<c;B++){a=d+B;for(x=0;x<g;x++)0==p&&(w++,p=128),q[a][b+x]=0!=(k[w]&p)?e:f,p>>=1;w++;p=128;w==k.length&&(w=0)}else if(0==a)for(B=0;B<m;B++){a=d+B;for(x=0;x<n;x++)0==
p&&(w++,p=128),b+x>=l&&a>=r&&0!=(k[w]&p)&&(q[a][b+x]=e),p>>=1;w++;p=128;w==k.length&&(w=0)}else for(B=0;B<m;B++){a=d+B;for(x=0;x<n;x++)0==p&&(w++,p=128),b+x>=l&&d+B>=r&&(q[a][b+x]=0!=(k[w]&p)?e:f),p>>=1;w++;p=128;w==k.length&&(w=0)}}}}function h(a,b,d,g,c){this.offset=a;this.baseLine=b;this.width=d;this.height=g;this.fontData=c}function l(a,b,d,g,c,k){this.data=a;this.left=g;this.top=c;this.width=b;this.height=d;this.bitsperpixel=k;this.bytesperpixel=Math.floor((k+7)/8)}function u(a,b,d,g,c,k,e,f,
l){this.cache_idx=a;this.rawData=b;this.none=!b;this.hotX=d;this.hotY=g;this.width=c;this.height=k;this.xorSize=f;this.andSize=l;this.result="";this.distance=0;this.bpp=e;this.system="";if(b){if(!this.distance){a=0;if(b){e=0;for(var n=b.length;e<n;e++)0!=b[e]&&(a+=e%c+(e/c|0))}this.distance=a}if(!this.system){a:switch(this.distance){case 507:a="text";break a;case 2046:case 4359:a="default";break a;default:a=""}this.system=a}}a="";if(!this.system&&b){e=c*k*4;a=62+e+f+l;n=new Uint8Array(a);a=new hi5.DataBuffer(n,
0,a);a.setLittleEndian16(0);a.setLittleEndian16(2);a.setLittleEndian16(1);a.setByte(c);a.setByte(k);a.setByte(0);a.setByte(0);a.setLittleEndian16(d);a.setLittleEndian16(g);a.setLittleEndian32(40+e+f+l);a.setLittleEndian32(22);a.setLittleEndian32(40);a.setLittleEndian32(c);a.setLittleEndian32(2*k);a.setLittleEndian16(1);a.setLittleEndian16(32);a.setLittleEndian32(0);a.setLittleEndian32(f+l);a.setLittleEndian32(0);a.setLittleEndian32(0);a.setLittleEndian32(0);a.setLittleEndian32(0);for(d=k-1;0<=d;d--)for(g=
0;g<c;g++)k=b[c*d+g],a.setByte(k&255),a.setByte(k>>8&255),a.setByte(k>>16&255),a.setByte(k>>24&255);a="data:image/x-icon;base64,"+hi5.Base64.enc(a.getData())}this.url=a}var q=[],t=null,v=new hi5.graphic.Rectangle(0,0,0,0),A="Uint8ClampedArray"in window,S=null,z=0,C=0,G=0,I=0,D=null,K,J,L=0,M=0;this.width=a;this.height=b;var N=!1,F=this,H={imgData:null,left:0,top:0,width:0,height:0};this.setProfiler=function(a){S=a};this.getDirtyArea=function(){return v};this.setImgRect=function(a,b,d,g){z=a;C=b;G=
d;I=g};this.parseMonitorDef=function(a){var b=a.split(","),d=b.length,g=[];if(1<d){for(var c=!1,k=0;k<d;k++){var e=b[k].split(":");if(4==e.length)g[k]=Array(5),g[k][0]=parseInt(e[0]),g[k][1]=parseInt(e[1]),g[k][2]=parseInt(e[2]),g[k][3]=parseInt(e[3]),g[k][4]=0==g[k][0]&&0==g[k][1]?1:0;else{c=!0;break}}c&&(svGlobal.logger.warn("invaiid monitorDef:"+a),g.length=0)}return g};this.setMonitorLayout=function(a){var b=a.length,d=0;K=a;for(J=Array(b);d<b;d++)J[d]=new hi5.graphic.Rectangle(0,0,0,0);M=b};
this.setMonitorCount=function(a){M=a};this.addImg=function(a){G&&(D&&URL.revokeObjectURL(D.src),D=a)};this.flushImgs=function(){D&&(URL.revokeObjectURL(D.src),D=null,G=0)};this.getData=function(){return q};this.pause=function(a){N=a};this.release=function(){v=null;hi5.Arrays.release(J);F.flushImgs();q=t=F=null;H=H.imgData=null};this.isPaused=function(){return N};this.setContext=function(d){d!=t&&(t||!d||d.createImageData(1,1).data.buffer||(A=!1),t=d,null!=t&&(H.imgData=t.createImageData(a,b)))};this.getContext=
function(){return t};this.resize=function(d,g){if(q.length!=g||q[0].length!=d){for(var c=0;c<g;c++)q[c]=new Uint32Array(d);q.length=g;F.width=a=d;F.height=b=g;null!=t&&(H.imgData=t.createImageData(a,b))}};F.resize(a,b);this.getBuffer=function(){return q};this.setRGB=function(a,b,d){q[b][a]=d|4278190080};this.getRGB=function(a,b){return q[b][a]};this.setRGBs=function(g,c,k,e,f,l,p){var n,w=g+k,x=c+e;x>b&&(x=b);if(!(g>=a)){w>=a&&(w=a);if(f.subarray)for(var B=c;B<x;B++,l+=p)q[B].set(f.subarray(l,l+k),
g);else for(var r,B=c;B<x;B++,l+=p){var X=l;r=q[B];for(n=g;n<w;n++)r[n]=f[X++]}d(g,c,k,e)}};this.moveArea=function(a,b,g,c,k,e){if(0<e){var n=a+k,f=b+e,w,l;if(q[0].set)for(l=c-1;0<=l;l--)q[f+l].set(q[b+l].subarray(a,a+g),n);else for(l=c-1;0<=l;l--){var x=q[f+l],p=q[b+l];for(w=0;w<g;w++)x[n+w]=p[a+w]}}else if(0>e)if(n=a+k,f=b+e,l=0,q[0].set)for(;l<c;l++)q[f+l].set(q[b+l].subarray(a,a+g),n);else for(;l<c;l++)for(x=q[f+l],p=q[b+l],w=0;w<g;w++)x[n+w]=p[a+w];else if(0<k)for(n=a+k,f=b+e,w=g-1;0<=w;w--)for(x=
n+w,p=a+w,l=0;l<c;l++)q[f+l][x]=q[b+l][p];else for(n=a+k,f=b+e,w=0;w<g;w++)for(x=n+w,p=a+w,l=0;l<c;l++)q[f+l][x]=q[b+l][p];d(a+k,b+e,g,c)};this.getRGBs=function(a,b,d,g,c){var k=new Uint32Array(d*g),n=a+d;g=b+g;for(var e=0;b<g;b++)k.set(q[b].subarray(a,n),e),e+=d;c(k)};this.repaint=function(d,g,c,k){var n=H.imgData.data,e=0,f,l;S&&S.begin("paint");0>d&&(c+=d,d=0);0>g&&(k+=g,g=0);d+c>a&&(c=a-d);g+k>b&&(k=b-g);var w=d+c;var p=g+k;if(A)for(n=new Uint32Array(n.buffer),l=g;l<p;l++)n.set(q[l].subarray(d,
w),e),e+=a;else{var x=4*(a-c)|0;for(l=g;l<p;l++){for(f=d;f<w;f++){var r=q[l][f];n[e++]=r&255;n[e++]=r>>8&255;n[e++]=r>>16&255;n[e++]=255}e+=x}}H.left=d;H.top=g;H.width=c;H.height=k;S&&S.end("paint");return H};this.postPaint=d;this.draw=function(a,b,d,g){if(t&&!N)if(D&&D.complete&&(t.drawImage(D,z,C,G,I),URL.revokeObjectURL(D.src),D=null),M){if(a=e(a,b,d,g),a.width)return F.repaint(a.x,a.y,a.width,a.height),a.width=0,H}else if(v.width)return F.repaint(v.x,v.y,v.width,v.height),v.width=0,H;return null};
this.fillRect=function(a,b,g,c,k){var n=a+g,e=b+c;if(q[0].fill)for(var f,l=b;l<e;l++)q[l].fill(k,a,n);else for(l=b;l<e;l++)for(f=a;f<n;f++)q[l][f]=k;d(a,b,g,c)};this.drawLine=function(a,b,d,g,c){if(b==g){if(a>d){var k=a;a=d;d=k}var e=q[b];d++;if(e.fill)e.fill(c,a,d);else for(k=a;k<d;k++)e[k]=c}else if(a==d)for(b>g&&(k=b,b=g,g=k),g++,k=b;k<g;k++)q[k][a]=c;else{var n=Math.abs(d-a),f=Math.abs(g-b);k=a;var e=b;d=d>=a?a=1:a=-1;b=g>=b?g=1:g=-1;if(n>=f){b=a=0;var l=n;var w=n/2|0;var p=f}else g=d=0,l=f,w=
f/2|0,p=n,n=f;if(!(1>n))for(n++,f=0;f<n;f++)q[e][k]=c,w+=p,w>=l&&(w-=l,k+=a,e+=g),k+=d,e+=b}};this.bitBlt=function(a,b,c,e,l,p,r,m,h,y){var n=F;switch(a){case 0:m=n.setRGB;for(n=c;n<c+l;n++)for(h=e;h<e+p;h++)m(n,h,0);break;case 1:a=r;h=y*m+h;y=n.setRGB;b=n.getRGB;null==a&&(a=n);for(n=0;n<p;n++){for(r=0;r<l;r++)y(c+l,e+p,~(b(c+l,e+p)|a[h])&16777215);h+=m-l}break;case 2:a=r;h=y*m+h;y=n.setRGB;b=n.getRGB;null==a&&(a=n);for(n=0;n<p;n++){for(r=0;r<l;r++){var w=b(c+l,e+p);y(c+l,e+p,w&~a[h]&16777215);h++}h+=
m-l}break;case 3:g(n,r,m,h,y,l,p);r?n.setRGBs(c,e,l,p,r,y*m+h,m):n.moveArea(h,y,l,p,c-h,e-y);break;case 4:g(n,null,b,c,e,l,p);k(n,b,c,e,l,p,r,m,h,y);break;case 5:g(n,null,b,c,e,l,p);break;case 6:a=r;h=y*m+h;null==a&&(a=n);for(n=0;n<p;n++){for(y=0;y<l;y++)q[e+n][c+y]=q[e+n][c+y]^a[h]&16777215|4278190080,h++;h+=m-l}break;case 7:a=r;h=y*m+h;y=n.setRGB;b=n.getRGB;null==a&&(a=n);for(n=0;n<p;n++){for(r=0;r<l;r++)w=b(c+r,e+n),y(c+r,e+n,~(w&a[h])&16777215),h++;h+=m-l}break;case 8:k(n,b,c,e,l,p,r,m,h,y);break;
case 9:a=r;h=y*m+h;y=n.setRGB;b=n.getRGB;null==a&&(a=n);for(n=0;n<p;n++){for(r=0;r<l;r++)w=b(c+r,e+n),y(c+r,e+n,w^~a[h]&16777215),h++;h+=m-l}break;case 10:break;case 11:a=r;h=y*m+h;y=n.setRGB;b=n.getRGB;null==a&&(a=n);for(n=0;n<p;n++){for(r=0;r<l;r++)w=b(c+r,e+n),y(c+r,e+n,w|~a[h]&16777215),h++;h+=m-l}break;case 12:r?n.setRGBs(c,e,l,p,r,y*m+h,m):n.moveArea(h,y,l,p,c-h,e-y);break;case 13:g(n,null,b,c,e,l,p);f(n,b,c,e,l,p,r,m,h,y);break;case 14:f(n,b,c,e,l,p,r,m,h,y);break;case 15:m=n.setRGB;for(n=
c;n<c+l;n++)for(h=e;h<e+p;h++)m(n,h,16777215);break;default:svGlobal.logger.warn("unsupported opcode: "+a)}d(c,e,l,p)};this.drawLineExt=function(a,b,g,c,k,e){if(a==g||b==c){var n;if(b==c)if(g>a){var l=g-a;if(!(1>l))for(n=0;n<l;n++)m(e,a+n,b,k)}else{if(l=a-g,!(1>l))for(n=0;n<l;n++)m(e,g+n,b,k)}else if(c>b){if(l=c-b,!(1>l))for(n=0;n<l;n++)m(e,a,b+n,k)}else if(l=b-c,!(1>l))for(n=0;n<l;n++)m(e,a,c+n,k)}else{var f=Math.abs(g-a),p=Math.abs(c-b);n=a;l=b;var r,w;var h=g>=a?r=1:r=-1;var y=c>=b?w=1:w=-1;if(f>=
p){y=r=0;var x=f;var q=f/2>>0;var u=p}else w=h=0,x=p,q=p/2>>0,u=f,f=p;if(1>f)return;for(p=0;p<=f;p++)m(e,n,l,k),q+=u,q>=x&&(q-=x,n+=r,l+=w),n+=h,l+=y}k=Math.min(a,g);a=Math.max(a,g);g=Math.min(b,c);b=Math.max(b,c);0>a-k||0>b-g||d(k,g,a-k+1,b-g+1)};this.drawText=function(a,b,g,c,k,e,l,f,h,m,y,q,u,E,ia,t,v,ya,S,za,A){var n=0;1<q?p(m,y,q,u,k,ya,S,za,A):1==g&&p(e,l,f,h,k,ya,S,za,A);for(var w=t,x=0;x<t;)switch(v[n+x]){case 255:var B=v[n+x+2];if(B>w-n){x=t=0;break}B=v.slice?v.slice(n,n+B):v.subarray(n,
n+B);ba[v[n+x+1]]=B;x+=3;t-=x;n=x;x=0;break;case 254:var X=(B=ba[v[n+x+1]])?B:null;X&&0==X[1]&&0==(b&32)&&(0!=(b&4)?ia+=v[n+x+2]:E+=v[n+x+2]);x=x+2<t?x+3:x+2;t-=x;n=x;x=0;if(!X)break;for(var Mb=X.length,ca=0;ca<Mb;ca++){B=va.getFont(a,X[ca]);if(0==(b&32)){var z=X[++ca];0!=(z&128)?(0!=(b&4)?ia+=X[ca+1]|X[ca+2]<<8:E+=X[ca+1]|X[ca+2]<<8,ca+=2):0!=(b&4)?ia+=z:E+=z}B&&(r(g,E+B.offset&65535,ia+B.baseLine&65535,B.width,B.height,B.fontData,k,c,ya,S,za,A),0!=(b&32)&&(E+=B.width))}break;default:B=va.getFont(a,
v[n+x]),0==(b&32)&&(z=v[n+ ++x],0!=(z&128)?(0!=(b&4)?ia+=v[n+x+1]|v[n+x+2]<<8:E+=v[n+x+1]|v[n+x+2]<<8,x+=2):0!=(b&4)?ia+=z:E+=z),B&&(r(g,E+B.offset&65535,ia+B.baseLine&65535,B.width,B.height,B.fontData,k,c,ya,S,za,A),0!=(b&32)&&(E+=B.width)),x++}1<q?0<u&&d(m,y,q,u):0<f&&0<h&&d(e,l,f,h)};this.drawBitmap=function(b,d,g,c,k,e,l,f,p){var n=R.getBitmap(b,d);n?(b=n.width,d=n.height,k>b&&(k=b),e>d&&(e=d),12==p?F.setRGBs(g,c,k,e,n.data,f*b+l,b):F.bitBlt(p,a,g,c,k,e,n.data,b,l,f)):svGlobal.logger.warn("Failed to get bitmap from cache, id:"+
b+" idx="+d)};this.saveDesktop=function(a,b,d,g,c){F.getRGBs(a,b,d,g,function(k){P.save(a,b,d,g,c,k)})};this.restoreDesktop=function(a,b,d,g,c){(c=P.restore(a,b,d,g,c))?F.setRGBs(a,b,d,g,c,0,d):svGlobal.logger.warn("XXX no matched desktop save.")};this.putFont=function(a,b,d){va.putFont(a,b,d)};this.putBitmap=function(a,b,d){R.putBitmap(a,b,d)};this.putCursor=function(a,b){O.set(a,b)};this.setCursor=function(a){if(!N&&-1!=a){var b=O.get(a);if(b)F.onSetCursor(b);else svGlobal.logger.warn("invalid cursor"+
a)}};var Q=0;this.isSendingHistory=function(){return 2E3>Date.now()-Q};this.getHistory=function(a,b){var d=null;S&&S.begin("his_bitmap");R.forEach(function(b,g,c){if(b){var k=0,e=0;c=0;for(var l=b.length;c<l;c++)b[c].data&&(k++,e+=b[c].data.length);if(k&&e){d=new Uint32Array(e+8*k+2);d[0]=67174429;d[1]=k;k=2;for(c=0;c<l;c++)e=b[c],e.data&&(d[k++]=g,d[k++]=c,d[k++]=e.left,d[k++]=e.top,d[k++]=e.width,d[k++]=e.height,d[k++]=e.bitsperpixel,d[k++]=e.data.length,d.set(e.data,k),k+=e.data.length);a(d.buffer)}}});
S&&S.end("his_bitmap");S&&S.begin("his_font");(d=va.toPDU())&&a(d.buffer);S&&S.end("his_font");(d=O.toPDU())&&a(d.buffer);for(var g=4,c=0,k=ba.length;c<k;c++)ba[c]&&(g+=ba[c].length+6);if(4<g){d=new Uint8Array(g);d[0]=29;d[2]=1;d[3]=7;for(var e=4,c=0,k=ba.length;c<k;c++)ba[c]&&ba[c].length&&(d[e++]=c,d[e++]=c>>8,g=ba[c].length,d[e++]=g,d[e++]=g>>8,d[e++]=g>>16,d[e++]=g>>24,d.set(ba[c],e),e+=g);a(d.buffer)}(d=P.toPDU())&&a(d.buffer);b();Q=Date.now()};this.setHistory=function(a,b){switch(a){case 4:S&&
S.begin("his_bitmap_dec");for(var d=b.getLittleEndian32(),c=0;c<d;c++){var g=b.getLittleEndian32(),k=b.getLittleEndian32(),e=b.getLittleEndian32(),f=b.getLittleEndian32(),p=b.getLittleEndian32(),r=b.getLittleEndian32(),h=b.getLittleEndian32();var m=b.getLittleEndian32();var y=new Uint32Array(b.getData().buffer,b.getPosition(),m),w=new Uint32Array(m);w.set(y);b.skipPosition(4*m);R.putBitmap(g,k,new l(w,p,r,e,f,h))}S&&S.end("his_bitmap_dec");break;case 5:va.fromStream(b);break;case 6:O.fromStream(b);
break;case 7:for(;b.has(6);)if(c=b.getLittleEndian16(),m=b.getLittleEndian32())d=b.getData().subarray(b.getPosition(),b.getPosition()+m),ba[c]=d,b.skipPosition(m);break;case 9:P.fromStream(b)}};var O=new function(){var a=[];this.set=function(b,d){a[b]=d};this.get=function(b){return a[b]};this.total=function(){return a.length};this.toPDU=function(){for(var b=2,d=2,c=0,g=0,k=a.length,e;g<k;g++)if(e=a[g])c++,d=d+7+(e.rawData?e.rawData.length:0);if(!c)return null;d=new Uint32Array(d);d[0]=100728861;d[1]=
c;for(g=0;g<k;g++)if(e=a[g])if(c=e.rawData?e.rawData.length:0,d[b++]=e.cache_idx|e.bpp<<16,d[b++]=e.hotX|e.hotY<<16,d[b++]=e.width|e.height<<16,d[b++]=e.xorSize,d[b++]=e.andSize,d[b++]=e.distance,d[b++]=c)d.set(e.rawData,b),b+=c;return d};this.fromStream=function(b){var d=b.getPosition();b=new Uint32Array(b.getData().buffer,d);for(var c=b[0],g=0,e,k,l,f,p,r,h,m,y,q,w,d=1;g<c;g++)e=b[d]&65535,k=b[d++]>>16,l=b[d]&65535,f=b[d++]>>16,p=b[d]&65535,r=b[d++]>>16,h=b[d++],m=b[d++],y=b[d++],q=b[d++],w=null,
q&&(w=new Uint32Array(q),w.set(b.subarray(d,d+q)),d+=q),k=new u(e,w,l,f,p,r,k,h,m),y&&(k.distance=y),a[e]=k}},P=new function(){function a(a,b,d,c,g,k){this.x=a;this.y=b;this.cx=d;this.cy=c;this.offset=g;this.data=k}var b=[];this.save=function(d,c,g,k,e,l){d=new a(d,c,g,k,e,l);c=0;for(g=b.length;c<g;c++)if(!b[c]){b[c]=d;return}b.push(d)};this.restore=function(a,d,c,g,k){for(var e,l=0,f=b.length;l<f;l++)if((e=b[l])&&e.x==a&&e.y==d&&e.cx==c&&e.cy==g){if(e.offset==k)return a=e.data,b[l]=null,a;svGlobal.logger.warn("TODO: offset")}return null};
this.toPDU=function(){for(var a=0,d=2,c=0,g=b.length;c<g;c++)b[c]&&(a++,d+=b[c].data.length+6);if(!a||!d)return null;var d=new Uint32Array(d),e=2;d[0]=151060509;d[1]=a;for(c=0;c<g;c++)if(a=b[c])d[e++]=a.x,d[e++]=a.y,d[e++]=a.cx,d[e++]=a.cy,d[e++]=a.offset,d[e++]=a.data.length,d.set(a.data,e),e+=a.data.length;return d};this.fromStream=function(a){a=new Uint32Array(a.getData().buffer,a.getPosition());for(var b=1,d=a[0],c,g,e,k,l,f,p,n=0;n<d;n++)c=a[b++],g=a[b++],e=a[b++],k=a[b++],l=a[b++],f=a[b++],
p=new Uint32Array(f),f=b+f,p.set(a.subarray(b,f)),b=f,this.save(c,g,e,k,l,p)}},ba=[],va=new function(){var a=[];this.putFont=function(b,d,c){a[b]||(a[b]=[]);a[b][d]=c};this.getFont=function(b,d){return a[b]?a[b][d]:null};this.toPDU=function(){var b=0,d,c,g;var e=4;for(var k,l=a.length;b<l;b++)if((g=a[b])&&g.length)for(k=g.length,d=0;d<k;d++)(c=g[d])&&(e+=15+c.fontData.length);if(5>e)return null;var f=new Uint8Array(e);e=new hi5.DataBuffer(f,0,e);f[0]=29;f[2]=1;f[3]=5;e.skipPosition(4);b=0;for(l=a.length;b<
l;b++)if((g=a[b])&&g.length)for(k=g.length,d=0;d<k;d++)if(c=g[d])e.setByte(b),e.setLittleEndian16(d),e.setLittleEndian16(c.offset),e.setLittleEndian16(c.baseLine),e.setLittleEndian16(c.width),e.setLittleEndian16(c.height),e.setLittleEndian32(c.fontData.length),e.setBytes(c.fontData);return f};this.fromStream=function(a){for(;a.has(15);){var b=a.getByte(),d=a.getLittleEndian16(),c=a.getLittleEndian16(),g=a.getLittleEndian16(),e=a.getLittleEndian16(),k=a.getLittleEndian16(),l=a.getLittleEndian32(),
l=a.getBytes(l);this.putFont(b,d,new h(c,g,e,k,l))}}},R=new function(){var a=[],b=[];this.putBitmap=function(d,c,g){if(32767==c)b[d]&&(b[d].data=null,b[d]=null),b[d]=g;else{var e=a[d];e?e[c]&&(e[c].data=null,e[c]=null):a[d]=e=[];e[c]=g}};this.getBitmap=function(d,c){return 32767==c?b[d]:a[d]?a[d][c]:null};this.forEach=function(b){for(var d=a.length,c=0;c<d;c++)b(a[c],c,a)}}}this.displayMsg=this.reconnectOnResize=!0;this.appTimeout=1600;this.reconnectTimes=0;this.windowState=3;this.setTitle=this.openLink=
!0;this.audioBuffer=0;this.sessionInfo={domain:"",userName:"",sessionId:0,joinedSessions:[],suppressOutput:!1,appInfo:null};this.mode=0;this.remoteAppLogin=!0;var Aa=!1,da={},ea={},sa=null,f=this,Ra=!1,U=!1,Y=0,ta=null,ua=null,t=hi5.appcfg||{img:{},toolbar:{fadable:!0}};this.setConfig=function(a){t=a};var aa="object"==typeof h?h:null,m=aa?{}:hi5.tool.queryToObj(h.substring(h.indexOf("?")+1)),I=0,D=0,la=(M||m.color||m.server_bpp||16)|0,na=null,ub=null,Q=null,Ma=hi5.browser.isIE||hi5.browser.isEdge;
this.protocol=aa?"":h.substring(0,h.indexOf("://")).toLowerCase();this.setProfiler=function(a){ub=a};this.getProfiler=function(){return ub};this.gateway=function(){if(aa)return"";var a=h.lastIndexOf("/RDP?");-1==a&&(a=h.lastIndexOf("/JOIN?"));-1==a&&(a=h.lastIndexOf("/PLAY?"));return h.substring(0,a).replace(/wss\:\/\//ig,"https://").replace(/ws\:\/\//ig,"http://")}();svGlobal.logger.warn("Ver:"+svGlobal.version+" build:"+svGlobal.build);this.getGatewayAddr=oa;var fa="object"==typeof h||0<h.indexOf("/PLAY?"),
vb=!fa&&0<h.indexOf("invitation=");if(vb){var Ua=decodeURIComponent(h),wa=Ua.indexOf(' USERNAME="');if(0<wa){var wa=wa+11,wb=Ua.substring(wa,Ua.indexOf('"',wa));h+="&novice="+wb+"&server="+wb}h+="&mapClipboard=on";m.mapClipboard="on"}if(fa)this.mode=1,aa?h="":(I=640,D=480),h+="&touchpad=on",m.touchpad="on",this.reconnectOnResize=!1;else if(0<h.indexOf("/JOIN?")||vb)this.mode=2,this.reconnectOnResize=!1;z?I=parseInt(z):m.width&&(I=parseInt(m.width));G?D=parseInt(G):m.height&&(D=parseInt(m.height));
-1==I&&(I=hi5.browser.getScreenWidth());-1==D&&(D=hi5.browser.getScreenHeight());m.symlink&&m.parameters&&hi5.tool.queryToObj(m.parameters,m);m.gateway||(h+="&gateway="+encodeURIComponent(f.gateway));!m.minWidth&&t.minWidth&&(rdArgs.minWidth=t.minWidth);!m.minHeight&&t.minHeight&&(rdArgs.minHeight=t.minHeight);m.minWidth&&(m.minWidth=parseInt(m.minWidth));m.minHeight&&(m.minHeight=parseInt(m.minHeight));m.waWidth=m.waWidth?parseInt(m.waWidth):hi5.browser.isAndroid||hi5.browser.isiOS?Math.max(screen.width,
screen.height):screen.width;m.waWidth&=-4;m.waHeight=m.waHeight?parseInt(m.waHeight):hi5.browser.isAndroid||hi5.browser.isiOS?Math.max(screen.width,screen.height):screen.height;m.waHeight&=-4;"useSSL"in m||(h+="&useSSL="+("wss"==f.protocol));hi5.storage.isAvailable&&(V(m.shareClipboard)||m.shareClipboardId)&&(h+="&shareClipboardId="+(m.shareClipboardId||xb()));t&&(void 0!=t.displayMsg?this.displayMsg=t.displayMsg:t.displayMsg=this.displayMsg,t.appTimeout&&(this.appTimeout=t.appTimeout),void 0!=t.reconnectOnResize&&
(this.reconnectOnResize=t.reconnectOnResize),t.reconnectTimes&&(this.reconnectTimes=t.reconnectTimes),void 0!=t.windowState&&(this.windowState=t.windowState),void 0!=t.openLink&&(this.openLink=t.openLink),void 0!=t.setTitle&&(this.setTitle=t.setTitle),t.audioBuffer&&(this.audioBuffer=t.audioBuffer),"boolean"==typeof t.useWSS&&(h=(t.useWSS?"wss":"ws")+h.substring(h.indexOf("://"))),"boolean"==typeof t.remoteAppLogin&&(this.remoteAppLogin=t.remoteAppLogin,Aa=!t.remoteAppLogin,svGlobal.logger.warn("remoteAppLogin deprecated, use hideLogin in appcfg.js instead")),
"boolean"==typeof t.hideLogin&&(Aa=t.hideLogin));V(m.nocurosr);var T="app"==m.startProgram,Sa=V(m.mapDisk),H=null;T&&(this.reconnectOnResize=!1);void 0==t.useWorker&&(t.useWorker=!0);t.useWorker&&(!window.Worker||hi5.browser.isFirefox||T&&!Ma||"file:"==location.protocol||0<navigator.userAgent.indexOf("MSIE 10."))&&(t.useWorker=!1);void 0==hi5.libMin&&(hi5.libMin=!0);var L=t.useWorker?new Worker(hi5.libPath+(t.rdpworker||(hi5.libMin?"rdpworker_min.js":"rdpworker.js"))):null,ma=this.reconnectTimes,
Ha=L?{type:5,data:null}:null;this.getDisplayName=pa;this.server=pa();this.port=parseInt(m.port,10);this.loadbalanceToken=t.loadbalanceTokenName?t.loadbalanceTokenName+"="+hi5.tool.uuid():"";this.modifyURL=function(a){f.loadbalanceToken&&(a+="&"+f.loadbalanceToken);return a};this.getURL=function(){return h};this.getColor=function(){return la};this.changeTitle=Ca;hi5.browser.isTouch&&Math.max(I,D)>Math.max(window.innerWidth,window.innerHeight)&&(this.reconnectOnResize=!1);this.isRemoteApp=function(){return T};
var C=null,J=!1,ha=!1,Ta=!1,N=new function(a){var b=null;this.available=!1;this.delay=a;this.supportWebAudio=!1;if(0==m.playSound||0<f.mode)if(b=hi5.audio.getAudioContext())this.supportWebAudio=this.available=!0;this.getContext=function(){return b};this.getBuffer=function(a){return b.createBuffer(2,a,ja)};var c=0,e=null,d=null;this.setVolume=function(a){1==a?e=null:(e||(e=b.createGain()),e.gain.value=a)};this.playBuffer=function(g){d=b.createBufferSource();d.buffer=g;e?(d.connect(e),e.connect(b.destination)):
d.connect(b.destination);var k=b.currentTime,f=0<c?c:k+a;f<k&&(f=k);c=f+g.duration;d.start?d.start(f):d.noteOn(f);return c-k};this.iOSFix=function(){if(b&&hi5.browser.isTouch&&hi5.browser.isSafari){var a=this.getBuffer(1024),d=b.createBufferSource();d.buffer=a;d.connect(b.destination);d.start?d.start(0):d.noteOn(0)}};this.close=function(){b&&(e&&e.disconnect(),d&&d.disconnect(),hi5.audio.releaseAudioContext())}}(f.audioBuffer),ib=N.available,v=new Xa(200,200);v.onSetCursor=jb;this.setVolume=function(a){N&&
N.setVolume(a)};this.setAudioBuffer=function(a){f.audioBuffer=a;N.delay=a};var Ea=0,Da=0,Fa=I-1,Ga=D-1,sb="";window.$rdp=this;qa(la);this.running=function(){return J};this.setJoinMode=function(a){J&&A("8E1"+a)};this.setJoinCloseMode=function(a){J&&A("8EB3\t"+a)};this.refuseControl=function(a){J&&A("8E3"+a)};this.giveControl=function(a){J&&A("8E4"+a)};this.pauseSession=function(a,b){J&&A("8EB"+(b?1:0)+"\t"+a)};this.closeSession=function(a){J&&A("8EB2\t"+a)};this.requestControl=function(){J&&A("8E2")};
this.saveSession=function(a){J&&A("8E9"+(a.save?1:0)+"\t"+(a.timeout||0)+"\t"+(a.id||0))};this.allowJoin=function(a,b){J&&A("8EA"+a+"\t"+(b?1:0))};var Ba=new function(){function a(){if(c&&0<c.length){var b=c.shift();b.key?Ba.sendSingleKey(b.down,b.key):b["char"]&&Za(b["char"]);0<c.length?setTimeout(a,e):(d&&d(),c=null)}}var b={" ":57,space:57,pgup:201,pageup:201,pgdn:209,pagedown:209,end:207,home:199,left:203,up:200,right:205,down:208,printscreen:183,insert:210,del:211,"delete":211,altgr:184,windows:219,
windowsright:220,context:221,esc:1,backspace:14,tab:15,enter:28,meta:29,command:29,ctrl:29,shift:42,alt:56,capslock:58,f1:59,f2:60,f3:61,f4:62,f5:63,f6:64,f7:65,f8:66,f9:67,f10:68,f11:87,f12:88,numlock:69,scrolllock:70,add:78};this.sendSingleKey=function(a,d){var c=b[d.toLowerCase()];c?f.writeScancode(a,c):(c=d.length,0!=c&&(1==c?f.writeKeyCode(a,d.toUpperCase().charCodeAt(0)):a&&f.writeText(d)))};var c=null,e=0,d=null;this.sendKeyComb=function(b,k,f){if(U){b=b.split("+");var g=b.length,p;if(0!=g){var r=
null,h=[];for(p=0;p<g;p++){var l=b[p];""==l&&""==r&&(l="Add");""!=l&&h.push({key:l,down:!0});r=l}g=h.length;for(p=g-1;0<=p;p--)h.push({key:h[p].key,down:!1});if(k)c=h,e=k,d=f,a();else for(p=0,g=h.length;p<g;p++)Ba.sendSingleKey(h[p].down,h[p].key)}}};this.sendText=function(b,k,f){for(var g=[],p=0,r=b.length;p<r;p++)g.push({"char":b.charAt(p)});c=g;e=k;d=f;a()}};this.writeKeyComb=function(a,b,c){U&&Ba.sendKeyComb(a,b,c)};this.writeText=function(a,b,c){if(U)if(b)Ba.sendText(a,b,c);else for(b=0,c=a.length;b<
c;b++)Za(a.charAt(b))};this.writeClipboard=function(a,b){a&&(b||(b="text/plain"),f.writeRawInput("880"+b+"\t"+a.hashCode()),ua={type:b,text:a})};var q=new function(a,b){function c(){function b(a){for(;0<a.ownerWinid;){var b=p.getWinById(a.ownerWinid);if(b&&b.isVisible())a=b;else break}return a}function c(a){for(var b="";a;)a.titleInfo&&(b=a.titleInfo),a=p.getWinById(a.ownerWinid);return b}var e=[],f=[],h=0,p=this;this.mainWin=null;this.appId="";this.onchange=function(b){b.isVisible()||b!=p.mainWin?
b.isVisible()&&!p.mainWin&&b.isMainWin()&&(p.mainWin=b,a.windowState&&b.exeCommand(61488)):p.mainWin=null};this.addWin=function(b){for(var d=e.length,c=!1,g=0;g<d;g++)if(b.id==e[g].id){e[g]=b;c=!0;break}c||e.push(b);1==e.length&&(h=Date.now());0<a.windowState&&(d=b.isMainWin(),svGlobal.logger.info("is main win:"+d+" id:"+b.id),d&&!p.mainWin&&(p.mainWin=b))};this.popWins=function(a){a=p.getWinById(a);var b=[];if(a){a=0<a.ownerWinid?a.ownerWinid:a.id;for(var d=e.length-1;0<=d;d--)if(e[d].ownerWinid==
a||e[d].id==a)b.push(e[d]),e.splice(d,1)}return b};this.hasApp=function(a){return-1!=f.indexOf(a)};this.addApp=function(a){return-1==f.indexOf(a)?(f.push(a),!0):!1};this.isNew=function(){return 3E4>Date.now()-h};this.getAll=function(){return e};this.hasWin=function(a){return 0<=e.indexOf(a)};this.close=function(){for(var a=0,b=e.length;a<b;a++)e[a].close()};this.clear=function(){e.length=0};this.delWin=function(a){for(var b=0,d=e.length;b<d;b++)if(e[b].id==a)return e.splice(b,1),b;return-1};this.isRunning=
function(){var a=e.length;if(1>a)return!1;for(var b=0,a=e.length;b<a;b++){var d=e[b];if(d.isVisible())return!0}return!1};this.getWinById=function(a){var b=e.length;if(1>b)return null;for(var d=0;d<b;d++){var c=e[d];if(c.id==a)return c}return null};this.getMainWinByAppId=function(a){var b=null,d=0;for(len=e.length;d<len;){b=e[d];if(b.appId==a&&b.isVisible()&&1>b.ownerWinid)break;d++}return b};this.getTopWin=function(a){var b=null,d,c=a.length;for(d=0;d<c&&(!(b=p.getWinById(a[d]))||!b.isVisible());d++)b=
null;if(!b)for(svGlobal.logger.warn("No win found"),c=e.length,d=c-1;0<=d&&(b=e[d],!b.isVisible());d--)b=null;return b};this.getMain=function(a){return(a=p.getTopWin(a))?b(a):null};this.getOtherApps=function(a,d,g){var k=e.length;if(0!=k&&e[k-1])if(k=e[k-1].appId,g||!k)setTimeout(function(){p.getOtherApps(a,d)},g||3E3);else{g=[];if(k=p.getTopWin(a)){for(var f=0<k.ownerWinid?k.ownerWinid:k.id,l=[],h=0,k=e.length;h<k;h++)e[h].ownerWinid!=f&&e[h].id!=f&&e[h].isVisible()&&l.push(e[h]);h=0;for(k=l.length;h<
k;h++)l[h].ownerWinid!=f&&l[h].id!=f&&(g.push({title:c(l[h]),win:b(l[h])}),f=0<l[h].ownerWinid?l[h].ownerWinid:l[h].id)}d(g)}};this.getFullTitle=function(a){for(var b,d="";;){b=p.getWinById(a);if(!b)break;b.titleInfo&&b.isVisible()&&(d&&(d=" > "+d),d=b.titleInfo+d);if(1>a)break;a=b.ownerWinid}return d}}var e=[];a.isRemoteApp();this.verifyMonitors=function(){var a=e[0].getMousePosition(),b,c=e.length;e[0].configMonitor();for(b=1;b<c;b++){e[b].configMonitor();var f=e[b].getMousePosition();Math.abs(f.left)+
Math.abs(f.top)<Math.abs(a.left)+Math.abs(a.top)&&(a=f)}0!=a.left&&(a.right-=a.left,a.left=0);0!=a.top&&(a.bottom-=a.top,a.top=0);for(b=0;b<c;b++)if(f=e[b].getMousePosition(),f!=a){if(0>f.right){var h=-f.right-1;0<h&&(f.left+=h,f.right+=h)}f.left>a.right&&(h=f.left-a.right-1,0<h&&(f.left-=h,f.right-=h));0>f.bottom&&(h=-f.bottom-1,0<h&&(f.top+=h,f.bottom+=h));f.top>a.bottom&&(h=f.top-a.bottom-1,0<h&&(f.top-=h,f.bottom-=h))}};this.repaint=function(a,b,c,f){for(var d=0,g=e.length;d<g;d++)e[d].repaint(a,
b,c,f)};this.size=function(){return e.length};this.getSurface=function(a){return e[a]};this.addSurface=function(a){e.push(a)};this.hasSurface=function(a){for(var b=e.length,d=0;d<b;d++)if(e[d].equals(a))return!0;return!1};this.fromSyncedSurface=function(a){var b=e.length;Date.now();for(var d=0;d<b;d++)if(e[d].isClipSynced(a))return!0;return!1};this.setSize=function(a,b,c){for(var d=0,g=e.length;d<g;d++)e[d].setSize(a,b,c)};this.zOrders=[];this.drawLicense=function(a){for(var b=0,d=e.length;b<d;b++)e[b].drawLicense(a)};
this.setReadOnly=function(a,b){for(var d=0,c=e.length;d<c;d++)e[d].setReadOnly(a,b)};this.setVisible=function(a,b){svGlobal.logger.info("TODO: setVisible")};this.copyToClip=function(a){1>e.length||e[0].copyToClip(a)};this.setCursor=function(a){for(var b=0,d=e.length;b<d;b++)e[b].setCursor(a)};this.hide=function(a){a=0;for(var b=e.length;a<b;a++)e[a].hide()};this.execute=function(a,b){for(var d=0,c=e.length;d<c;d++)e[d][a].apply(e[d],b)};this.addWin=function(d){var g=this.getFocused();g||(svGlobal.logger.warn("Focused surface not found!"),
g=e[e.length-1]);g?(g.railWin||(g.railWin=new c,g.onunload=function(){hi5.appcfg.closeRemoteApp&&g.railWin&&g.railWin.close();g.remoteApp&&g.remoteApp.close();g.railWin&&(g.railWin.clear(),g.railWin=null);e.removeElm(g)}),g.context&&b.setContext(g.context),g.railWin.addWin(d),a.windowState&&g.railWin.mainWin==d&&setTimeout(function(){var b=g.getFreeSpace();a.writeRawInput("8C661441\t"+b.width+"\t"+b.height);setTimeout(function(){d.exeCommand(61488)},50)},111),Ma&&g.focus()):svGlobal.logger.warn("No surface available!")};
this.delWin=function(b){for(var d,c=e.length-1;0<=c;c--){var f=e[c];d=f.railWin;var h=d.getWinById(b),p=h&&h.appId&&-1!=h.appId.toLowerCase().indexOf("runonce");if(0<=d.delWin(b))if(h==d.mainWin&&(d.mainWin=null),d.isRunning())null==d.mainWin&&(f=d.getMain(q.zOrders))&&(d.mainWin=f,a.windowState&&f.exeCommand(61488));else{if(h.isMainWin()&&f.onremoteappclose)f.onremoteappclose(h);h=a.appTimeout;if(p||d.isNew())h*=10;svGlobal.logger.debug("Prepare del:"+Date.now());setTimeout(function(a){return function(){svGlobal.logger.info("Start del:"+
Date.now());a.railWin&&a.railWin.isRunning()||(a.remoteApp&&a.remoteApp.close(),q&&q.delSurface(a))}}(f),h)}}};this.popWins=function(a){return e[0]&&e[0].railWin?e[0].railWin.popWins(a):[]};this.getWinById=function(a){for(var b,d=0,c=e.length;d<c;d++)if(e[d].railWin&&(b=e[d].railWin.getWinById(a)))return b;return null};this.getMainWinByAppId=function(a){for(var b,d=0,c=e.length;d<c;d++)if(e[d].railWin&&(b=e[d].railWin.getMainWinByAppId(a)))return b;return null};this.onWinChange=function(a){for(var b,
d=0,c=e.length;d<c;d++)if(e[d].railWin&&(b=e[d].railWin.getWinById(a.id)))e[d].railWin.onchange(a)};this.setTitle=function(b){for(var d,c=0,f=e.length;c<f;c++)if(e[c].railWin){d=e[c].railWin.getWinById(b);var h=e[c].railWin.getFullTitle(b);if(h){a.changeTitle(h,e[c].getWindow(),d.appId);break}}};this.hasApp=function(a){for(var b=0,d=e.length;b<d;b++)if(e[b].railWin.hasApp(a))return!0;return!1};this.delSurface=function(b){!b||b.railWin&&b.railWin.isRunning()||(svGlobal.logger.info("delete surface..."),
e.removeElm(b),b.close(),0==e.length&&a._unload())};this.getOwnerSurface=function(a){for(var b=0,d=e.length;b<d;b++)if(e[b].railWin&&e[b].railWin.hasWin(a))return e[b];return null};this.getFocused=function(){for(var a=e.length,b=0;b<a;b++)if(e[b].focused)return e[b];return e[a-1]};this.close=function(){for(var a=0,b=e.length;a<b;a++)e[a]&&(e[a].remoteApp&&e[a].remoteApp.close(),e[a].close(),e[a]=null)};this.LocalWin=function(b){function d(){a.writeRawInput("8C0"+b)}this.id=b;this.appId="";var c=this;
this.resizable=function(){return 0!=(c.style&262144)||0!=(c.style&65536)||0!=(c.style&16777216)||3==c.showState};this.setShowState=function(a){c.showState=a};this.parent=function(){return q.getWinById(c.ownerWinid)};this.resize=function(b,d,e,g){hi5.appcfg.disableJoinedAppResize&&2==a.mode||a.writeRawInput("8C1"+c.id+"\t"+b+"\t"+d+"\t"+e+"\t"+g)};this.exeCommand=function(d){a.writeRawInput("8C4"+b+"\t"+d)};this.activate=function(d){2==c.showState?(c.exeCommand(61728),setTimeout(function(){a.writeRawInput("8C3"+
b+"\t"+d)},50)):a.writeRawInput("8C3"+b+"\t"+d)};this.close=function(){c.exeCommand(61536)};this.getAppId=d;this.isVisible=function(){return c.winWidth&&c.winHeight&&c.showState&&45<c.winHeight&&45<c.winWidth};this.isMainWin=function(){if(!(c.winWidth&&c.winHeight&&45<c.winHeight&&45<c.winWidth))return!1;var a=1>c.ownerWinid;if(!a)return a;var b=c.style;if(0!=(b&4194304))return!0;if(0!=(b&2147483648)&&(0==(b&8388608)||0==(b&12582912)))return!1;var d=0!=(c.extStyle&128);(a=a&&!d)&&0!=(b&2147483648)&&
0==(b&2156396544)&&(a=!1);return a};d()}}(f,v);this.getSurfaces=function(){return q};this.hide=function(){q&&q.hide()};this.getFileUrl=function(a){return f.modifyURL(oa()+"/DOWNLOAD?s="+sb+"&f="+a)};this.listFiles=function(a,b){H&&U&&H.list(a,b)};this.writeRawInput=function(a){if(U&&(A(a),f.onactivity))f.onactivity(a)};var P=new function(a,b,c){this.setJoinMode=a.setJoinMode;this.requestControl=a.requestControl;this.writeKeyComb=a.writeKeyComb;this.writeText=a.writeText;this.remoteLockFlags=this.localLockFlags=
0;this.checkLockFlags=!0;this.reqCopyTime=0;this.draw=c.draw;var e=a.isRemoteApp();this.refresh=function(a,b,d,e){return c.repaint(a,b,d-a+1,e-b+1)};this.getAppMode=function(){return a.mode};this.send=a.writeRawInput;this.saveSession=function(b){a.saveSession(b)};this.sendInput=a.writeRawInput;var d=null;this.getAppInfo=function(){return a.sessionInfo.appInfo};this.onresize=function(b){if(b=b.target.svSurface){b=b.getFreeSpace();var c=b.width,g=b.height;e?a.writeRawInput("8C661441\t"+c+"\t"+g):a.reconnectOnResize&&
a.running()&&(d&&(clearTimeout(d),d=0),d=setTimeout(function(){a.reconnect(c,g)},555))}};this.onorientationchange=function(b){a.reconnectOnResize?a.reconnect(b.innerWidth,b.innerHeight):e&&b.svSurface&&a.windowState&&a.writeRawInput("8C661441\t"+b.innerWidth+"\t"+b.innerHeight)};this.getClipData=function(b,d){this.reqCopyTime=Date.now();var c=hi5.httpGet(a.modifyURL(a.getGatewayAddr()+"/CLIP?s="+a.sessionInfo.appInfo.session+"&t="+Date.now()+"&type="+b),d);this.reqCopyTime=Date.now();return c};this.onfocus=
function(d){var g=d.target;e&&g.svSurface&&g.svSurface.railWin&&(d=g.svSurface.railWin.getTopWin(b.zOrders))&&a.running()&&(g=g.svSurface.context)&&g!=c.getContext()&&(c.setContext(null),d.activate(1),svGlobal.logger.info("Activate win:"+d.id))};this.getShareFiles=a.listFiles;this.getFile=function(b){a.reconnectOnResize=!1;var d=a.getFileUrl(b);f.ondownload&&f.ondownload({fileName:b,url:d})||window.open(d)};this.getFileLink=a.getFileUrl;this.getGateway=function(){return h};this.reconnect=function(b,
d,c){m.symlink?(b="user="+b+"&pwd="+d,c&&(b+="&domain="+c),h=hi5.tool.replaceQuery(h,"parameters",b)):(h=hi5.tool.replaceQuery(h,"user",b),h=hi5.tool.replaceQuery(h,"pwd",d),h=hi5.tool.replaceQuery(h,"domain",c));a.run()};this.sendKeyboardSyncFlags=function(b){a.writeRawInput("8E5"+b);this.remoteLockFlags=this.localLockFlags=b};this.sendKeyboardSynchronize=function(a,b,d){var c=0;d&&(c|=4);b&&(c|=2);a&&(c|=1);this.sendKeyboardSyncFlags(c)};this.fromSyncedSurface=function(a){return b.fromSyncedSurface(a)}}(f,
q,v);this.sendKeyboardSynchronize=function(a,b,c){P.sendKeyboardSynchronize(a,b,c)};var F=null,K={count:0,names:[],close:function(){for(var a=K.names,b=0,c=a.length;b<c;b++)K[a[b]].onclose&&(K[a[b]].onclose(),K[a[b]]=null);a.length=0},init:function(a,b,c,e){function d(){this.WAVE_FORMAT_PCM=1;this.WAVE_FORMAT_ADPCM=2;this.WAVE_FORMAT_ALAW=6;this.WAVE_FORMAT_MULAW=7;this.WAVE_FORMAT_GSM=49;this.WAVE_FORMAT_MPEGLAYER3=85;this.WAVE_FORMAT_AAC=41222;this.bitsPerSample=this.nBlockAlign=this.nAvgBytesPerSec=
this.nSamplesPerSec=this.nChannels=this.formatTag=0;this.hasLocalSupport=!1;this.cbSize=0;this.extenstion=null;var a=this;this.fromBuffer=function(b){a.formatTag=b.getLittleEndian16();a.nChannels=b.getLittleEndian16();a.nSamplesPerSec=b.getLittleEndian32();a.nAvgBytesPerSec=b.getLittleEndian32();a.nBlockAlign=b.getLittleEndian16();a.bitsPerSample=b.getLittleEndian16();var d=b.getLittleEndian16();a.cbSize=d;0<d&&(a.extenstion=Array(d),b.copyToByteArray(a.extenstion,0,b.getPosition(),d),b.skipPosition(d))};
this.toBuffer=function(b){b.setLittleEndian16(a.formatTag);b.setLittleEndian16(a.nChannels);b.setLittleEndian32(a.nSamplesPerSec);b.setLittleEndian32(a.nAvgBytesPerSec);b.setLittleEndian16(a.nBlockAlign);b.setLittleEndian16(a.bitsPerSample);b.setLittleEndian16(a.cbSize);0<a.cbSize&&b.setBytes(a.extenstion)};this.getSize=function(){return 18+a.cbSize};this.toString=function(){return"Audio Format, tag="+a.formatTag+" nChannels="+a.nChannels+" nSamplesPerSec="+a.nSamplesPerSec+" nAvgBytesPerSec"+a.nAvgBytesPerSec+
" nBlockAlign"+a.nBlockAlign+" bitsPerSample"+a.bitsPerSample+" cbSize="+a.cbSize}}function g(){F=new f.DynamicChannel;F.name="Microsoft::Windows::RDS::DisplayControl";F.enabled=!1;F.process=function(a){var b=a.getLittleEndian32();a.getLittleEndian32();switch(b){case 5:b=a.getLittleEndian32(),F.maxMonitorAreaFactorA=a.getLittleEndian32(),F.maxMonitorAreaFactorB=a.getLittleEndian32(),F.enabled=!0,svGlobal.logger.warn("Display control maxNumMonitors:"+b+" factorA:"+F.maxMonitorAreaFactorA+" factorB:"+
F.maxMonitorAreaFactorB),a=new Uint8Array(2),a[0]=146,a[1]=4,A(a.buffer),Q&&setTimeout(function(){Q.check(5E3)},1900)}};F.applyResolution=function(a,b){if(F.enabled){var d=new Uint8Array(56),c=new RdpBuffer(d,0,56);a=a>F.maxMonitorAreaFactorA?F.maxMonitorAreaFactorA:a&-4;b=b>F.maxMonitorAreaFactorB?F.maxMonitorAreaFactorB:b&-4;c.setLittleEndian32(2);c.setLittleEndian32(56);c.setLittleEndian32(40);c.setLittleEndian32(1);c.setLittleEndian32(1);c.setLittleEndian32(0);c.setLittleEndian32(0);c.setLittleEndian32(a);
c.setLittleEndian32(b);c.setLittleEndian32(.26458*a|0);c.setLittleEndian32(.26458*b|0);c.setLittleEndian32(a>b?0:90);c.setLittleEndian32(100);c.setLittleEndian32(100);F.send(d);svGlobal.logger.warn("Display control: "+a+"x"+b)}else svGlobal.logger.warn("Display control disabled.")};return F}if(!t.disableDVC){K.count=0;K.names.length=0;var h=new f.DynamicChannel;h.name="ECHO";h.process=function(a){var b=a.getPosition(),d=a.getEnd(),c=new Uint8Array(d-b);c.set(a.getData().subarray(b,d));h.send(c)};
f.addDynamicChannel(h);if(a){var m=new f.DynamicChannel;m.name="Microsoft::Windows::RDS::Input";m.process=function(a){var b=a.getLittleEndian16();a.getLittleEndian32();switch(b){case 1:a.skipPosition(4),a=new RdpBuffer(new Uint8Array(16),0,16),a.setLittleEndian16(2),a.setLittleEndian32(16),a.setLittleEndian32(3),a.setLittleEndian32(65536),a.setLittleEndian16(256),a.markEnd(),m.send(a);case 5:q.execute("setTouchRemoting",[!0]);K.isTouchReady=!0;svGlobal.logger.info("Touch remoting start");break;case 4:q.execute("setTouchRemoting",
[!1]),K.isTouchReady=!1,svGlobal.logger.info("Touch remoting suspend")}};f.addDynamicChannel(m)}if(c){svGlobal.logger.warn("Audio input on");var z=new f.DynamicChannel;(function(){function a(a){var b=new RdpBuffer(new Uint8Array(5),0,5);b.setByte(7);b.setLittleEndian32(a);b.markEnd();z.send(b)}function b(b){b.getLittleEndian32();var l=b.getLittleEndian32();(new d).fromBuffer(b);g=!0;h=f.reconnectOnResize;f.reconnectOnResize=!1;q.onopen||(q.onopen=function(b){if(J){c=b;f.reconnectOnResize=h;a(l);var d=
new RdpBuffer(new Uint8Array(5),0,5);d.setByte(4);d.setLittleEndian32(b?0:1);d.markEnd();z.send(d)}});q.ondata||(q.ondata=function(a,b){c&&(k.length!=b+1&&(k=new Uint8Array(b+1),k[0]=6),z.send(e),k.set(a,1),z.send(k))});q.start()}z.name="AUDIO_INPUT";z.process=function(c){var f=c.getByte();switch(f){case 1:var l=c.getLittleEndian32(),f=new RdpBuffer(new Uint8Array(5),0,5);f.setByte(1);f.setLittleEndian32(l);f.markEnd();z.send(f);break;case 2:var h=c.getLittleEndian32();c.getLittleEndian32();for(var f=
[],k=[],m=N.getContext().sampleRate,l=0;l<h;l++){var p=new d;p.fromBuffer(c);49==p.formatTag&&22050==p.nSamplesPerSec?(p.hasLocalSupport=!0,f.push(p)):1==p.formatTag&&p.nSamplesPerSec==m&&2==p.nChannels&&k.push(p)}z.send(e);h=0;c=f.length;0==c&&(f=k,c=k.length,q.directInput=!0);for(l=0;l<c;l++)h+=f[l].getSize();k=new RdpBuffer(new Uint8Array(1024),0,1024);k.setByte(2);k.setLittleEndian32(c);k.setLittleEndian32(h+9);for(l=0;l<c;l++)f[l].toBuffer(k);k.skipPosition(1024-h-9);k.markEnd();z.send(k);break;
case 3:b(c);break;case 7:f=c.getLittleEndian32();g||(a(f),g=!1);break;default:svGlobal.logger.warn("audioInpt: invalid tag:"+f)}};var c=!1;z.onclose=function(){c=!1;q&&q.close()};var e=new Uint8Array(1);e[0]=5;var g=!1,h=f.reconnectOnResize,k=new Uint8Array(0),m=null,q=new function(a){function b(b){p=!0;if(h.onopen)h.onopen(!0);m=new MSGSMEncoder;g=b;f=a.createMediaStreamSource(b);b=h.directInput?1024:4096;l=a.createJavaScriptNode?a.createJavaScriptNode(b,1,1):a.createScriptProcessor(b,1,1);h.directInput&&
!u&&(u=new Int16Array(2048));l.onaudioprocess=function(a){if(e){a=a.inputBuffer.getChannelData(0);if(h.directInput){for(var b=0,d,c=0;1024>c;c++)d=32767*a[c],u[b++]=d,u[b++]=d;q.ondata(new Uint8Array(u.buffer),4196)}else t.addData(a,k);a.fill(0)}};f.connect(l);l.connect(a.destination)}function d(a){e=p=!1;if(h.onopen)h.onopen(!1);svGlobal.logger.warn("Error on getUserMedia: "+a)}function c(){e||(g&&g.getTracks&&g.getTracks()[0].stop(),l&&l.disconnect(),f&&f.disconnect(),p=!1)}var e=!1,g=null,f=null,
l=null,h=this,k=a.sampleRate/22050,p=!1,r=0;this.directInput=!1;var h=this,u;this.start=function(){r&&clearTimeout(r);if(!p)navigator.getUserMedia?navigator.getUserMedia({audio:!0},b,d):navigator.mediaDevices.getUserMedia({audio:!0}).then(b)["catch"](d);else if(h.onopen)h.onopen(!0);e=!0};this.stop=function(){e=!1};this.close=function(){e=!1;t&&t.reset();m=new MSGSMEncoder;r=setTimeout(c,3E5)};var t=new function(){function a(a){for(var l=c/160|0,k=0;k<l;k++){var n=m.encode(a,d,f,e);e+=n;e==g&&(e=
0,h.ondata(f,g));d+=160;c-=160}b=0<c?a:null}var b=null,d=0,c=0,e=0,g=65*Math.floor(Math.floor(Math.floor(4096/k)/160)/2),f=new Uint8Array(g);this.reset=function(){c=d=e=0;b=null};this.addData=function(e,g){var f=e;if(1==g)e=f;else if(1>g)console.error("rate must be smaller than the original rate"),e=void 0;else{for(var l=new Float32Array(Math.round(f.length/g)),h=0,k=0;h<l.length;){for(var m=Math.round((h+1)*g),p=0,n=0;k<m&&k<f.length;k++)p+=f[k],n++;l[h]=p/n;h++;k=m}e=l}0==c?(c=e.length,d=0,a(e)):
(f=e,l=c+f.length,h=new Float32Array(l),h.set(b.subarray(d)),h.set(f,c),d=0,c=l,a(h))}}}(N.getContext())})();f.addDynamicChannel(z)}f.addDynamicChannel(function(){var a=new f.DynamicChannel;a.name="TSMF";var b={type:"image/jpeg"},d=Array(1);a.process=function(c){c.getPosition();var e=c.getLittleEndian32()&1073741823;var g=c.getLittleEndian32();var f=c.getLittleEndian32();switch(e){case 2:if(256==f){c.getLittleEndian32();f=new Uint8Array(16);var h=new RdpBuffer(f,0,16);h.setLittleEndian32(2);h.setLittleEndian32(g);
h.setLittleEndian32(1);h.setLittleEndian32(0);a.send(f)}break;case 0:switch(f){case 257:c.getBytes(16);c.getLittleEndian32();break;case 256:e=c.getPosition();h=c.getLittleEndian32();for(f=0;f<h;f++){c.getLittleEndian32();var k=c.getLittleEndian32();c.getLittleEndian32();c.skipPosition(k-4)}f=c.getPosition()-e;h=f+8+4;f=new Uint8Array(h);h=new RdpBuffer(f,0,h);h.setLittleEndian32(-2147483648);h.setLittleEndian32(g);f.set(c.getData().subarray(e,c.getPosition()),8);a.send(f);break;case 261:c.getBytes(16);
c.getLittleEndian32();break;case 264:e=c.getLittleEndian32();c.skipPosition(4);c.getLittleEndian32();k=c.getBytes(16);var l=c.getBytes(16);c.getLittleEndian32();c.getLittleEndian32();c.getLittleEndian32();var m=c.getBytes(16);f=c.getLittleEndian32();c.skipPosition(f);f=new Uint8Array(20);h=new RdpBuffer(f,0,20);h.setLittleEndian32(-2147483648);h.setLittleEndian32(g);hi5.Arrays.equals([118,105,100,115,0,0,16,0,128,0,0,170,0,56,155,113],k)&&hi5.Arrays.equals([77,74,80,71,0,0,16,0,128,0,0,170,0,56,155,
113],l)&&hi5.Arrays.equals([128,159,88,5,86,195,206,17,191,1,0,170,0,85,89,90],m)?h.setLittleEndian32(1):(h.setLittleEndian32(0),svGlobal.logger.warn("Format is not supported:"),svGlobal.logger.warn(k),svGlobal.logger.warn(l),svGlobal.logger.warn(m));h.setLittleEndian32(e);a.send(f);break;case 258:c.getBytes(16);c.getLittleEndian32();e=c.getLittleEndian32();c.skipPosition(e);break;case 263:c.getBytes(16),f=new Uint8Array(16),h=new RdpBuffer(f,0,16),h.setLittleEndian32(-2147483648),h.setLittleEndian32(g),
h.setLittleEndian32(1),a.send(f);case 277:c.getBytes(16);c.getLittleEndian32();break;case 262:c.getBytes(16);v.flushImgs();v.setImgRect(0,0,0,0);f=new Uint8Array(12);h=new RdpBuffer(f,0,12);h.setLittleEndian32(-2147483648);h.setLittleEndian32(g);a.send(f);break;case 278:c.getBytes(16);g=c.getLittleEndian32();f=c.getLittleEndian32();e=c.getLittleEndian32();c=c.getLittleEndian32();v.setImgRect(g,f,e-g,c-f);break;case 265:c.getBytes(16);c.getLittleEndian64();c.getLittleEndian32();break;case 266:c.getBytes(16);
break;case 268:c.getBytes(16);break;case 267:c.getBytes(16);break;case 269:c.getBytes(16);c.getLittleEndian32();break;case 274:break;case 275:break;case 259:c.getBytes(16);c.getLittleEndian32();c.getLittleEndian32();c.skipPosition(32);f=c.getLittleEndian32();g=new Image;e=c.getPosition();d[0]=c.getData().subarray(e,e+f);c=new Blob(d,b);g.src=URL.createObjectURL(c);v.addImg(g);break;case 270:v.flushImgs();break;case 273:break;case 260:break;case 276:c.getBytes(16);f=c.getLittleEndian32();e=c.getPosition()+
f;c.skipPosition(8);g=c.getLittleEndian32();svGlobal.logger.info("window state:"+g);h=c.getLittleEndian32();k=c.getLittleEndian32();g=c.getLittleEndian32();f=c.getLittleEndian32();c.skipPosition(8);l=c.getLittleEndian32();m=c.getLittleEndian32();svGlobal.logger.info("Window rect, left:"+g+" top:"+f+" w:"+h+" h:"+k+" cl:"+l+" ct:"+m);c.setPosition(e);e=c.getLittleEndian32();for(e=c.getPosition()+e;c.getPosition()<e;){l=c.getLittleEndian32();m=c.getLittleEndian32();var p=c.getLittleEndian32(),q=c.getLittleEndian32();
svGlobal.logger.info("visible region, l:"+m+" t:"+l+" r:"+q+" b:"+p)}v.setImgRect(g,f,h,k);break;case 1:case 2:break;default:svGlobal.logger.warn("unknown function:"+f)}break;default:svGlobal.logger.warn("unkown interface:"+e)}};return a}());fa||f.addDynamicChannel(g())}}};this.resetStatus=Ka;this.exeAppCmd=function(a){var b=q.getFocused();b&&b.exeCommand(a)};this.activateApp=function(a){var b;(b=hi5.tool.isNumber(a)?q.getWinById(a):q.getMainWinByAppId(a))?b.activate(1):svGlobal.logger.warn("No window found in "+
a)};this.reconnect=function(a,b,c){void 0==c&&(c=t.forceReconnect||!1);if(!J&&!c)return!1;m.minWidth&&a<m.minWidth&&(a=m.minWidth);m.minHeight&&b<m.minHeight&&(b=m.minHeight);a&=-4;b&=-4;if(!c&&4>Math.abs(a-I)&&4>Math.abs(b-D))return!1;if(F&&F.enabled)F.applyResolution(a,b);else if(Ta&&ha||c||U&&!Ta)ha=!1,svGlobal.logger.info("reconnecting..."),A("8E0"+a+"\t"+b),P&&(P.remoteLockFlags=0,P.checkLockFlags=!0);return!0};this.notify=function(a,b){a="8E6"+a;b&&(a+="\t"+b.join(";"));A(a)};this.getUploadManager=
function(){return H};this.addSurface=function(a){if(!q.hasSurface(a)&&(Aa||v.setContext(a.context),!q.hasSurface(a)||!a.railWin)){fa&&a.setPlayerMode();m.mouseMoveEmu&&(a.mouseMoveEmu=V(m.mouseMoveEmu));a.setSize(50,50,"hidden");var b=a.getFreeSpace();0==I&&(I=b.width);0==D&&(D=b.height);a.setConfig(t);q.addSurface(a);ga(I,D,!1,m.monitorDef?!0:!1);a.setController(P);a.setTouchpad(V(m.touchpad));var c=b=V(m.mapClipboard),e=b;void 0!=m.copyToLocal?c=V(m.copyToLocal):void 0!=t.copyToLocal&&(c=t.copyToLocal);
void 0!=m.copyToRemote?e=V(m.copyToRemote):void 0!=t.copyToRemote&&(e=t.copyToRemote);a.setClipboard(b,c,e);Sa&&$a(a);m.invitation&&(q.setReadOnly(!0),b=hi5.$("requestControl"))&&(b.disabled=!1);a.run(parseInt(m.keyboard||1033,10))}};this.getRunninApps=this.getRunningApps=function(){for(var a=[],b=0,c=q.size();b<c;b++)q.getSurface(b).railWin.getMain(q.zOrders)&&a.push(q.getSurface(b).railWin.getMain(q.zOrders).titleInfo);return a};this.startApp=function(a,b,c){b=b||"";c=c||"";A("8C2"+a+"\t"+b+"\t"+
c);var e=q.getSurface(q.size()-1);e&&(e.remoteApp=new ab(a,b,c))};this.startExitingApp=function(a){a=q.popWins(a);for(var b=a.length-1;0<=b;b--)q.addWin(a[b])};this.VirtualChannel=function(){return new La(143)};this.GatewayChannel=function(){return new La(28)};this.DynamicChannel=function(){return new La(64)};this.addChannel=function(a){da[a.name]=a};this.addGatewayChannel=function(a){ea[a.name]=a};this.addDynamicChannel=function(a){K.names.push(a.name);K[a.name]=a;K.count++};if(V(m.smartCard)){var xa=
new f.GatewayChannel,Va=null;xa.name="SCARDSTB";xa.onopen=function(){Va=document.getElementById(hi5.appcfg.clientAppletId||"clientApplet")};xa.process=function(a){var b=null;if(Va){var c=a.getPosition();a=hi5.Base64.enc(a.getData(),a.getEnd()-c,c);try{a=Va.deviceControl(a),b=hi5.Base64.dec(a,0)}catch(e){svGlobal.logger.warn(e)}}b||(b=[0]);a=new hi5.DataBuffer(b);a.markEnd(b.length);xa.send(a)};f.addGatewayChannel(xa)}var Oa={type:6,data:null};this.run=function(){cb();N.supportWebAudio&&N.iOSFix()};
this.getDesktop=function(){return v};this.mouseDown=function(a,b,c){U&&A("80"+a+"\t"+b+"\t"+c)};this.mouseMove=function(a,b){U&&A("82"+a+"\t"+b)};this.mouseUp=function(a,b,c){U&&A("81"+a+"\t"+b+"\t"+c)};this.writeKeyCode=function(a,b){U&&A("8B"+(a?0:49152)+"\t"+b)};this.writeScancode=function(a,b){U&&("number"==typeof a?(A("840\t"+a),A("8449152\t"+a)):A("84"+(a?0:49152)+"\t"+b))};var O=new RdpBuffer([],0,0);this.suppressOutput=function(a){if(!f.sessionInfo.suppressOutput)return!1;void 0==a&&(a=!0);
var b=new Uint8Array(a?3:11);b[0]=146;b[1]=3;b[2]=a?1:0;a||(b[3]=Ea,b[4]=Ea>>8,b[5]=Da,b[6]=Da>>8,b[7]=Fa,b[8]=Fa>>8,b[9]=Ga,b[10]=Ga>>8);A(b.buffer);return!0};this.refreshOutput=function(a,b,c,e){var d=new Uint8Array(c?11:3);d[0]=146;d[1]=3;d[2]=2;c&&(d[3]=a,d[4]=a>>8,d[5]=b,d[6]=b>>8,d[7]=c,d[8]=c>>8,d[9]=e,d[10]=e>>8);A(d.buffer)};this.sendPing=function(a){var b=new Uint8Array(a?2+a.length:2);b[0]=146;b[1]=0;a&&b.set(a,2);A(b.buffer)};this.startPing=function(a,b){b=b||0;Q||(Q=new hi5.tool.ResponseMonitor(function(){U&&
f.sendPing()},function(){if(U&&f.onnoresponse)return f.onnoresponse()}));Q.setInterval(a,b);var c=new Uint8Array(4);c[0]=146;c[1]=2;c[2]=a;c[3]=b;A(c.buffer);setTimeout(function(){Q.check()},1E3*(a+b));L?L.postMessage({type:0,cmd:6,start:1}):(C.onSlowPath=C.onFastPath=kb,C.onReqHistory=function(){kb(15555)})};this.stopPing=function(){Q&&Q.stop();L?L.postMessage({type:0,cmd:6,start:0}):C.onSlowPath=C.onFastPath=C.onReqHistory=null};var W=null,rb=0;this.play=function(){A("F3")};this.pause=function(){A("F2")};
this.scan=function(a){A("F4"+(a?"1":"0"))};this.seek=function(a){var b=q.getFocused();b&&J&&(A("F4"+(a?"1":"0")+"\t"+(a/b.getScale().x|0)),v.pause(!0))};var ka=Z=R=0;var ja=22050;var qb=!1;this.showMessage=function(a,b,c){f&&f.displayMsg&&a&&((b=b||q.getFocused())?b.showMessage(a,c):hi5.notifications.notify({msg:a,timeout:c||0}))};this._unload=ra;this.close=function(){svGlobal.logger.info("closing...");v&&v.isSendingHistory()?(svGlobal.logger.warn("In the middle of sending history, close delayed"),
setTimeout(tb,2222)):tb()};hi5.browser.isChromeApp?chrome.runtime.onSuspend.addListener(f.close):window.addEventListener("unload",f.close,!1)}
Rdp.languageToKeyboard={af:0,sq:0,ar:1025,"ar-SA":1025,"ar-IQ":0,"ar-EG":0,"ar-LY":0,"ar-DZ":0,"ar-MA":0,"ar-TN":0,"ar-OM":0,"ar-YE":0,"ar-SY":0,"ar-JO":0,"ar-LB":0,"ar-KW":0,"ar-AE":0,"ar-BH":0,"ar-QA":0,eu:0,bg:0,be:0,ca:0,zh:2052,"zh-TW":1028,"zh-CN":2052,"zh-HK":1028,"zh-SG":2052,hr:0,cs:0,da:0,nl:1043,"nl-BE":2067,en:1033,"en-US":1033,"en-GB":2057,"en-AU":0,"en-CA":4105,"en-NA":0,"en-IE":0,"en-ZA":0,"en-JM":0,"en-BZ":0,et:0,fo:0,fa:0,fi:0,fr:1036,"fr-BE":2060,"fr-CA":3084,"fr-CH":4108,"fr-LU":0,
gd:0,"gd-IE":0,de:1031,"de-CH":2055,"de-AT":0,"de-LU":0,"de-LI":0,el:0,he:1037,hi:0,hu:0,is:1039,id:0,it:1040,"it-CH":66576,ja:3758162961,ko:3758162962,lv:0,lt:0,mk:0,mt:0,nb:1044,nn:1083,no:1044,pl:1045,pt:2070,"pt-BR":1046,rm:0,ro:0,"ro-MO":0,ru:1049,"ru-MO":0,sr:0,sk:0,sl:0,sb:0,es:1034,"es-AR":0,"es-GT":0,"es-CR":0,"es-PA":0,"es-DO":0,"es-MX":2058,"es-VE":0,"es-CO":0,"es-PE":0,"es-EC":0,"es-CL":0,"es-UY":0,"es-PY":0,"es-BO":0,"es-SV":0,"es-HN":0,"es-NI":0,"es-PR":0,sx:0,sv:1053,"sv-FI":0,th:0,
ts:0,tn:0,tr:1055,uk:0,ur:0,ve:0,vi:0,xh:0,ji:0,zu:0,detect:function(){var h=navigator&&(navigator.language||navigator.userLanguage),z=Rdp.languageToKeyboard[h];if(!z){var G=h.indexOf("-");G&&(z=Rdp.languageToKeyboard[h.substring(0,G)])}z||(console.log("No valid layout for "+h),z=1033);return z}};svGlobal.Rdp||(svGlobal.Rdp=Rdp);var RdpBuffer=hi5.DataBuffer;
