var svManager={getInstance:function(){var r=window.$telnet;return r&&r.running&&r.running()?r:null}};function connvertServer(r){var v={};v.id=r.id;v.server=r.id;v.displayName=r.displayName||r.id;if(r=r.vnc)for(var z in r)v[z]=r[z];return v}
svGlobal.TELNET=function(r,v,z){function Ma(a,b){var h=[],e=null,d=new hi5.graphic.Rectangle(0,0,0,0),g="Uint8ClampedArray"in window;this.width=a;this.height=b;var m=!1,c=this;this.pause=function(a){m=a};this.release=function(){h=e=c=null};this.isPaused=function(){return m};this.setContext=function(a){a!=e&&(e||!a||a.createImageData(1,1).data.buffer||(g=!1),e=a)};this.getContext=function(){return e};this.resize=function(e,d){for(var m=0;m<d;m++)h[m]=new Uint32Array(e);c.width=a=e;c.height=b=d};c.resize(a,
b);this.getBuffer=function(){return h};this.setRGB=function(a,b,e){h[b][a]=e|4278190080};this.getRGB=function(a,b){return h[b][a]};this.setRGBs=function(a,b,e,d,m,c,g){e=a+e;d=b+d;for(var f=h,k,l=b;l<d;l++,c+=g){var Na=c;k=f[l];for(b=a;b<e;b++)k[b]=m[Na++]}};this.moveArea=function(a,b,e,d,m,c){if(0<c){m=a+m;c=b+c;var g=h,f;for(f=d-1;0<=f;f--){var k=g[c+f];var l=g[b+f];for(d=0;d<e;d++)k[m+d]=l[a+d]}}else if(0>c){m=a+m;c=b+c;var g=h;for(k=0;k<d;k++){l=g[c+k];var n=g[b+k];for(f=0;f<e;f++)l[m+f]=n[a+
f]}}else if(0<m)for(m=a+m,c=b+c,g=h,--e;0<=e;e--)for(k=m+e,l=a+e,f=0;f<d;f++)g[c+f][k]=g[b+f][l];else for(m=a+m,c=b+c,g=h,f=0;f<e;f++)for(l=m+f,n=a+f,k=0;k<d;k++)g[c+k][l]=g[b+k][n]};this.getRGBs=function(a,b,e,d){var m=_Uint32Array(e*d);m[0]=0;var c=h;e=a+e;d=b+d;for(var f=0,g=b;g<d;g++)for(b=a;b<e;b++)m[f++]=c[g][b];return m};this.repaint=function(d,m,c,f){if(e){0>d&&(c+=d,d=0);0>m&&(f+=m,m=0);d+c>a&&(c=a-d);m+f>b&&(f=b-m);var k=e.createImageData(c,f),l=k.data;c=d+c;f=m+f;var n=0,r=h;if(g)for(var l=
new Uint32Array(l.buffer),p,q=m;q<f;q++)for(p=d;p<c;p++)l[n++]=r[q][p];else for(var t,u,q=m;q<f;q++)for(p=d;p<c;p++)t=r[q][p],u=n<<2,l[u]=t&255,l[u+1]=t>>8&255,l[u+2]=t>>16&255,l[u+3]=255,n++;e.putImageData(k,d,m)}};this.postPaint=function(a,b,e,m){0<d.width?d.union(a,b,e,m):(d.x=a,d.y=b,d.width=e,d.height=m)};this.commitPaint=function(){0<d.width&&(this.repaint(d.x,d.y,d.width,d.height),d.width=0)};this.fillRect=function(a,b,e,d,m){var c=h;e=a+e;d=b+d;for(var f=b;f<d;f++)for(b=a;b<e;b++)c[f][b]=
m}}function ya(a,b){M?M.resize(a,b):M=new Ma(a,b);return M}function za(){var a=r.indexOf("://"),b=r.substring(a+3),a=b.indexOf("/");0<a&&(b=b.substring(0,a));return location.protocol+"//"+b}function Oa(a){return da?hi5.browser.httpGet(za()+"/CLIP?s="+da+"&t="+(new Date).getTime(),!1):""}function ia(a){return"on"==a||"true"==a}function Aa(a,b,h){this.need=a;this.handler=b;this.repeat=h||1}function Pa(){if(!C){Ba();if(ja)p=ja;else{var a=hi5.tool.replaceQuery(r,"pwd","x");hi5.browser.binaryWS()&&(a+=
"&binary=on");var b=window.opener;if(b){var h=null;try{h=b.__sparkUser}catch(e){}h&&(b=h.account,h=h.session,b&&(a+="&account="+b),h&&(a+="&session="+h))}p=new WebSocket(a+("&pasteCap="+(hi5.browser.isChrome&&hi5.browser.isDesktop?3:0)),"telnet");p.binaryType="arraybuffer"}ka.ws=p;svGlobal.logger.info(r);p.onopen=Qa;void 0!=k.recording&&"on"==k.recording&&Ra(k);p.onmessage=function(a){a=a.data;if("string"!=typeof a){var b=new Uint8Array(a);null!=N&&N.add(new RecordingObj(b,0,a.byteLength));X.set(b,
0,a.byteLength);X.handle()}else{var e=parseInt(a.substring(0,2),16),b=a.substring(2);switch(e){case 26:a=JSON.parse(b);if(a.name){svGlobal.logger.info("msg="+b);if(c.onerror)c.onerror(a);b=__svi18n.errorCode["S"+a.name]||"";b+=a.message;c.showMessage(b)}else 0<svGlobal.log&&console.erro("No error code for message:"+b);break;case 27:0!=G.drawLicense&&(x.drawLicense(b),la(k.fontSize));break;case 56:a=JSON.parse(b);da=a.session;a.server=c.server;if(b=hi5.$("joinSelect"))b.value=a.joinMode;if(b=hi5.$("requestControl"))b.disabled=
a.hasControl;var b=G.page&&G.page.joinssh||"jointelnet.html",b=location.protocol+"//"+location.host+"/"+b+"?id="+a.numericId,m=a.webAddress;m&&0<m.length&&(e=m.indexOf("://"),m=m.substring(e+3),e=m.indexOf("/"),0<e&&(m=m.substring(0,e)),m.toLowerCase()!=location.host.toLowerCase()&&(b+="&gateway="+m));a.joinLink=b;c.sessionInfo.appInfo=a;a.ver&&a.ver!=svGlobal.version&&svGlobal.logger.warn("Client:"+svGlobal.version+" server:"+a.ver);if(c.onsessionstart)c.onsessionstart(c.sessionInfo);break;case 59:a=
hi5.Base64.dec(b,0);ma=a[3]<<24|a[2]<<16|a[1]<<8|a[0];ma&64&&c.showMessage(__svi18n.info.recording);x.setFeature(ma);break;case 61:a=JSON.parse(b);switch(a.type){case 0:k.fontSize=parseInt(a.fontSize);v=a.width;z=a.height;Ba();x.setAutoScale(!0);ea(v+y,z+y);a.server&&(c.server=a.server,c.setTitle&&(document.title=k.displayName||c.server));Ca=a.length;if(c.onopened)c.onopened(a);break;case 1:a=a.duration;if(c.onprogress)c.onprogress(a,Ca);break;case 2:2==a.status?C=!0:(b=0==a.status,M.pause(b),a.warn&&
c.showMessage(b?__svi18n.info.sessionPaused:__svi18n.info.sessionResumed))}break;case 62:Sa(b);break;default:svGlobal.logger.warn("@TODO:"+a+"\n")}}};p.onclose=fa;p.onerror=Ta;ea(v+y,z+y)}}function Ra(a){N=new RecordingManager;N.setHeader({name:a.server,width:a.width,height:a.height,color:a.fontSize,namesuffix:".telnetv",filetag:"TELV",duration:0})}function Ua(a,b){var h=0,e=!1;this.width=a;this.interval=b;var d=0;this.start=function(){e||(e=!0,h=setInterval(function(){if(x&&C){var b=x.getThumbnail(a);
b&&b.length!=d&&(p.send("8E7"+b),d=b.length)}},b))};this.stop=function(){clearInterval(h)}}function Va(a,b){!K||K.width==a&&K.interval==b||(K.stop(),K=null);K||(K=new Ua(a,b));K.start()}function Sa(a){var b=parseInt(a.substring(0,1),16),h=a.substring(1);a=!1;var e=c.sessionInfo.appInfo;switch(b){case 1:var d=JSON.parse(h);c.onsessionjoin&&(a=c.onsessionjoin(d));if(a)break;c.showMessage(__svi18n.info.joinsession.applyArgs([d.numericId,d.__ip,d.name]));break;case 2:d=JSON.parse(h);c.onsessionexit&&
(a=c.onsessionexit(d));if(a)break;c.showMessage(__svi18n.info.exitsession.applyArgs([d.numericId,d.__ip,d.name]));break;case 3:d=JSON.parse(h);e.joinMode!=d.mode&&(e.joinMode=d.mode,b=hi5.$("joinSelect"))&&(b.value=d.mode);if(e.hasControl)break;x.setReadOnly(!1);if(b=hi5.$("requestControl"))b.disabled=!0;c.ongivecontrol&&(a=c.ongivecontrol());if(a)break;c.showMessage(__svi18n.info.givecontrol);break;case 4:x.setReadOnly(!0);e.hasControl=!1;if(b=hi5.$("requestControl"))b.disabled=!1;c.ontakebackcontrol&&
(a=c.ontakebackcontrol());if(a)break;c.showMessage(__svi18n.info.nocontrol);break;case 5:d=JSON.parse(h);c.onrequirecontrol&&(a=c.onrequirecontrol(d));if(a)break;a=__svi18n.info.title.applyArgs([d.name,d.numericId,d.__ip]);hi5.notifications.notify({title:a,msg:__svi18n.info.recontrol,cbYes:function(){c.giveControl(d.numericId);this.destroy()},cbNo:function(){c.refuseControl(d.numericId);this.destroy()}});break;case 6:x.setTouchRemoting(!0);break;case 7:d=JSON.parse(h);d.cols&&d.rows&&(a=t*d.cols+
2*y,b=f*d.rows+2*y,M=ya(a,b),ea(a,b));break;case 8:d=JSON.parse(h);if(c.onrequestcredential&&c.onrequestcredential(d))break;x.requestCredential(d);break;case 9:d=JSON.parse(h);0<d.interval&&0<d.width?Va(d.width,d.interval):K&&(K.stop(),K=null);break;case 11:d=JSON.parse(h),c.onrequirejoin&&(a=c.onrequirejoin(d)),a||(a=__svi18n.info.title.applyArgs([d.name,d.numericId,d.__ip]),hi5.notifications.notify({title:a,msg:__svi18n.info.reqjoin,cbYes:function(){c.allowJoin(d.numericId,!0);this.destroy()},cbNo:function(){c.allowJoin(d.numericId,
!1);this.destroy()}}))}}function Qa(a){svGlobal.logger.info("opened...");C=!0;p.send("87"+navigator.userAgent);if(c.onopen)c.onopen()}function Ta(a){svGlobal.logger.warn(a)}function fa(a){svGlobal.logger.warn("closed ...");P&&(P.style.display="none");na=C=!1;if(c&&c.onclose)c.onclose();try{null!=N&&(N.exit(),N=null),x&&x.close(),S&&S.visible()&&(S.dismiss(),S=null)}catch(b){}X&&(X.release(),X=null);Q=g=null;p&&(p.onopen=null,p.onmessage=null,p.onclose=null,p=p.onerror=null);c=x=ka=null;window&&window.$telnet&&
(window.$telnet=null);null!=N&&(N.exit(),N=null)}function la(a,b){b||(b=I);g.font=a+"px "+b;t=g.measureText("X").width;V=parseInt(z/f);D=parseInt(v/t);oa(parseInt(z/f))}function oa(a,b){b&&(R=b);a&&(O=a,ga=(O-1)*f+u);Da=1==R&&O==Math.floor(z/f)}function ea(a,b){var h=a-y,e=b-y,d=Math.floor(e/f),c=Math.floor(h/t),m=null;C&&(m=g.getImageData(0,0,Math.min(c*t+y,D*t+y),Math.min(d*f+y,V*f+y)));v=h;z=e;x.setSize(a,b);la(k.fontSize);pa();m&&g.putImageData(m,0,0);V=d;D=c;oa(Math.floor(z/f))}function Ba(){P||
(pa(),n=q,l=u,10>k.fontSize&&(k.fontSize=10),12>=k.fontSize?(f=k.fontSize+6,ba=2):13<=k.fontSize&&18>k.fontSize?(f=k.fontSize+8,ba=2):19<=k.fontSize&&25>k.fontSize?(f=k.fontSize+12,ba=3):25<=k.fontSize&&(f=k.fontSize+16,ba=4),la(k.fontSize),remotectrl.style.cursor="text",P=document.getElementById("cursorID"),P.style.display="block",P.style.width=t+"px",P.style.height=f+"px",na=!0)}function pa(){g.fillStyle=B;g.fillRect(0,0,Q.width,Q.height);g.fillStyle=E}function Ea(a){if(0!=w||qa[a])""!=L&&ra(L),
Wa(a);else if(sa){var b=F[a]||"";L=""!=b?L+b:L+String.fromCharCode(a)}else L=127<a&&256>a?L+F[a]:L+String.fromCharCode(a)}function ta(a){for(;;){var b=a.getByte();if(255==b&&(b=a.getByte(),240==b))break}}function Y(a,b,h){p.send("D5"+a+"\t"+b+"\t"+(1==h?1:0));251==a?ua(b):252==a?ua(b):253==a?va(b):254==a&&va(b)}function ua(a){return 39>=a&&0<=a&&Xa[a-0]}function va(a){return 39>=a&&0<=a&&Ya[a-0]}function Wa(a){switch(a){case 0:case 24:return w=0,!1;case 26:return w=0,!1;case 5:return!1;case 7:return!1;
case 8:return n-=t,n<q&&(n=q),A(),!1;case 9:var b=(n-q)/t/8,b=parseInt(1*b)+1;n=8*b*t+q;n>=D*t&&(n=q,l+=f,Z("\n"));A();return!1;case 13:return n=q,l>u+(O-1)*f&&(l=u+(O-1)*f),A(),!1;case 10:case 11:case 12:return Fa(),!1;case 15:return!1;case 14:return!1;case 17:case 19:return!1;case 27:return T="",w=27,!1;default:if(128<=a&&159>=a)return!1}switch(w){case 0:return!0;case 27:if("\\"==a)return!1;if(32<=a&&47>=a)return T+=String.fromCharCode(a),!1;if(32<=a&&126>=a||160<=a){null==T&&(T="");switch(a){case 48:"("==
T&&(sa=!0);break;case 65:l-=f;A();break;case 66:"("==T&&(sa=!1);break;case "C":n+=t;A();break;case 68:""==T&&Ga(1);A();break;case 72:n=q;l+=f;break;case 77:""==T&&Ha(1);break;case "P":w=0;w=144;break;case "Y":w=161;break;case "c":w=0;break;case 91:U="";w=0;w=155;break;case 93:w=0;w=157;break;case "^":w=0,w=158}27==w&&(w=0);return!1}return!0;case 155:if(48<=a&&63>=a||32<=a&&47>=a)return U+=String.fromCharCode(a),!1;if(32<=a&&126>=a||160<=a){b=null;null==U&&(U="");""!=U&&(b=U.split(";"));switch(a){case 65:var h=
null!=b&&1<=b.length?parseInt(b[0]):1;l-=h*f;l<u&&(l=u);A();break;case 66:h=null!=b&&1<=b.length?parseInt(b[0]):1;a=l;l+=h*f;a=(l-a)/f;Z("\n",0==a?1:a);A();break;case 67:b=null!=b&&1<=b.length?parseInt(b[0]):1;n+=b*t;A();break;case 68:b=null!=b&&1<=b.length?parseInt(b[0]):1;n-=b*t;n<q&&(n=q);A();break;case 69:h=null!=b&&1<=b.length?parseInt(b[0]):1;a=l;l+=h*f;a=(l-a)/f;Z("\n",0==a?1:a);n=q;A();break;case 70:h=null!=b&&1<=b.length?parseInt(b[0]):1;l-=h*f;l<u&&(l=u);n=q;A();break;case 72:case 102:null!=
b?(1<=b.length&&(h=parseInt(b[0]),a=l,l=u+(h-1)*f,a=(l-a)/f,Z("\n",0==a?1:a)),2<=b.length&&(b=parseInt(b[1])-1,n=q+b*t)):""==U&&(n=q,l=u);break;case 73:b=1<=b.length?parseInt(b[0]):1;n=q+8*b*t;break;case 74:null!=b&&1<=b.length?(b=parseInt(b[0]),1==b?(g.fillStyle=B,g.fillRect(q,u,D*t,l-chart_height-u),g.fillRect(q,l,l-q,chart_height),g.fillStyle=E):2==b&&(pa(),n=q,l=u)):(g.fillStyle=B,g.fillRect(n,l,D*t-n+q,V*f-l+u),g.fillStyle=E);break;case 75:null!=b&&1<=b.length?(b=parseInt(b[0]),1==b?wa(q,n):
2==b&&wa(q,v+y),A()):wa(n,v+y);break;case 76:null!=b&&1<=b.length&&(h=parseInt(b[0]),Ha(h),A());break;case 77:null!=b&&1<=b.length&&(h=parseInt(b[0]),Ga(h),A());break;case 80:b=null!=b&&1<=b.length?parseInt(b[0]):1;b=g.getImageData(n+b*t,l,v+y-n-b*t,f);g.fillStyle=B;g.fillRect(n,l,v+y-n,f);g.putImageData(b,n,l);g.fillStyle=E;A();break;case 88:b=null!=b&&1<=b.length?parseInt(b[0]):1;g.fillStyle=B;g.fillRect(n,l,b*t,f);g.fillStyle=E;break;case 109:if(null==b||0==b.length)g.font="normal "+k.fontSize+
"px "+I,E=k.fgColor||H[7],B=k.bgColor||H[0];else{a=b.length;for(var e=0;e<a;e++)switch(h=1*b[e],h){case 0:g.font="normal "+k.fontSize+"px "+I;B=H[0];E=H[7];break;case 1:g.font="bold "+k.fontSize+"px "+I;break;case 4:break;case 5:g.font="italic "+k.fontSize+"px "+I;break;case 7:g.font="normal "+k.fontSize+"px "+I;B=H[7];E=H[0];break;case 22:g.font="normal "+k.fontSize+"px "+I;B=H[0];E=H[7];break;case 24:break;case 25:g.font="italic "+k.fontSize+"px "+I;break;case 27:g.font="normal "+k.fontSize+"px "+
I;B=H[7];E=H[0];break;default:30<=b[e]&&39>=b[e]?E=H[b[e]-30+1]:40<=b[e]&&49>=b[e]&&(B=H[b[e]-40+1])}}break;case 114:null!=b&&2<=b.length&&(a=parseInt(b[0]),b=parseInt(b[1]),oa(b,a))}w=0;return!1}return!0;case 144:case 157:case 158:case 159:return 48<=a&&63>=a||32<=a&&47>=a?!1:32<=a&&126>=a||160<=a?(w=160,!1):!0;case 160:return 32<=a&&126>=a||160<=a?!1:!0;case 161:return w=162,!1;case 162:return w=0,!1;default:return w=0,!1}}function wa(a,b){g.fillStyle=B;g.fillRect(a,l,b-a,f);g.fillStyle=E}function Ha(a){var b=
g.getImageData(q,u+(R-1)*f,D*t,(O-R-a+1)*f);g.fillStyle=B;g.fillRect(q,u+(R-1)*f,D*t,f*a);g.putImageData(b,q,u+(R+a-1)*f);g.fillStyle=E}function Ga(a){var b=g.getImageData(q,(R+a-1)*f+u,D*t,(O-R-a+1)*f);g.fillStyle=B;g.fillRect(q,(O-a)*f+u,D*t,a*f);g.putImageData(b,q,(R-1)*f+u);g.fillStyle=E}function Fa(){l+=f;Z("\n");A();Ia()}function Ia(){n>=D*t&&(n=q,l+=f);if(l>ga){for(;l>ga;)l-=f;A();if(Da){var a=Q.height-(u+f);g.drawImage(Q,0,u+f,Q.width,a,0,u,Q.width,a);g.fillStyle=B;g.fillRect(0,ga,Q.width,
f)}else a=g.getImageData(q,u+f,D*t,(O-1)*f),g.fillStyle=B,g.fillRect(q,u,D*t,O*f),g.putImageData(a,q,u);g.fillStyle=E}}function ra(a){var b=a.length,h=((n-q)/t|0)+b-D;0<h?(b-=h,Ja(a.substring(0,b),b),Ia(),ra(a.substring(b))):(Ja(a,b),"--More--"==a.trim()&&Fa())}function Ja(a,b){l+f>z&&(l=(V-1)*f+u);g.fillStyle=B;g.fillRect(n,l,t*b,f);g.fillStyle=E;g.fillText(a,n,l+f-3*ba);n+=g.measureText(a).width;Z(a);A();L=""}function A(){P.style.top=l+"px";P.style.left=n+"px"}function Za(a){if(C)return(a=a.getData("text/plain"))?
(a=a.replace(/\r\n/g,"\n"),ca(a),!0):!1}function $a(){S&&aa&&!S.visible()&&(aa.value=W,S.show(),x&&x.setIgnorePaste(!1),setTimeout(function(){aa.scrollTop=aa.scrollHeight;aa.disabled=!1},10))}function Z(a,b){if(S){if(b)for(var h=0;h<b;h++)W+=a;else W+=a;1E5<W.length&&(W=W.substring(4E4))}}function ca(a){if(a){var b=a.length+1,h=new Uint8Array(b);h[0]=147;for(var e=1;e<b;e++)h[e]=a.charCodeAt(e-1);p.send(h.buffer)}}sessionStorage&&sessionStorage.clear();var aa=document.getElementById("copytextarea"),
S=aa?new hi5.Lightbox(document.getElementById("copydialog")):null,W="";this.displayMsg=!0;this.reconnectTimes=0;this.setTitle=this.openLink=!0;this.mode=0;var ja="object"==typeof r?r:null,Ka="object"==typeof r||0<r.indexOf("/PLAY?");Ka?(this.mode=1,ja&&(r=""),r+="&touchpad=on"):0<r.indexOf("/JOIN?")&&(this.mode=2,this.reconnectOnResize=!1);var G=hi5.appcfg||{img:{},toolbar:{fadable:!0}};this.sessionInfo={major:0,minor:0,width:0,height:0,bpp:0,bigEndian:!0,trueColor:!0};var da="",x=null,C=!1,na=!1,
ma=0,y=5,N=null;window.$telnet=this;G.copyDialog=!0;for(var F=[],J=0;127>J;J++)F[J]=String.fromCharCode(J);F[106]="+";F[107]="+";F[108]="+";F[109]="+";F[110]="+";F[113]="_";F[116]="+";F[117]="+";F[118]="+";F[119]="+";F[120]="|";(function(){for(var a={128:199,129:252,130:233,131:226,132:228,133:224,134:229,135:231,136:234,137:235,138:232,139:239,140:238,141:236,142:196,143:197,144:201,145:230,146:198,147:244,148:246,149:242,150:251,151:249,152:255,153:214,154:220,155:162,156:163,157:165,158:8359,159:402,
160:225,161:237,162:243,163:250,164:241,165:209,166:170,167:186,168:191,169:8976,170:172,171:189,172:188,173:161,174:171,175:187,176:9617,177:9618,178:9619,179:9474,180:9508,181:9569,182:9570,183:9558,184:9557,185:9571,186:9553,187:9559,188:9565,189:9564,190:9563,191:9488,192:9492,193:9524,194:9516,195:9500,196:9472,197:9532,198:9566,199:9567,200:9562,201:9556,202:9577,203:9574,204:9568,205:9552,206:9580,207:9575,208:9576,209:9572,210:9573,211:9561,212:9560,213:9554,214:9555,215:9579,216:9578,217:9496,
218:9484,219:9608,220:9604,221:9612,222:9616,223:9600,224:945,225:223,226:915,227:960,228:931,229:963,230:181,231:964,232:934,233:920,234:937,235:948,236:8734,237:966,238:949,239:8745,240:8801,241:177,242:8805,243:8804,244:8992,245:8993,246:247,247:8776,248:176,249:8729,250:183,251:8730,252:8319,253:178,254:9632,255:160},b=128;256>b;b++)F[b]=String.fromCharCode(a[b])})();for(var Ya=[!0,!0,!1,!0,!1,!1,!1,!1,!1,!1,!1,!1,!1,!1,!1,!1,!1,!1,!1,!1,!1,!1,!1,!1,!1,!1,!1,!1,!1,!1,!1,!1,!1,!1,!1,!1,!1,!1,!1,
!1,!1],Xa=[!0,!1,!1,!0,!1,!1,!1,!1,!1,!1,!1,!1,!0,!1,!1,!1,!1,!1,!1,!1,!1,!1,!1,!1,!0,!1,!1,!1,!1,!1,!1,!0,!0,!1,!1,!1,!1,!1,!1,!1,!1],qa=Array(256),ha=[0,5,7,8,9,10,11,12,13,14,15,17,19,24,26,27,127,132,133,136,141,142,143,144,155,156,157,158,159],J=0;256>J;J++)qa[J]=!1;for(J=0;J<ha.length;J++)qa[ha[J]]=!0;var X=new function(a){var b=0,h=0,e=new Uint8Array(a),d=this,c=new Aa(0,null,0);this.release=function(){d=e=c=null};this.getHandler=function(){return c};this.getData=function(){return e};this.getPosition=
function(){return b};this.setPosition=function(a){b=a};this.getEnd=function(){return h};this.set=function(a,d,c){e=a;b=d;h=c};this.handle=function(){c.handler(d,c)};this.setHandler=function(a){a&&1>a.need&&svGlobal.logger.warn("need < 1");(c=a)&&h-b>=a.need&&a.handler(d,a)};this.getByte=function(){return e[b++]};this.peekByte=function(){return e[b]};this.getBE32=function(){return e[b++]<<24|e[b++]<<16|e[b++]<<8|e[b++]};this.getBE16=function(){return e[b++]<<8|e[b++]};this.skip=function(a){b+=a};this.skipBack=
function(a){b-=a};this.getBytes=function(a,d){if(d)for(var c=0;c<a;c++)d[c]=e[b++];else return c=b,b+=a,e.subarray(c,b)};this.copyToByteArray=function(a,b,d,c){hi5.Arrays.arraycopy(e,d,a,b,c)}}(4194304);this.running=function(){return C};this.getHistory=function(){return W};var c=this,p=null,k=hi5.tool.queryToObj(r.substring(r.indexOf("?")+1));v||(v=window.innerWidth);v-=y;k.width=v;r+="&width="+v;z||(z=window.innerHeight);z-=y;k.height=z;r+="&height="+z;k.fontSize?k.fontSize=parseInt(k.fontSize,10):
(k.fontSize=13,r+="&fontSize=13");this.server=k.server;this.port=k.port?parseInt(k.port,10):23;var H="black red green yellow blue magenta cyan white gray violet".split(" "),M=ya(v,z),g=M.getContext(),Q,ka=new function(){this.ws=null;this.setJoinMode=c.setJoinMode;this.requestControl=c.requestControl;this.writeKeyComb=c.writeKeyComb;this.getAppMode=function(){return c.mode};this.send=function(a){"891"!=a&&C&&this.ws.send(a)};this.sendInput=function(a){c.writeRawInput(a);if(c.onactivity)c.onactivity(a)};
var a=null;this.getAppInfo=function(){return c.sessionInfo.appInfo};this.onresize=function(b){if(b=b.target.svSurface){b=b.getFreeSpace();var c=b.width,e=b.height;hi5.browser.isTouch||hi5.browser.isOpera||!C||(a&&(clearTimeout(a),a=null),a=setTimeout(function(){ea(c,e);p.send("D9"+D+"\t"+V)},200))}};this.onorientationchange=function(a){};this.getClipData=Oa;this.onfocus=function(a){};this.fileCallback=[];this.getShareFiles=function(a,c){loggedin&&(this.ws.send("3A5"+a),this.fileCallback.push(c))};
this.notifyFiles=function(a){for(var b=this.fileCallback,c=0,d=b.length;c<d;c++)b[c](a)};this.getFile=function(a){window.open(c.getFileUrl(a))};this.removeFile=function(a){uploadMgr&&uploadMgr.fileService.remove(a)};this.getFileLink=function(a){return za()+"/DOWNLOAD?s="+da+"&f="+a};this.getGateway=function(){return r};this.reconnect=function(a,c,e){}};void 0!=G.displayMsg&&(this.displayMsg=G.displayMsg);void 0!=G.reconnectTimes&&(this.reconnectTimes=G.reconnectTimes);void 0!=G.openLink&&(this.openLink=
G.openLink);void 0!=G.setTitle&&(this.setTitle=G.setTitle);"boolean"==typeof G.useWSS&&(r=(G.useWSS?"wss":"ws")+r.substring(r.indexOf("://")));this.getURL=function(){return r};this.setJoinMode=function(a){C&&p.send("8E1"+a)};this.refuseControl=function(a){C&&p.send("8E3"+a)};this.giveControl=function(a){C&&p.send("8E4"+a)};this.requestControl=function(){C&&p.send("8E2")};this.play=function(){p.send("F3")};this.pause=function(){p.send("F2")};this.scan=function(a){p.send("F4"+(a?"1":"0"))};this.seek=
function(a){x&&C&&(p.send("F4"+(a?"1":"0")+"\t"+(a/x.getScale()|0)),M.pause(!0))};var K=null,Ca=0;this.run=function(){Pa()};this.hide=function(){x&&("block"==document.getElementById("cursorID").style.display&&(document.getElementById("cursorID").style.display="none"),x.hide())};this.showMessage=function(a){c.displayMsg&&a&&hi5.notifications.notify({msg:a})};this.close=function(){if(p&&C)try{p.send("85"),p.close()}catch(a){}else fa()};hi5.browser.isChromeApp?chrome.runtime.onSuspend.addListener(fa):
window.addEventListener("unload",fa,!1);var La=!1,P=null,q=y=5,u=5,n=0,l=0,I=k.fontName||"Courier New";0<I.indexOf(" ")&&(I='"'+I+'"');var E=k.fgColor||H[7],B=k.bgColor||H[0],w=0,U="",T="",t=0,f=18,ba=0,L="",sa=!1,V=0,D=0,R=1,O=24,ga=0,Da=!0,ha=new Aa(1024,function(a){for(var b=!0,c;b;){c=a.getByte();if(0>c)break;if(255==c)a:{var e=a,d=e.getByte();switch(d){case 255:Ea(d);break;case 254:case 253:case 252:case 251:c=e.getByte();e=d;253!=e||ua(c)?251!=e||va(c)?254==e?Y(252,c,!1):252==e?Y(254,c,!1):
253==e?(Y(251,c,!1),31==c?p.send("D9"+D+"\t"+V):12==c&&p.send("D7")):251==e&&Y(253,c,!1):Y(254,c,!0):Y(252,c,!0);break;case 250:c=e.getByte();switch(c){case 24:c=e.getByte();ta(e);if(1!=c)break;p.send("DA");break;case 32:c=e.getByte();ta(e);if(1!=c)break;p.send("DC");break;default:ta(e)}break;default:break a}La||(La=!0,p.send("D0"))}else Ea(c);a.getPosition()>=a.getEnd()&&(""!=L&&ra(L),b=!1)}});X.setHandler(ha);this.addSurface=function(a){x=a;Ka&&a.setPlayerMode();M.setContext(x.context);g=M.getContext();
Q=g.canvas;a.forceTextArea=!0;a.setAutoScale(0<c.mode);a.setSize(v+y,z+y);a.setController(ka);a.setFastCopy(ia(k.fastCopy));a.setTouchpad(ia(k.touchpad));a.setClipboard(ia(k.mapClipboard));a.run(99997,!1,!0);a.onclipdata=Za};this.writeText=ca;this.writeRawInput=function(a){if(na){var b=parseInt(a.substring(0,2),16);a=a.substring(2).split("\t");switch(b){case 128:2==a[2]&&$a();return;case 129:return;case 130:return;case 131:return;case 132:b=parseInt(a[1]);a=0==a[0];ca(xa.process(a,b,0));return;case 139:b=
parseInt(a[1]);a=0==a[0];ca(xa.process(a,b,1));return;case 134:ca(xa.process(!0,a[0],3));return}svGlobal.logger.warn("Unknowncode: "+a[1]+" type:"+b)}};var xa=new function(a,b,c){var e=!1,d=!1,f=!1;this.process=function(a,b,c){if(3==c)return b;if(0==c){switch(b){case 29:case 157:return e=a,"";case 56:case 184:return d=a,"";case 42:case 54:return f=a,""}if(a){switch(b){case 28:a="\r\n";break;case 200:a="\u001b[A";break;case 208:a="\u001b[B";break;case 205:a="\u001b[C";break;case 203:a="\u001b[D";break;
case 59:a="\u001bOP";break;case 60:a="\u001bOQ";break;case 61:a="\u001bOR";break;case 62:a="\u001bOS";break;case 63:a="\u001b[15~";break;case 64:a="\u001b[17~";break;case 65:a="\u001b[18~";break;case 66:a="\u001b[19~";break;case 67:a="\u001b[20~";break;case 68:a="\u001b[21~";break;case 87:a="\u001b[23~";break;case 88:a="\u001b[24~";break;case 15:a="\t";break;case 209:a="\u001b[6~";break;case 201:a="\u001b[5~";break;case 199:a="\u001b[H";break;case 207:a="\u001b[F";break;case 14:a=f?"\b":"\u007f";
break;case 211:a="\u001b[3~";break;case 197:a="\u00ff\u00f3";break;case 210:a="\u001b[2~";break;case 1:a="\u001b";break;default:return console.log("Invalid code:"+b),""}d&&(a="\u001b"+a);return a}return""}if(1==c&&e){if(64<b&&91>b)return String.fromCharCode(b-64);switch(b){case 54:return"\u001e";case 219:return"\u001b";case 220:return"\u001c";case 221:return"\u001d";case 32:return"\x00";case 192:return"\u001e";case 191:return"\u001f";default:return console.log("Invalid key code:"+b),""}}if(d)return"\u001b"+
String.fromCharCode(b).toLowerCase()}}};
