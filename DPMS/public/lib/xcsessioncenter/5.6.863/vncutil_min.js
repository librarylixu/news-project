function DesCipher(n){function C(c,b,h){var a,f=Array(56),d=Array(56),g=Array(32);for(a=0;56>a;++a){var e=r[a];var k=e&7;f[a]=0!=(c[e>>>3]&D[k])?1:0}for(c=0;16>c;++c){k=b?c<<1:15-c<<1;var l=k+1;for(a=g[k]=g[l]=0;28>a;++a)e=a+z[c],d[a]=28>e?f[e]:f[e-28];for(a=28;56>a;++a)e=a+z[c],d[a]=56>e?f[e]:f[e-28];for(a=0;24>a;++a)0!=d[A[a]]&&(g[k]|=E[a]),0!=d[A[a+24]]&&(g[l]|=E[a])}for(k=e=f=0;16>f;++f)b=g[e++],a=g[e++],h[k]=(b&16515072)<<6,h[k]|=(b&4032)<<10,h[k]|=(a&16515072)>>>10,h[k]|=(a&4032)>>>6,++k,h[k]=
(b&258048)<<12,h[k]|=(b&63)<<16,h[k]|=(a&258048)>>>4,h[k]|=a&63,++k}function F(c,b,h){var a,f=0;var d=c[0];var g=c[1];var e=(d>>>4^g)&252645135;g^=e;d^=e<<4;e=(d>>>16^g)&65535;g^=e;d^=e<<16;e=(g>>>2^d)&858993459;d^=e;g^=e<<2;e=(g>>>8^d)&16711935;d^=e;g^=e<<8;g=g<<1|g>>>31&1;e=(d^g)&2863311530;d^=e;g^=e;d=d<<1|d>>>31&1;for(a=0;8>a;++a)e=g<<28|g>>>4,e^=h[f++],c=I[e&63],c|=J[e>>>8&63],c|=G[e>>>16&63],c|=w[e>>>24&63],e=g^h[f++],c|=K[e&63],c|=L[e>>>8&63],c|=H[e>>>16&63],c|=t[e>>>24&63],d^=c,e=d<<28|d>>>
4,e^=h[f++],c=I[e&63],c|=J[e>>>8&63],c|=G[e>>>16&63],c|=w[e>>>24&63],e=d^h[f++],c|=K[e&63],c|=L[e>>>8&63],c|=H[e>>>16&63],c|=t[e>>>24&63],g^=c;g=g<<31|g>>>1;e=(d^g)&2863311530;d^=e;g^=e;d=d<<31|d>>>1;e=(d>>>8^g)&16711935;g^=e;d^=e<<8;e=(d>>>2^g)&858993459;g^=e;d^=e<<2;e=(g>>>16^d)&65535;d^=e;g^=e<<16;e=(g>>>4^d)&252645135;b[0]=g^e<<4;b[1]=d^e}function B(c,b,h,a,m){for(var d=0;d<m;++d)h[a+d]=(c[b+4*d]&255)<<24|(c[b+4*d+1]&255)<<16|(c[b+4*d+2]&255)<<8|c[b+4*d+3]&255}function x(c,b,h,a,m){for(var d=
0;d<m;++d)h[a+4*d]=c[b+d]>>>24&255,h[a+4*d+1]=c[b+d]>>>16&255,h[a+4*d+2]=c[b+d]>>>8&255,h[a+4*d+3]=c[b+d]&255}var D=[1,2,4,8,16,32,64,128],E=[8388608,4194304,2097152,1048576,524288,262144,131072,65536,32768,16384,8192,4096,2048,1024,512,256,128,64,32,16,8,4,2,1],r=[56,48,40,32,24,16,8,0,57,49,41,33,25,17,9,1,58,50,42,34,26,18,10,2,59,51,43,35,62,54,46,38,30,22,14,6,61,53,45,37,29,21,13,5,60,52,44,36,28,20,12,4,27,19,11,3],z=[1,2,4,6,8,10,12,14,15,17,19,21,23,25,27,28],A=[13,16,10,23,0,4,2,27,14,5,
20,9,22,18,11,3,25,7,15,6,26,19,12,1,40,51,30,36,46,54,29,39,50,44,32,47,43,48,38,55,33,52,45,41,49,35,28,31],w=[16843776,0,65536,16843780,16842756,66564,4,65536,1024,16843776,16843780,1024,16778244,16842756,16777216,4,1028,16778240,16778240,66560,66560,16842752,16842752,16778244,65540,16777220,16777220,65540,0,1028,66564,16777216,65536,16843780,4,16842752,16843776,16777216,16777216,1024,16842756,65536,66560,16777220,1024,4,16778244,66564,16843780,65540,16842752,16778244,16777220,1028,66564,16843776,
1028,16778240,16778240,0,65540,66560,0,16842756],t=[2148565024,2147516416,32768,1081376,1048576,32,2148532256,2147516448,2147483680,2148565024,2148564992,2147483648,2147516416,1048576,32,2148532256,1081344,1048608,2147516448,0,2147483648,32768,1081376,2148532224,1048608,2147483680,0,1081344,32800,2148564992,2148532224,32800,0,1081376,2148532256,1048576,2147516448,2148532224,2148564992,32768,2148532224,2147516416,32,2148565024,1081376,32,32768,2147483648,32800,2148564992,1048576,2147483680,1048608,
2147516448,2147483680,1048608,1081344,0,2147516416,32800,2147483648,2148532256,2148565024,1081344],G=[520,134349312,0,134348808,134218240,0,131592,134218240,131080,134217736,134217736,131072,134349320,131080,134348800,520,134217728,8,134349312,512,131584,134348800,134348808,131592,134218248,131584,131072,134218248,8,134349320,512,134217728,134349312,134217728,131080,520,131072,134349312,134218240,0,512,131080,134349320,134218240,134217736,512,0,134348808,134218248,131072,134217728,134349320,8,131592,
131584,134217736,134348800,134218248,520,134348800,131592,8,134348808,131584],H=[8396801,8321,8321,128,8396928,8388737,8388609,8193,0,8396800,8396800,8396929,129,0,8388736,8388609,1,8192,8388608,8396801,128,8388608,8193,8320,8388737,1,8320,8388736,8192,8396928,8396929,129,8388736,8388609,8396800,8396929,129,0,0,8396800,8320,8388736,8388737,1,8396801,8321,8321,128,8396929,129,1,8192,8388609,8193,8396928,8388737,8193,8320,8388608,8396801,128,8388608,8192,8396928],J=[256,34078976,34078720,1107296512,
524288,256,1073741824,34078720,1074266368,524288,33554688,1074266368,1107296512,1107820544,524544,1073741824,33554432,1074266112,1074266112,0,1073742080,1107820800,1107820800,33554688,1107820544,1073742080,0,1107296256,34078976,33554432,1107296256,524544,524288,1107296512,256,33554432,1073741824,34078720,1107296512,1074266368,33554688,1073741824,1107820544,34078976,1074266368,256,33554432,1107820544,1107820800,524544,1107296256,1107820800,34078720,0,1074266112,1107296256,524544,33554688,1073742080,
524288,0,1074266112,34078976,1073742080],L=[536870928,541065216,16384,541081616,541065216,16,541081616,4194304,536887296,4210704,4194304,536870928,4194320,536887296,536870912,16400,0,4194320,536887312,16384,4210688,536887312,16,541065232,541065232,0,4210704,541081600,16400,4210688,541081600,536870912,536887296,16,541065232,4210688,541081616,4194304,16400,536870928,4194304,536887296,536870912,16400,536870928,541081616,4210688,541065216,4210704,541081600,0,541065232,16,16384,541065216,4210704,16384,
4194320,536887312,0,541081600,536870912,4194320,536887312],I=[2097152,69206018,67110914,0,2048,67110914,2099202,69208064,69208066,2097152,0,67108866,2,67108864,69206018,2050,67110912,2099202,2097154,67110912,67108866,69206016,69208064,2097154,69206016,2048,2050,69208066,2099200,2,67108864,2099200,67108864,2099200,2097152,67110914,67110914,69206018,69206018,2,2097154,67108864,67110912,2097152,69208064,2050,2099202,69208064,2050,67108866,69208066,69206016,2099200,0,2,69208066,0,2099202,69206016,2048,
67108866,67110912,2048,2097154],K=[268439616,4096,262144,268701760,268435456,268439616,64,268435456,262208,268697600,268701760,266240,268701696,266304,4096,64,268697600,268435520,268439552,4160,266240,262208,268697664,268701696,4160,0,0,268697664,268435520,268439552,266304,262144,266304,262144,268701696,4096,64,268697664,4096,266304,268439552,64,268435520,268697600,268697664,268435456,262144,268439616,0,268701760,262208,268435520,268697600,268439552,268439616,0,268701760,266240,266240,4160,4160,262208,
268435456,268701696],u=Array(32);u[0]=0;var y=Array(32);y[0]=0;this.setKey=function(b){C(b,!0,u);C(b,!1,y)};this.setKey(n);var b=[0,0];this.encrypt=function(c,f,h,a){B(c,f,b,0,2);F(b,b,u);x(b,0,h,a,2)};this.decrypt=function(c,f,h,a){B(c,f,b,0,2);F(b,b,y);x(b,0,h,a,2)}}
function TINF(){function n(){this.table=Array(16);this.table[0]=0;this.trans=Array(288);this.trans[0]=0}function C(){this.source="";this.bitcount=this.tag=this.sourceIndex=0;this.dest=Array(4096);this.destIndex=this.dest[0]=0;this.history=[0];this.history.length=0;this.ltree=new n;this.dtree=new n;this.status=0}function F(b,c,f,h){var a;for(a=0;a<f;++a)b[a]=0;for(a=0;a<30-f;++a)b[a+f]=Math.floor(a/f);f=h;for(a=0;30>a;++a)c[a]=f,f+=1<<b[a]}function B(b,c,f,h){var a=L,m,d=b.table,g=b.trans;for(b=0;16>
b;++b)d[b]=0;for(b=0;b<h;++b)d[c[f+b]]++;for(b=m=d[0]=0;16>b;++b)a[b]=m,m+=d[b];for(b=0;b<h;++b)c[f+b]&&(g[a[c[f+b]]++]=b)}function x(b,c,f){if(!c)return f;for(var h;24>b.bitcount;)b.tag|=b.source[b.sourceIndex++]<<b.bitcount,b.bitcount+=8;h=b.tag&65535>>16-c;b.tag>>=c;b.bitcount-=c;return h+f}function D(b,c){for(;16>b.bitcount;)b.tag|=b.source[b.sourceIndex++]<<b.bitcount,b.bitcount+=8;var f=0,h=0,a=0;do h=2*h+((b.tag&1<<a)>>a),++a,f+=c.table[a],h-=c.table[a];while(0<=h);b.tag>>=a;b.bitcount-=a;
return c.trans[f+h]}function E(b,c,f){for(var h=b.dest,a=b.destIndex,m=b.history;;){var d=D(b,c);if(256==d)break;if(256>d)h[a++]=d,m.push(d);else{var g,d=d-257,d=x(b,w[d],t[d]);var e=D(b,f);for(g=e=m.length-x(b,G[e],H[e]);g<e+d;++g)h[a++]=m[g],m.push(b.history[g])}}b.destIndex=a;return r.OK}this.OK=0;this.DATA_ERROR=-3;var r=this,z=new n,A=new n,w=Array(30),t=Array(30),G=Array(30),H=Array(30),J=[16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15],L=Array(16),I=new n,K=Array(320),u=new C,y=0;this.reset=
function(){u=new C;y=0};this.release=function(){r=u=null};this.init=function(b){var c,f=z.table,h=z.trans,a=A.table,m=A.trans;for(c=0;7>c;++c)f[c]=0;f[7]=24;f[8]=152;f[9]=112;for(c=0;24>c;++c)h[c]=256+c;for(c=0;144>c;++c)h[24+c]=c;for(c=0;8>c;++c)h[168+c]=280+c;for(c=0;112>c;++c)h[176+c]=144+c;for(c=0;5>c;++c)a[c]=0;a[5]=32;for(c=0;32>c;++c)m[c]=c;F(w,t,4,3);F(G,H,2,1);w[28]=0;t[28]=258;this.reset();b&&(y=b)};this.getHistory=function(){return u.history};this.setHistory=function(b){u.history=b};this.uncompress=
function(b,c){var f=u;f.source=b;f.sourceIndex=c;f.bitcount=0;f.destIndex=0;y||(y=x(f,16,0));var h=0;do{var a=f;a.bitcount--||(a.tag=a.source[a.sourceIndex++]&255,a.bitcount=7);var m=a.tag&1;a.tag>>=1;switch(x(f,2,0)){case 0:a=f;var d=a.source,g=a.history,e=a.dest,k=a.destIndex;7<a.bitcount&&(a.sourceIndex-=Math.floor(a.bitcount/8),a.bitcount=0,a.tag=0);var l=d[a.sourceIndex+1];l=256*l+d[a.sourceIndex];var v=d[a.sourceIndex+3];v=256*v+d[a.sourceIndex+2];if(l!=(~v&65535))a=r.DATA_ERROR;else{a.sourceIndex+=
4;for(v=l;v;--v)g.push(d[a.sourceIndex]),e[k++]=d[a.sourceIndex++];a.bitcount=0;a.destIndex=k;a=r.OK}break;case 1:a=E(f,z,A);break;case 2:var p,g=f,e=f.ltree,k=f.dtree;v=I;l=K;var n=x,w=D,d=n(g,5,257);a=n(g,5,1);var q=n(g,4,4);for(p=0;19>p;++p)l[p]=0;for(p=0;p<q;++p){var t=n(g,3,0);l[J[p]]=t}B(v,l,0,19);for(p=0;p<d+a;)switch(q=w(g,v),q){case 16:t=l[p-1];for(q=n(g,2,3);q;--q)l[p++]=t;break;case 17:for(q=n(g,3,3);q;--q)l[p++]=0;break;case 18:for(q=n(g,7,11);q;--q)l[p++]=0;break;default:l[p++]=q}B(e,
l,0,d);B(k,l,d,a);a=E(f,f.ltree,f.dtree);break;default:return f.status=r.DATA_ERROR,f}if(a!=r.OK)return f.status=r.DATA_ERROR,f;h++}while(!m&&f.sourceIndex<f.source.length);f.history=f.history.slice(-32768);f.status=r.OK;return f}};
