var $jscomp=$jscomp||{};$jscomp.scope={};$jscomp.defineProperty="function"==typeof Object.defineProperties?Object.defineProperty:function(u,x,k){u!=Array.prototype&&u!=Object.prototype&&(u[x]=k.value)};$jscomp.getGlobal=function(u){return"undefined"!=typeof window&&window===u?u:"undefined"!=typeof global&&null!=global?global:u};$jscomp.global=$jscomp.getGlobal(this);
$jscomp.polyfill=function(u,x,k,A){if(x){k=$jscomp.global;u=u.split(".");for(A=0;A<u.length-1;A++){var w=u[A];w in k||(k[w]={});k=k[w]}u=u[u.length-1];A=k[u];x=x(A);x!=A&&null!=x&&$jscomp.defineProperty(k,u,{configurable:!0,writable:!0,value:x})}};$jscomp.polyfill("Array.prototype.fill",function(u){return u?u:function(u,k,A){var w=this.length||0;0>k&&(k=Math.max(0,w+k));if(null==A||A>w)A=w;A=Number(A);0>A&&(A=Math.max(0,w+A));for(k=Number(k||0);k<A;k++)this[k]=u;return this}},"es6-impl","es3");
function RdpGeneral(u,x,k,A,w,n,h){function r(c){return"on"==c||"true"==c}function q(){var c=0,a=0,b=0,h=0,d=0;this.on=!1;this.verify=function(e,p,f,k){e==c&&p==a&&f==b&&k==h?this.on||(d++,3<d&&(this.on=!0)):(d=0,this.on=!1,c=e,a=p,b=f,h=k)}}function e(){return wa.displayName||wa.server||wa.symlink||wa.id||"undefined"}function b(c){return 4278190080|(c<<3&248|c>>2&7)<<16|(c>>3&252|c>>9&3)<<8|c>>8&248|c>>13&7}function B(c){return 4278190080|ga.paletteRdp[2][c]<<16|ga.paletteRdp[1][c]<<8|ga.paletteRdp[0][c]}
function d(c){return 4278190080|c}function C(c){return 4278190080|c}function v(c,a){switch(c){case 16:La=b;Fb=rdpBitmap.decompressInt16;break;case 8:La=B;break;case 24:La=C;Fb=rdpBitmap.decompressInt24;break;case 32:La=d;Fb=rdpBitmap.decompressInt32;break;case 15:return wa.invitation||console.log("15 bit color is not supported anymore."),!1;default:return!1}A=c;Ab=(c+7)/8>>0;if(a&&J.onColorChange)J.onColorChange(c);return!0}function V(c,a,b){x=c;k=a;aa=ha=0;fa=x-1;ca=k-1;if(J.onresolutionchange&&
b)J.onresolutionchange(c,a)}function z(c){Ma||N.send(c)}function y(c,a,b,h,d,e,p){this.data=c;this.left=h;this.top=d;this.width=a;this.height=b;this.bitsperpixel=e;this.bytesperpixel=Math.floor((e+7)/8);this.encoding=p||0}function R(){this.style=this.yOrigin=this.xOrigin=0;this.pattern=Array(8);this.toStream=function(c){c.setByte(this.xOrigin);c.setByte(this.yOrigin);c.setByte(this.style);c.setBytes(this.pattern)};this.fromStream=function(c){this.xOrigin=c.getByte();this.yOrigin=c.getByte();this.style=
c.getByte();this.pattern=c.getBytes(8)};this.byteLength=function(){return 11}}function f(){this.bottom=this.top=this.right=this.left=0;this.toStream=function(c){c.setLittleEndian16(this.left);c.setLittleEndian16(this.right);c.setLittleEndian16(this.top);c.setLittleEndian16(this.bottom)};this.fromStream=function(c){this.left=c.getLittleEndian16();this.right=c.getLittleEndian16();this.top=c.getLittleEndian16();this.bottom=c.getLittleEndian16()};this.byteLength=function(){return 8}}function K(){this.action=
this.offset=this.bottom=this.top=this.right=this.left=0;this.toStream=function(c){c.setLittleEndian16(this.left);c.setLittleEndian16(this.right);c.setLittleEndian16(this.top);c.setLittleEndian16(this.bottom);c.setLittleEndian32(this.offset);c.setByte(this.action)};this.fromStream=function(c){this.left=c.getLittleEndian16();this.right=c.getLittleEndian16();this.top=c.getLittleEndian16();this.bottom=c.getLittleEndian16();this.offset=c.getLittleEndian32();this.action=c.getByte()};this.byteLength=function(){return 13}}
function l(){this.opcode=this.cy=this.cx=this.y=this.x=0;this.toStream=function(c){c.setLittleEndian16(this.x);c.setLittleEndian16(this.y);c.setLittleEndian16(this.cx);c.setLittleEndian16(this.cy);c.setByte(this.opcode)};this.fromStream=function(c){this.x=c.getLittleEndian16();this.y=c.getLittleEndian16();this.cx=c.getLittleEndian16();this.cy=c.getLittleEndian16();this.opcode=c.getByte()};this.byteLength=function(){return 9}}function m(c,a,b,h,d){this.offset=c;this.baseLine=a;this.width=b;this.height=
h;this.fontData=d}function p(){this.opcode=this.backgroundColor=this.endY=this.endX=this.startY=this.startX=this.mixmode=0;this.pen=new t;this.toStream=function(c){c.setLittleEndian16(this.mixmode);c.setLittleEndian16(this.startX);c.setLittleEndian16(this.startY);c.setLittleEndian16(this.endX);c.setLittleEndian16(this.endY);c.setLittleEndian32(this.backgroundColor);c.setByte(this.opcode);this.pen.toStream(c)};this.fromStream=function(c){this.mixmode=c.getLittleEndian16();this.startX=c.getLittleEndian16();
this.startY=c.getLittleEndian16();this.endX=c.getLittleEndian16();this.endY=c.getLittleEndian16();this.backgroundColor=c.getLittleEndian32();this.opcode=c.getByte();this.pen.fromStream(c)};this.byteLength=function(){return 15+this.pen.byteLength()}}function D(){this.cacheIDX=this.cacheID=this.colorTable=this.srcY=this.srcX=this.opcode=this.cy=this.cx=this.y=this.x=0;this.toStream=function(c){c.setLittleEndian16(this.x);c.setLittleEndian16(this.y);c.setLittleEndian16(this.cx);c.setLittleEndian16(this.cy);
c.setByte(this.opcode);c.setLittleEndian16(this.srcX);c.setLittleEndian16(this.srcY);c.setByte(this.cacheID);c.setByte(this.colorTable);c.setLittleEndian16(this.cacheIDX)};this.fromStream=function(c){this.x=c.getLittleEndian16();this.y=c.getLittleEndian16();this.cx=c.getLittleEndian16();this.cy=c.getLittleEndian16();this.opcode=c.getByte();this.srcX=c.getLittleEndian16();this.srcY=c.getLittleEndian16();this.cacheID=c.getByte();this.colorTable=c.getByte();this.cacheIDX=c.getLittleEndian16()};this.byteLength=
function(){return 17}}function S(){this.foregroundColor=this.backgroundColor=this.opcode=this.cy=this.cx=this.y=this.x=0;this.brush=new R;this.toStream=function(c){c.setLittleEndian16(this.x);c.setLittleEndian16(this.y);c.setLittleEndian16(this.cx);c.setLittleEndian16(this.cy);c.setByte(this.opcode);c.setLittleEndian32(this.backgroundColor);c.setLittleEndian32(this.foregroundColor);this.brush.toStream(c)};this.fromStream=function(c){this.x=c.getLittleEndian16();this.y=c.getLittleEndian16();this.cx=
c.getLittleEndian16();this.cy=c.getLittleEndian16();this.opcode=c.getByte();this.backgroundColor=c.getLittleEndian32();this.foregroundColor=c.getLittleEndian32();this.brush.fromStream(c)};this.byteLength=function(){return 17+this.brush.byteLength()}}function t(){this.color=this.width=this.style=0;this.toStream=function(c){c.setByte(this.style);c.setByte(this.width);c.setLittleEndian32(this.color)};this.fromStream=function(c){this.style=c.getByte();this.width=c.getByte();this.color=c.getLittleEndian32()};
this.byteLength=function(){return 6}}function P(){this.dataSize=this.opcode=this.lines=this.foregroundColor=this.flags=this.y=this.x=0;this.data=[];this.toStream=function(c){c.setLittleEndian16(this.x);c.setLittleEndian16(this.y);c.setByte(this.opcode);c.setLittleEndian32(this.foregroundColor);c.setByte(this.lines);c.setByte(this.dataSize);this.dataSize&&c.setBytes(this.data)};this.fromStream=function(c){this.x=c.getLittleEndian16();this.y=c.getLittleEndian16();this.opcode=c.getByte();this.foregroundColor=
c.getLittleEndian32();this.lines=c.getByte();if(this.dataSize=c.getByte())this.data=c.getBytes(this.dataSize)};this.byteLength=function(){return 11+this.dataSize}}function ja(){this.color=this.cy=this.cx=this.y=this.x=0;this.toStream=function(c){c.setLittleEndian16(this.x);c.setLittleEndian16(this.y);c.setLittleEndian16(this.cx);c.setLittleEndian16(this.cy);c.setLittleEndian32(this.color)};this.fromStream=function(c){this.x=c.getLittleEndian16();this.y=c.getLittleEndian16();this.cx=c.getLittleEndian16();
this.cy=c.getLittleEndian16();this.color=c.getLittleEndian32()};this.byteLength=function(){return 12}}function Z(){this.srcY=this.srcX=this.opcode=this.cy=this.cx=this.y=this.x=0;this.toStream=function(c){c.setLittleEndian16(this.x);c.setLittleEndian16(this.y);c.setLittleEndian16(this.cx);c.setLittleEndian16(this.cy);c.setByte(this.opcode);c.setLittleEndian16(this.srcX);c.setLittleEndian16(this.srcY)};this.fromStream=function(c){this.x=c.getLittleEndian16();this.y=c.getLittleEndian16();this.cx=c.getLittleEndian16();
this.cy=c.getLittleEndian16();this.opcode=c.getByte();this.srcX=c.getLittleEndian16();this.srcY=c.getLittleEndian16()};this.byteLength=function(){return 13}}function ka(){this.length=this.opcode=this.boxBottom=this.boxRight=this.boxTop=this.boxLeft=this.clipBottom=this.clipRight=this.clipTop=this.clipLeft=this.font=this.unknown=this.y=this.x=this.backgroundColor=this.foregroundColor=this.mixmode=this.flags=0;this.text=null;this.toStream=function(c){c.setByte(this.font);c.setByte(this.flags);c.setByte(this.opcode);
c.setByte(this.mixmode);c.setLittleEndian32(this.foregroundColor);c.setLittleEndian32(this.backgroundColor);c.setLittleEndian16(this.clipLeft);c.setLittleEndian16(this.clipTop);c.setLittleEndian16(this.clipRight);c.setLittleEndian16(this.clipBottom);c.setLittleEndian16(this.boxLeft);c.setLittleEndian16(this.boxTop);c.setLittleEndian16(this.boxRight);c.setLittleEndian16(this.boxBottom);c.setLittleEndian16(this.x);c.setLittleEndian16(this.y);c.setByte(this.length);this.length&&c.setBytes(this.text)};
this.fromStream=function(c){this.font=c.getByte();this.flags=c.getByte();this.opcode=c.getByte();this.mixmode=c.getByte();this.foregroundColor=c.getLittleEndian32();this.backgroundColor=c.getLittleEndian32();this.clipLeft=c.getLittleEndian16();this.clipTop=c.getLittleEndian16();this.clipRight=c.getLittleEndian16();this.clipBottom=c.getLittleEndian16();this.boxLeft=c.getLittleEndian16();this.boxTop=c.getLittleEndian16();this.boxRight=c.getLittleEndian16();this.boxBottom=c.getLittleEndian16();this.x=
c.getLittleEndian16();this.y=c.getLittleEndian16();if(this.length=c.getByte())this.text=c.getBytes(this.length)};this.byteLength=function(){return 33+this.length}}function M(){this.orderType=0;this.bounds=new f;this.destBlt=new l;this.patBlt=new S;this.screenBlt=new Z;this.line=new p;this.rectangle=new ja;this.deskSave=new K;this.memBlt=new D;this.polyLine=new P;this.text2=new ka;this._line=new hi5.graphic.Line;this.paletteRdp=null;this.toPDU=function(){var c=4+this.bounds.byteLength()+this.destBlt.byteLength()+
this.patBlt.byteLength()+this.screenBlt.byteLength()+this.line.byteLength()+this.rectangle.byteLength()+this.deskSave.byteLength()+this.memBlt.byteLength()+this.polyLine.byteLength()+this.text2.byteLength()+14+10,a=new Uint8Array(c);a[0]=29;a[2]=1;a[3]=3;c=new hi5.DataBuffer(a,0,c);c.skipPosition(4);this.bounds.toStream(c);this.destBlt.toStream(c);this.patBlt.toStream(c);this.screenBlt.toStream(c);this.line.toStream(c);this.rectangle.toStream(c);this.deskSave.toStream(c);this.memBlt.toStream(c);this.polyLine.toStream(c);
this.text2.toStream(c);c.setLittleEndian16(ha);c.setLittleEndian16(aa);c.setLittleEndian16(fa);c.setLittleEndian16(ca);c.setLittleEndian32(Na);c.setByte(this.orderType);c.setByte(A);ab.toStream(c);return a};this.fromStream=function(c){this.bounds.fromStream(c);this.destBlt.fromStream(c);this.patBlt.fromStream(c);this.screenBlt.fromStream(c);this.line.fromStream(c);this.rectangle.fromStream(c);this.deskSave.fromStream(c);this.memBlt.fromStream(c);this.polyLine.fromStream(c);this.text2.fromStream(c);
ha=c.getLittleEndian16();aa=c.getLittleEndian16();fa=c.getLittleEndian16();ca=c.getLittleEndian16();Na=c.getLittleEndian32();this.orderType=c.getByte();v(c.getByte(),!0);ab.fromStream(c)}}function G(){ya=Fa=!1;vc();ga=new M;Na=0;ba&&ba.reset();I&&I.reset()}function pa(){function c(c){bb=new RecordingManager;bb.setHeader({name:0<c.user.length?c.server+"_"+c.user:c.server,width:x,height:k,color:A,namesuffix:".rdpv",filetag:"RDPV",duration:0})}if(!Fa){ya=!1;if(Ma)N=Ma;else{if(J.oncreatewebsocket)N=J.oncreatewebsocket(u);
else{var b=0==J.mode&&h?u.substring(0,u.indexOf("?"))+"?_METHOD=post":u;N=new WebSocket(b,"rdp")}"binaryType"in N&&(N.binaryType="arraybuffer")}svGlobal.logger.info(u);N.onopen=function(c){Fa=!0;if(J.onopen)J.onopen();z("87"+navigator.userAgent)};"on"==wa.recording&&c(wa);N.onmessage=a;N.onclose=Va;N.onerror=J.onerror}}function a(c){var a=c.data;if("string"!=typeof a){var b=new Uint8Array(a);null!=bb&&bb.add(new RecordingObj(b,0,a.byteLength,-1));ua.attach(b,0,a.byteLength);var h=ua.getLittleEndian16();
switch(h){case 29:ec(ua);break;case 48:if(J.onSlowPath)J.onSlowPath();var d=ua;d.getLittleEndian16();var e=d.getByte(),p=d.getByte(),f=d.getLittleEndian16(),k=0!=(p&32);k&&(f-=18);if(k)if(3==(p&15)){var D=d.getByte();var n=d.getByte();f-=2;if(0!=(D&16)&&0!=(n&32)){ba.dec5(d.getData(),d.getPosition(),f,n);var l=ba.getData(),t=ba.getDecompressedLength();I.dec(l.getData(),l.getPosition(),t,D)}else I.dec(d.getData(),d.getPosition(),f,D);var q=I.getData()}else ba.dec(d.getData(),d.getPosition(),f,p),q=
ba.getData();else q=d;var m=q;switch(e){case 2:var v=m.getLittleEndian16();switch(v){case 0:m.skipPosition(2);var y=m.getLittleEndian16();m.skipPosition(2);jb(m,y);break;case 1:H(m);break;case 2:kb(m);break;case 3:break;default:svGlobal.logger.warn("Unimplemented Update type "+v)}break;case 20:break;case 31:fb=!1;break;case 27:var B=m.getLittleEndian16();m.skipPosition(2);switch(B){case 3:var pa=m.getLittleEndian16();var A=m.getLittleEndian16();J.onMoveCursor(pa,A,!0);break;case 6:ta(m,24);break;
case 7:w.setCursor(m.getLittleEndian16());break;case 1:var C=m.getLittleEndian16();switch(C){case 0:break;default:svGlobal.logger.warn("XXX system pointer message "+C)}break;case 8:var K=m.getLittleEndian16();ta(m,K)}break;case 34:break;case 38:a:{var G=m.getLittleEndian32(),x=J.sessionInfo;if(3>G){var S=J.sessionInfo;switch(G){case 0:m.skipPosition(4);S.domain=m.getUnicodeString(52,!0);m.skipPosition(4);S.userName=m.getUnicodeString(512,!0);S.sessionId=m.getLittleEndian32();break;case 1:S.version=
m.getLittleEndian16();m.skipPosition(4);S.sessionId=m.getLittleEndian32();var F=m.getLittleEndian32();var ka=m.getLittleEndian32();m.skipPosition(558);S.domain=m.getUnicodeString(F,!0);S.userName=m.getUnicodeString(ka,!0)}}else if(3==G){m.skipPosition(2);var P=m.getLittleEndian32();m.skipPosition(4);if(2==P)break a;m.getLittleEndian32();m.skipPosition(4);x.sessionId=m.getLittleEndian32();for(var R=m.getBytes(16),Q=Array(16),T=0;16>T;T++)Q[T]=R[T]&255;x.random=Q}if(!ya&&J.onloggedin)J.onloggedin(J.sessionInfo);
ya=!0;var Z="8D";x.sessionId&&(Z+=x.sessionId+"\t"+(x.random?hi5.Base64.enc(x.random):0)+"\t"+x.userName+"\t"+x.domain);W||z(Z)}fb=!1;break;case 40:J.sendKeyboardSynchronize(r(wa.scrollLock),r(wa.numLock),r(wa.capsLock));fb=!1;break;case 41:m.skipPosition(2);var ja=m.getLittleEndian16(),X=0!=(ja&4),Y=0!=(ja&2),N=0!=(ja&1),ca=0!=(ja&8);if(J.onLockKeyState)J.onLockKeyState({capsLock:X,numLock:Y,scrollLock:N,kanaLock:ca});svGlobal.logger.info("LED state, capsLock:"+X+" numLock:"+Y+" scrollLock:"+N+" kanaLock:"+
ca);break;case 47:fb=!0;var aa=m.getLittleEndian32();svGlobal.logger.info("Disconnect:"+aa);var U=11==aa&&cb;if(U)J.onCloseSurface();if(!(1>aa||U)){!W&&Fa&&z("85"+aa);var fa=aa.toString(16).toUpperCase();if(J.onerror)J.onerror(fa)}break;case 50:m.skipPosition(4);break;case 54:var ha=m.getLittleEndian32().toString(16).toUpperCase();svGlobal.logger.warn("server status code:"+ha);break;case 55:for(var E=m.getLittleEndian32(),O,sa,Yb,Oa,da=0,xa=0,$a=0,La=0,Za=0;Za<E;Za++)O=m.getLittleEndian32(),sa=m.getLittleEndian32(),
Yb=m.getLittleEndian32(),Oa=m.getLittleEndian32(),m.skipPosition(4),da=Math.min(O,da),xa=Math.max(xa,Yb),$a=Math.min(sa,$a),La=Math.max(La,Oa);O=xa-da+1;sa=La-$a+1;svGlobal.logger.warn("monitor, count:"+E+" w:"+O+" h:"+sa);V(O,sa,!0);break;default:svGlobal.logger.warn("Unimplemented Data PDU type "+e)}break;case 49:if(J.onFastPath)J.onFastPath();a:{var Ja=ua,Hb=Ja.getByte(),fc=Hb&15,Wa=Hb>>4&3,Na=0;2==(Hb>>6&3)&&(Na=Ja.getByte());var sb=0!=(Na&32);var ma=Ja.getLittleEndian16();if(sb)if(3==(Na&15)){var mb=
Ja.getByte();var Ma=Ja.getByte();ma-=2;if(0!=(mb&16)&&0!=(Ma&32)){ba.dec5(Ja.getData(),Ja.getPosition(),ma,Ma);var tb=ba.getData(),Bb=ba.getDecompressedLength();I.dec(tb.getData(),tb.getPosition(),Bb,mb)}else I.dec(Ja.getData(),Ja.getPosition(),ma,mb);var db=I.getData();ma=I.getDecompressedLength()}else ba.dec(Ja.getData(),Ja.getPosition(),ma,Na),db=ba.getData(),ma=ba.getDecompressedLength();else db=Ja;if(0!=Wa)switch(Wa){case 2:case 3:nb.addFragement(db,ma);break a;case 1:nb.addFragement(db,ma),
db=nb.clearFragements()}var na=db;ia&&ia.begin("decodeFastPath");switch(fc){case 0:var ub=na.getLittleEndian16();jb(na,ub);break;case 1:na.skipPosition(2);H(na);break;case 2:na.skipPosition(2);kb(na);break;case 3:break;case 4:for(var Pa=na.getEnd(),xb,Cb;na.getPosition()<Pa;){var Aa=na.getLittleEndian16();switch(Aa){case 1:case 6:xb=na.getLittleEndian16();Cb=na.getLittleEndian16();na.getLittleEndian16();na.getBigEndian16();var Ka=void 0,Qa=void 0,oa=na,Xa=xb,Db=Cb,ob=oa.getByte();oa.skipPosition(2);
var Ya=oa.getByte(),Ra=oa.getLittleEndian16(),Ba=oa.getLittleEndian16(),vb=oa.getLittleEndian32(),ab=oa.getPosition()+vb;switch(Ya){case 0:var Ca=rdpBitmap.byte2int(oa.getData(),vb,oa.getPosition()),Qa=new Uint32Array(Ca.length);Ib(Ca,0,Qa,Ra,Ba,1);w.setRGBs(Xa,Db,Ra,Ba,Qa,0,Ra);break;case 1:jc(oa,ob,Ra,Ba,gb);var Va=gb.getData(),pb=gb.getDataSize(),Qa=new Uint32Array(pb);Ib(Va,0,Qa,Ra,Ba,1);w.setRGBs(Xa,Db,Ra,Ba,Qa,0,Ra);break;case 3:for(var Ga=Da.decode(oa,vb),Zc=Ga.getRects(),yb=Ga.getTiles(),
$c=Ga.getTileSize(),Jb=Ga.getRectSize(),Ha=Jb?new L(0,0,0,0):null,Kb=0;Kb<$c;Kb++){var Sa=yb[Kb];if(Jb)for(var Lb=0;Lb<Jb;Lb++)Zc[Lb].intersection(Sa.x,Sa.y,64,64,Ha),Ha.isEmpty()||(Ka=64*(Ha.y-Sa.y)+(Ha.x-Sa.x),Ha.x+=Xa,Ha.y+=Db,w.setRGBs(Ha.x,Ha.y,Ha.width,Ha.height,Sa.data,Ka,64));else w.setRGBs(Sa.x,Sa.y,64,64,Sa.data,0,64)}}oa.setPosition(ab);break;case 4:var Ta=na,va=Ta.getLittleEndian16(),Mb=Ta.getLittleEndian32();1==va&&z("91"+Mb);break;default:svGlobal.logger.warn("Invalid surface cmd:"+
Aa)}}break;case 5:break;case 6:break;case 8:break;case 9:ta(na,24);break;case 10:w.setCursor(na.getLittleEndian16());break;case 11:var qc=na.getLittleEndian16();ta(na,qc);break;default:svGlobal.logger.warn("XXX RDP5 opcode "+fc)}ia&&ia.end("decodeFastPath")}break;case 65:var qa=ua,Fb=qa.getPosition(),qb=qa.getByte(),ra=qa.getByte();seqNoLow=qa.getByte();seqNoHigh=qa.getByte();reqType=qa.getLittleEndian16;out=null;payloadLen=0;payload=null;averageRTT=bandwidth=baseRTT=0;if(0!=ra)svGlobal.logger.warn("invalid msg channel data");
else switch(reqType){case 1:case 4097:out=new Uint8Array(7);out[0]=65;out.set(qa.getData().subarray(Fb,Fb+4),1);out[5]=0;out[6]=0;z(out.buffer);break;case 20:case 276:case 4116:break;case 2:8==qb?(payloadLen=qa.getLittleEndian16(),payload=qa.getByte(payloadLen)):svGlobal.logger.warn("Invalid payload");break;case 43:8==qb?(payloadLen=qa.getLittleEndian16(),payload=qa.getByte(payloadLen)):svGlobal.logger.warn("Invalid payload");break;case 1065:case 1577:break;case 2112:baseRTT=qa.getLittleEndian32();
averageRTT=qa.getLittleEndian32();break;case 2176:bandwidth=qa.getLittleEndian32();averageRTT=qa.getLittleEndian32();break;case 2240:baseRTT=qa.getLittleEndian32();bandwidth=qa.getLittleEndian32();averageRTT=qa.getLittleEndian32();break;default:svGlobal.logger.warn("Invalid msg channel type:"+reqType)}break;case 62:rb(ua.getUnicodeString(ua.getEnd()-ua.getPosition(),!1));default:if(J.onmessage)J.onmessage(c)}}else{h=parseInt(a.substring(0,2),16);var eb=a.substring(2);switch(h){case 0:var Rb=u.substring(u.indexOf("?")+
1);z("00"+Rb);z("87"+navigator.userAgent);break;case 15:if(J&&(Wb=fb=!1,ga=new M,!W&&J&&J.onready))J.onready();case 26:fb=!0;case 62:rb(eb);default:J.onmessage(c)}}}function rb(c){var a=parseInt(c.substring(0,1),16);c=c.substring(1);switch(a){case 0:c=JSON.parse(c),G(),Fa=!0,a=c.width,c=c.height,a==x&&c==k||V(a,c,!1,!1)}}function ec(c){var a=c.getByte();if(0==a){svGlobal.logger.info("Send history...");var b=new Uint8Array(4);b[0]=29;b[2]=1;b[3]=1;N.send(b.buffer);w.getHistory(z,function(){ia&&ia.begin("his_mppc");
(b=ba.toPDU())&&N.send(b.buffer);ia&&ia.end("his_mppc");if(I){ia&&ia.begin("his_mppc61");var c=I.toPDU();c&&N.send(c.buffer);ia&&ia.end("his_mppc61")}ia&&ia.begin("his_order");N.send(ga.toPDU().buffer);ia&&ia.end("his_order");b=new Uint8Array(5);b[0]=29;b[2]=1;b[3]=0;b[4]=1;N.send(b.buffer)})}else switch(a=c.getByte(),a){case 0:svGlobal.logger.warn("Received history");c.has(1)&&1==c.getByte()&&!J.sessionInfo.suppressOutput&&J.refreshOutput(0,0,x-1,k-1);if(J.onHistoryReceived)J.onHistoryReceived();
break;case 1:break;case 2:ia&&ia.begin("his_mppc_dec");ba.fromStream(c);ia&&ia.end("his_mppc_dec");break;case 3:ia&&ia.begin("his_order_dec");ga.fromStream(c);ia&&ia.end("his_order_dec");break;case 9:I||(I=new Bulk61Data);ia&&ia.begin("his_mppc_dec61");I.fromStream(c);ia&&ia.end("his_mppc_dec61");break;default:w.setHistory(a,c)}if(J.onReqHistory)J.onReqHistory()}function Ib(c,a,b,h,d,e){e*=h;for(var p=0;p<d;p++)h=a+(d-p-1)*e,Xb(c,h,b,p*e,e)}function Yb(c,a,b,h,d,e,p,f){this.x=c;this.y=a;this.width=
b;this.height=h;this.mask=d;this.pixel=e;this.bpp=p;this.cache_idx=f}function ta(c,a){if(!xa){var b=c.getLittleEndian16();var h=c.getLittleEndian16();var d=c.getLittleEndian16();var e=c.getLittleEndian16();var p=c.getLittleEndian16();var f=c.getLittleEndian16();var m=c.getLittleEndian16();var k=c.getBytes(m);f=c.getBytes(f);if(0>h||h>=e-1)h=0;0>d?d=0:d>=p&&(d=p-1);for(var D=0;D<m&&0==k[D];D++);D=new Yb(h,d,e,p,f,k,a,b);h=D.x;d=D.y;e=D.width;p=D.height;m=D.mask;k=D.pixel;f=D.bpp;for(var D=D.cache_idx,
n=new Uint32Array(e*p),l=n[0]=0,r=!0,t=m.length,q=0;q<t;q++)if(0!=m[q]){r=!1;break}for(var ea,q=0;q<p;q++)for(t=0;t<e;t++){n[l]=sa(t,q,e,p,f,k);if(!r){ea=q;1!=f&&(ea=p-ea-1);ea=8*ea*((e+7)/8|0)+t;ea=0==(m[ea/8>>0]&128>>ea%8)?1:0;if(0==ea&&0!=n[l])n[l]=~n[l],n[l]|=4278190080;else if(1==ea||0!=n[l])n[l]|=4278190080;32==f&&-1==n[l]&&0==ea&&(n[l]=0)}l++}h=new F(D,n,h,d,e,p,f,k.length,m.length);w.putCursor(D,h);w.setCursor(b)}}function sa(c,a,b,h,d,e){1!=d&&(a=h-a-1);a=(a*b+c)*d;b=a/8>>0;c=e[b]&255;switch(d){case 1:return 0==
(c&128>>a%8)?0:4294967295;case 8:return 0==c?0:4294967295;case 15:return c|=(e[b+1]&255)<<8,d=Array(4),wb(c,15,d,0),d[0]<<16|d[1]<<8|d[2];case 16:return c|=(e[b+1]&255)<<8,d=Array(4),wb(c,16,d,0),d[0]<<16|d[1]<<8|d[2];case 24:return(e[b+2]&255)<<16|(e[b+1]&255)<<8|c;case 32:return(e[b+3]&255)<<24|(e[b+2]&255)<<16|(e[b+1]&255)<<8|c}svGlobal.logger.warn("invalid bpp value for Xor Mask.");return 0}function F(c,a,b,d,h,e,p,f,m){this.cache_idx=c;this.rawData=a;this.none=!a;this.hotX=b;this.hotY=d;this.width=
h;this.height=e;this.xorSize=f;this.andSize=m;this.result="";this.distance=0;this.bpp=p;this.system="";if(a){if(!this.distance){c=0;if(a){p=0;for(var D=a.length;p<D;p++)0!=a[p]&&(c+=p%h+(p/h|0))}this.distance=c}if(!this.system){a:switch(this.distance){case 507:c="text";break a;case 2046:case 4359:c="default";break a;default:c=""}this.system=c}}c="";if(!this.system&&a){p=h*e*4;c=62+p+f+m;D=new Uint8Array(c);c=new hi5.DataBuffer(D,0,c);c.setLittleEndian16(0);c.setLittleEndian16(2);c.setLittleEndian16(1);
c.setByte(h);c.setByte(e);c.setByte(0);c.setByte(0);c.setLittleEndian16(b);c.setLittleEndian16(d);c.setLittleEndian32(40+p+f+m);c.setLittleEndian32(22);c.setLittleEndian32(40);c.setLittleEndian32(h);c.setLittleEndian32(2*e);c.setLittleEndian16(1);c.setLittleEndian16(32);c.setLittleEndian32(0);c.setLittleEndian32(f+m);c.setLittleEndian32(0);c.setLittleEndian32(0);c.setLittleEndian32(0);c.setLittleEndian32(0);for(b=e-1;0<=b;b--)for(d=0;d<h;d++)e=a[h*b+d],c.setByte(e&255),c.setByte(e>>8&255),c.setByte(e>>
16&255),c.setByte(e>>24&255);c="data:image/x-icon;base64,"+hi5.Base64.enc(c.getData())}this.url=c}function kb(c){var a=0;c.skipPosition(2);var b=c.getLittleEndian16();c.skipPosition(2);var d=Array(b);var h=Array(b);var e=Array(b);c=c.getBytes(3*b);for(var p=0;p<b;p++)d[p]=c[a],h[p]=c[a+1],e[p]=c[a+2],a+=3;256==b&&(ga.paletteRdp||(ga.paletteRdp=Array(3)),ga.paletteRdp[0]=d,ga.paletteRdp[1]=h,ga.paletteRdp[2]=e)}function jb(c,a){for(var b=0,d,h;b<a;){d=c.getByte();h=d&3;switch(h){case 1:var e=c,p=d;
0!=(p&8)&&(ga.orderType=e.getByte());var f=void 0,D=e,n=Za[ga.orderType],l=0;0!=(p&64)&&n--;0!=(p&128)&&(n=2>n?0:n-2);for(var r=0;r<n;r++)f=D.getByte(),l|=f<<8*r;var q=l;if(0!=(p&4)){if(0==(p&32)){var t=e,ea=ga.bounds,B=t.getByte();0!=(B&1)?ea.left=Q(t,ea.left,!1):0!=(B&16)&&(ea.left=Q(t,ea.left,!0));0!=(B&2)?ea.top=Q(t,ea.top,!1):0!=(B&32)&&(ea.top=Q(t,ea.top,!0));0!=(B&4)?ea.right=Q(t,ea.right,!1):0!=(B&64)&&(ea.right=Q(t,ea.right,!0));0!=(B&8)?ea.bottom=Q(t,ea.bottom,!1):0!=(B&128)&&(ea.bottom=
Q(t,ea.bottom,!0))}var pa=ga.bounds;ha=pa.left;0>ha&&(ha=0);aa=pa.top;0>aa&&(aa=0);fa=pa.right;fa>=x&&(fa=x-1);ca=pa.bottom;ca>=k&&(ca=k-1)}var C=0!=(p&16);sb&&13!=ga.orderType&&(sb.on=!1);switch(ga.orderType){case 0:var z=e,u=ga.destBlt,K=q,G=C;0!=(K&1)&&(u.x=Q(z,u.x,G));0!=(K&2)&&(u.y=Q(z,u.y,G));0!=(K&4)&&(u.cx=Q(z,u.cx,G));0!=(K&8)&&(u.cy=Q(z,u.cy,G));0!=(K&16)&&(u.opcode=z.getByte()&15);var S=u.x,F=u.y,M=u.cx,V=u.cy,H=u.opcode;if(!(S>x||F>k)){var rb=S+M-1;rb>fa&&(rb=fa);S<ha&&(S=ha);var M=rb-
S+1,ka=F+V-1;ka>ca&&(ka=ca);F<aa&&(F=aa);V=ka-F+1;1>M||1>V||w.bitBlt(H,x,S,F,M,V,null,0,0,0)}break;case 1:var I=void 0,P=e,R=ga.patBlt,Z=q,ja=C;0!=(Z&1)&&(R.x=Q(P,R.x,ja));0!=(Z&2)&&(R.y=Q(P,R.y,ja));0!=(Z&4)&&(R.cx=Q(P,R.cx,ja));0!=(Z&8)&&(R.cy=Q(P,R.cy,ja));0!=(Z&16)&&(R.opcode=P.getByte(),R.opcode=R.opcode&3|(R.opcode&48)>>2);0!=(Z&32)&&(R.backgroundColor=xb(P));0!=(Z&64)&&(R.foregroundColor=xb(P));var L=R.brush,N=Z>>7;0!=(N&1)&&(L.xOrigin=P.getByte());0!=(N&2)&&(L.yOrigin=P.getByte());0!=(N&4)&&
(L.style=P.getByte());var ec=L.pattern;0!=(N&8)&&(ec[0]=P.getByte());if(0!=(N&16))for(var W=1;8>W;W++)ec[W]=P.getByte();L.pattern=ec;var U=R.x,ta=R.y;if(!(U>fa||ta>ca)){var ia=R.opcode,E=U,O=ta,sa=R.cx,ba=R.cy,Yb=R.foregroundColor,da=R.backgroundColor,ua=R.brush.xOrigin,wa=R.brush.yOrigin,xa=R.brush.style,Fa=R.brush.pattern,Yb=La(Yb),da=La(da),Ja=E+sa-1;Ja>fa&&(Ja=fa);E<ha&&(E=ha);var sa=Ja-E+1,Da=O+ba-1;Da>ca&&(Da=ca);O<aa&&(O=aa);ba=Da-O+1;if(!(1>sa||1>ba))switch(xa){case 0:for(var I=new Uint32Array(sa*
ba),ya=0;ya<I.length;ya++)I[ya]=Yb;w.bitBlt(ia,x,E,O,sa,ba,I,sa,0,0);break;case 2:svGlobal.logger.warn("hatch");break;case 3:for(var I=new Uint32Array(sa*ba),Wa=0,ya=0;ya<ba;ya++)for(var Ma=0;Ma<sa;Ma++)I[Wa]=0==(Fa[(ya+wa)%8]&1<<(Ma+ua)%8)?Yb:da,Wa++;w.bitBlt(ia,x,E,O,sa,ba,I,sa,0,0);break;default:svGlobal.logger.warn("Unsupported brush style "+xa)}}break;case 2:var jb=e,ma=ga.screenBlt,mb=q,Ka=C;0!=(mb&1)&&(ma.x=Q(jb,ma.x,Ka));0!=(mb&2)&&(ma.y=Q(jb,ma.y,Ka));0!=(mb&4)&&(ma.cx=Q(jb,ma.cx,Ka));0!=
(mb&8)&&(ma.cy=Q(jb,ma.cy,Ka));0!=(mb&16)&&(ma.opcode=jb.getByte()&15);0!=(mb&32)&&(ma.srcX=Q(jb,ma.srcX,Ka));0!=(mb&64)&&(ma.srcY=Q(jb,ma.srcY,Ka));var tb=ma.x,Bb=ma.y;if(!(tb>fa||Bb>ca)){var db=ma.cx,na=ma.cy,ub=ma.opcode,Pa=ma.srcX,ab=ma.srcY,Cb=tb+db-1;Cb>fa&&(Cb=fa);tb<ha&&(tb=ha);var db=Cb-tb+1,Aa=Bb+na-1;Aa>ca&&(Aa=ca);Bb<aa&&(Bb=aa);na=Aa-Bb+1;Pa+=tb-ma.x;ab+=Bb-ma.y;1>db||1>na||(12==ub?w.moveArea(Pa,ab,db,na,tb-Pa,Bb-ab):w.bitBlt(ub,db,tb,Bb,db,na,null,db,Pa,ab))}break;case 9:var bb=void 0,
Qa=e,oa=ga.line,Xa=q,Db=C;0!=(Xa&1)&&(oa.mixmode=Qa.getLittleEndian16());0!=(Xa&2)&&(oa.startX=Q(Qa,oa.startX,Db));0!=(Xa&4)&&(oa.startY=Q(Qa,oa.startY,Db));0!=(Xa&8)&&(oa.endX=Q(Qa,oa.endX,Db));0!=(Xa&16)&&(oa.endY=Q(Qa,oa.endY,Db));0!=(Xa&32)&&(oa.backgroundColor=xb(Qa));0!=(Xa&64)&&(oa.opcode=Qa.getByte());var ob=oa.pen,Ya=Xa>>7;0!=(Ya&1)&&(ob.style=Qa.getByte());0!=(Ya&2)&&(ob.width=Qa.getByte());0!=(Ya&4)&&(ob.color=xb(Qa));var Ra=oa.startX,Ba=oa.startY,vb=oa.endX,Va=oa.endY,Ca=oa.pen.color,
yb=oa.opcode-1;Ba==Va?(Ra>vb&&(bb=Ra,Ra=vb,vb=bb),Ra<ha&&(Ra=ha),vb>fa&&(vb=fa)):Ra==vb&&(Ba>Va&&(bb=Ba,Ba=Va,Va=bb),Ba<aa&&(Ba=aa),Ba>ca&&(Ba=ca));Fc(Ra,Ba,vb,Va,Ca,yb);break;case 10:var pb=e,Ga=ga.rectangle,kb=q,fb=C;0!=(kb&1)&&(Ga.x=Q(pb,Ga.x,fb));0!=(kb&2)&&(Ga.y=Q(pb,Ga.y,fb));0!=(kb&4)&&(Ga.cx=Q(pb,Ga.cx,fb));0!=(kb&8)&&(Ga.cy=Q(pb,Ga.cy,fb));0!=(kb&16)&&(Na=Na&4294967040|pb.getByte());0!=(kb&32)&&(Na=Na&4294902015|pb.getByte()<<8);0!=(kb&64)&&(Na=Na&4278255615|pb.getByte()<<16);Ga.color=Na;
var cb=Ga.x,Jb=Ga.y,Ha=Ga.cx,Kb=Ga.cy;if(!(cb>fa||Jb>ca)){var Sa=cb+Ha-1;Sa>fa&&(Sa=fa);cb<ha&&(cb=ha);var Ha=Sa-cb+1,Lb=Jb+Kb-1;Lb>ca&&(Lb=ca);Jb<aa&&(Jb=aa);Kb=Lb-Jb+1;1>Ha||1>Kb||w.fillRect(cb,Jb,Ha,Kb,La(Ga.color))}break;case 11:var Ta=e,va=ga.deskSave,Mb=q,nb=C;0!=(Mb&1)&&(va.offset=Ta.getLittleEndian32());0!=(Mb&2)&&(va.left=Q(Ta,va.left,nb));0!=(Mb&4)&&(va.top=Q(Ta,va.top,nb));0!=(Mb&8)&&(va.right=Q(Ta,va.right,nb));0!=(Mb&16)&&(va.bottom=Q(Ta,va.bottom,nb));0!=(Mb&32)&&(va.action=Ta.getByte());
var qa=va.right-va.left+1,Ab=va.bottom-va.top+1;0==va.action?1>qa||1>Ab||w.saveDesktop(va.left,va.top,qa,Ab,va.offset):w.restoreDesktop(va.left,va.top,qa,Ab,va.offset);break;case 13:a:{var qb=e,ra=ga.memBlt,eb=q,Rb=C;0!=(eb&1)&&(ra.cacheID=qb.getByte(),ra.colorTable=qb.getByte());0!=(eb&2)&&(ra.x=Q(qb,ra.x,Rb));0!=(eb&4)&&(ra.y=Q(qb,ra.y,Rb));0!=(eb&8)&&(ra.cx=Q(qb,ra.cx,Rb));0!=(eb&16)&&(ra.cy=Q(qb,ra.cy,Rb));0!=(eb&32)&&(ra.opcode=qb.getByte()&15);0!=(eb&64)&&(ra.srcX=Q(qb,ra.srcX,Rb));0!=(eb&128)&&
(ra.srcY=Q(qb,ra.srcY,Rb));0!=(eb&256)&&(ra.cacheIDX=qb.getLittleEndian16());var za=ra.x,Eb=ra.y;if(!(za>fa||Eb>ca)){var Ua=ra.cx,zb=ra.cy,Sb=ra.srcX,Pb=ra.srcY,g=za+Ua-1;g>fa&&(g=fa);za<ha&&(za=ha);var Ua=g-za+1,Zb=Eb+zb-1;Zb>ca&&(Zb=ca);Eb<aa&&(Eb=aa);zb=Zb-Eb+1;Sb+=za-ra.x;Pb+=Eb-ra.y;if(sb&&(sb.verify(za,Eb,Ua,zb),sb.on))break a;w.drawBitmap(ra.cacheID,ra.cacheIDX,za,Eb,Ua,zb,Sb,Pb,ra.opcode)}}break;case 22:var Tb=e,hb=ga.polyLine,wb=q,Wb=C;0!=(wb&1)&&(hb.x=Q(Tb,hb.x,Wb));0!=(wb&2)&&(hb.y=Q(Tb,
hb.y,Wb));0!=(wb&4)&&(hb.opcode=Tb.getByte());0!=(wb&16)&&(hb.foregroundColor=xb(Tb));0!=(wb&32)&&(hb.lines=Tb.getByte());if(0!=(wb&64)){var Xb=Tb.getByte();hb.dataSize=Xb;hb.data=Tb.getBytes(Xb)}var Vb=hb.x,$b=hb.y,fe=hb.foregroundColor,Bd=hb.lines,ge=hb.dataSize,ad=hb.data,Hc=Array(1);Hc[0]=Math.floor((Bd-1)/4)+1;for(var kc=0,he=0,ie=hb.opcode-1,bd=0;bd<Bd&&Hc[0]<ge;bd++){var je=Vb,ke=$b;0==bd%4&&(kc=ad[he++]);0==(kc&192)&&(kc|=192);0!=(kc&64)&&(Vb+=lc(ad,Hc));0!=(kc&128)&&($b+=lc(ad,Hc));Fc(je,
ke,Vb,$b,fe,ie);kc<<=2}break;case 27:var Ea=e,la=ga.text2,Ia=q;0!=(Ia&1)&&(la.font=Ea.getByte());0!=(Ia&2)&&(la.flags=Ea.getByte());0!=(Ia&4)&&(la.opcode=Ea.getByte());0!=(Ia&8)&&(la.mixmode=Ea.getByte());0!=(Ia&16)&&(la.foregroundColor=xb(Ea));0!=(Ia&32)&&(la.backgroundColor=xb(Ea));0!=(Ia&64)&&(la.clipLeft=Ea.getLittleEndian16());0!=(Ia&128)&&(la.clipTop=Ea.getLittleEndian16());0!=(Ia&256)&&(la.clipRight=Ea.getLittleEndian16());0!=(Ia&512)&&(la.clipBottom=Ea.getLittleEndian16());0!=(Ia&1024)&&(la.boxLeft=
Ea.getLittleEndian16());0!=(Ia&2048)&&(la.boxTop=Ea.getLittleEndian16());0!=(Ia&4096)&&(la.boxRight=Ea.getLittleEndian16());0!=(Ia&8192)&&(la.boxBottom=Ea.getLittleEndian16());0!=(Ia&16384)&&Ea.skipPosition(1);0!=(Ia&32768)&&Ea.skipPosition(1);0!=(Ia&65536)&&Ea.skipPosition(1);0!=(Ia&131072)&&Ea.skipPosition(1);0!=(Ia&262144)&&Ea.skipPosition(7);0!=(Ia&524288)&&(la.x=Ea.getLittleEndian16());0!=(Ia&1048576)&&(la.y=Ea.getLittleEndian16());if(0!=(Ia&2097152)){var Cd=Ea.getByte();la.length=Cd;la.text=
Ea.getBytes(Cd)}var le=la.font,me=la.flags,ne=la.mixmode,oe=La(la.foregroundColor),pe=La(la.backgroundColor),Dd=la.clipLeft,Ed=la.clipTop,qe=la.clipRight,re=la.clipBottom,Ic=la.boxLeft,Fd=la.boxTop,se=la.boxBottom,te=la.x,ue=la.y,ve=la.length,we=la.text,cd=la.boxRight-Ic;Ic+cd>x&&(cd=x-Ic);w.drawText(le,me,ne,oe,pe,Dd,Ed,qe-Dd,re-Ed,Ic,Fd,cd,se-Fd,te,ue,ve,we,ha,aa,fa,ca);break;default:svGlobal.logger.warn("XXX Order type "+ga.orderType)}0!=(p&4)&&vc();break;case 2:var Gd=c,Hd=d>>2;switch(Hd){case 11:var Jc=
Gd,Id=Jc.getLittleEndian16()-3,xe=Jc.getPosition()+Id;J.onAltSecWindows(Jc,Id);Jc.setPosition(xe);break;case 13:Gd.getLittleEndian32();break;default:svGlobal.logger.warn("Alt Sec order:"+Hd)}break;case 3:var Nb=c;var Jd=Nb.getLittleEndian16();var Kc=Nb.getLittleEndian16();var Kd=Nb.getByte();var ye=Nb.getPosition()+Jd+7;if(Nb.has(Jd+7)){switch(Kd){case 0:var Ld=void 0,Ub=Nb,ze=Ub.getByte();Ub.skipPosition(1);var dd=Ub.getByte(),Lc=Ub.getByte(),Mc=Ub.getByte(),Nc=Math.floor((Mc+7)/8),Ae=Ub.getLittleEndian16(),
Be=Ub.getLittleEndian16(),Ce=Ub.getPosition();Ub.skipPosition(Ae);A!=Mc&&(svGlobal.logger.warn("Server limited colour depth to "+Mc+" bits"),v(Mc,!0));var ed=Array(dd*Lc*Nc);ed[0]=0;for(var fd=dd*Nc,Oc=0;Oc<Lc;Oc++)Ld=Ce+(Lc-Oc-1)*fd,Ub.copyToByteArray(ed,Oc*fd,Ld,fd);w.putBitmap(ze,Be,new y(gc(ed,Nc),dd,Lc,0,0,8*Nc));break;case 1:svGlobal.logger.info("TODO: color cache");break;case 2:var Md=void 0,rc=void 0,ib=Nb,De=Kc,Ee=ib.getByte();ib.getByte();var gd=ib.getByte(),hd=ib.getByte(),sc=ib.getByte(),
Fe=Math.floor((sc+7)/8),Ge=ib.getLittleEndian16(),He=ib.getLittleEndian16();A!=sc&&(svGlobal.logger.warn("Server limited colour depth to "+sc+" bits"),v(sc,!0));0!=(De&1024)?rc=Ge:(ib.skipPosition(2),rc=ib.getLittleEndian16(),ib.skipPosition(2),ib.skipPosition(2));Md=1!=Fe?Fb(gd,hd,rc,ib.getData(),ib.getPosition()):mc(gd,hd,rc,ib.getData(),ib.getPosition());ib.skipPosition(rc);w.putBitmap(Ee,He,new y(Md,gd,hd,0,0,sc));break;case 3:for(var Nd=void 0,id=void 0,jd=void 0,Od=void 0,Pd=void 0,Qd=void 0,
Rd=void 0,Sd=void 0,Td=void 0,dc=Nb,Sd=dc.getByte(),Rd=dc.getByte(),Ud=0;Ud<Rd;Ud++)Qd=dc.getLittleEndian16(),Pd=dc.getLittleEndian16(),Od=dc.getLittleEndian16(),jd=dc.getLittleEndian16(),id=dc.getLittleEndian16(),Nd=id*Math.floor((jd+7)/8)+3&-4,Td=new m(Pd,Od,jd,id,dc.getBytes(Nd)),w.putFont(Sd,Qd,Td);break;case 4:$a(Nb,Kc,!1);break;case 5:$a(Nb,Kc,!0);break;case 7:svGlobal.logger.info("CacheBrush...=");break;case 8:var nc=void 0,Ob=Nb,Vd=Kc&7,Wd=Ob.getLittleEndian16();Ob.skipPosition(8);var Pc=
Ob.getByte();A!=Pc&&(svGlobal.logger.warn("Server limited colour depth to "+Pc+" bits"),v(Pc,!0));Ob.skipPosition(2);var kd=Ob.getByte(),tc=Ob.getLittleEndian16(),uc=Ob.getLittleEndian16(),Xd=Ob.getLittleEndian32();if(1==kd){jc(Ob,Pc,tc,uc,gb);var Ie=gb.getData(),Je=gb.getDataSize(),nc=new Uint32Array(Je);Ib(Ie,0,nc,tc,uc,1);w.putBitmap(Vd,Wd,new y(nc,tc,uc,0,0,32))}else if(0==kd){var Yd=rdpBitmap.byte2int(Ob.getData(),Xd,Ob.getPosition()),nc=new Uint32Array(Yd.length);Ib(Yd,0,nc,tc,uc,1);w.putBitmap(Vd,
Wd,new y(nc,tc,uc,0,0,32))}else svGlobal.logger.warn("XXX invalid codec id:"+kd);Ob.skipPosition(Xd);break;default:svGlobal.logger.warn("invalid second Order, type="+Kd)}Nb.setPosition(ye)}sb&&(sb.on=!1)}b++}}function $a(c,a,b){var d;var h=a&7;var e=((a&120)>>3)-2;a=(a&65408)>>7;Ab!=e&&(v(8*e,!0),svGlobal.logger.warn("Server limited colour depth to "+e+" bytes"));0!=(a&2)&&c.skipPosition(8);if(0!=(a&1))var p=d=yb.readVar2Bytes(c);else d=yb.readVar2Bytes(c),p=yb.readVar2Bytes(c);var f=yb.readVar4Bytes(c);
var m=yb.readVar2Bytes(c);b&&0==(a&8)&&c.skipPosition(8);if(b){b=1!=e?Fb(d,p,f,c.getData(),c.getPosition()):mc(d,p,f,c.getData(),c.getPosition());c.skipPosition(f);if(!b){svGlobal.logger.warn("Failed to decompress bitmap data");return}c=new y(b,d,p,0,0,8*e)}else{b=Array(d*p*e);b[0]=0;var D=c.getPosition(),n=d*e;for(f=0;f<p;f++){var l=D+(p-f-1)*n;c.copyToByteArray(b,f*n,l,n)}c=new y(gc(b,e),d,p,0,0,8*e)}w.putBitmap(h,m,c);0!=(a&2)&&svGlobal.logger.warn("XXX:TODO, persistent")}function Q(c,a,b){return b?
(c=c.getByte()<<24>>24,a+c):a=c.getLittleEndian16()<<16>>16}function xb(c){var a;var b=a=c.getByte();a=c.getByte();b|=a<<8;a=c.getByte();return b|a<<16}function H(c){for(var a,b,d,h,e,p,f,m,D,n=c.getLittleEndian16(),l=0;l<n;l++)if(a=c.getLittleEndian16(),b=c.getLittleEndian16(),d=c.getLittleEndian16(),h=c.getLittleEndian16(),e=c.getLittleEndian16(),p=c.getLittleEndian16(),f=c.getLittleEndian16(),m=c.getLittleEndian16(),D=c.getLittleEndian16(),d=d-a+1,h=h-b+1,A!=f&&(svGlobal.logger.warn("Server limited colour depth to "+
f+" bits"),v(f,!0)),0==m){m=e*Ab;D=p*m;f=new Uint8Array(D);for(var k=c.getPosition(),q=0;q<p;q++)Xb(c.getData(),k,f,(p-q-1)*m,m),k+=m;c.skipPosition(D);f=gc(f,Ab);w.setRGBs(a,b,d,h,f,0,e)}else 0!=(m&1024)?f=D:(c.skipPosition(2),f=c.getLittleEndian16(),c.skipPosition(4)),m=c.getData(),D=f,k=c.getPosition(),q=b,b=h,h=Ab,1>d*b*e*p||(1!=h?w.setRGBs(a,q,d,b,Fb(e,p,D,m,k),0,e):(p=mc(e,p,D,m,k),m=q,h=gc(p,h),w.setRGBs(a,m,d,b,h,0,e))),c.skipPosition(f)}function vc(){ha=0;fa=x-1;aa=0;ca=k-1}function Fc(c,
a,b,d,h,e){var p=Math.min(c,b),f=Math.max(c,b),m=Math.min(a,d),D=Math.max(a,d);h=La(h);if(!(p>=ha&&f<=fa&&m>=aa&&D<=ca)){if(p>fa||f<ha||m>ca||D<aa)return;if(c==b)a>d&&(p=a,a=d,d=p),a<aa&&(a=aa),d>ca&&(d=ca);else if(a==d)c>b&&(p=c,c=b,b=p),c<ha&&(c=ha),b>fa&&(b=fa);else{p=ga._line;p.set(c,a,b,d);f=p.intersection(ha,aa,fa,aa);m=[];f&&m.push(f.x,f.y);(f=p.intersection(fa,aa,fa,ca))&&m.push(f.x,f.y);(f=p.intersection(ha,ca,fa,ca))&&m.push(f.x,f.y);(f=p.intersection(ha,aa,ha,ca))&&m.push(f.x,f.y);2==m.length&&
(c>=ha&&c<=fa&&a>=aa&&a<=ca?m.push(c,a):b>=ha&&b<=fa&&d>=aa&&d<=ca&&m.push(b,d));if(4!=m.length)return;c=m[0];a=m[1];b=m[2];d=m[3]}}12==e?w.drawLine(c,a,b,d,h):w.drawLineExt(c,a,b,d,h,e)}function lc(c,a){var b=c[a[0]++]&255,d=b&128,b=0!=(b&64)?b|-64:b&63;0!=d&&(b=b<<8|c[a[0]++]&255);return b}function Va(c){if(J)if(svGlobal.logger.warn("closed "+(J.sessionInfo.appInfo?J.sessionInfo.appInfo.numericId:0)),J&&(Fa=!1),Wb)svGlobal.logger.info("Req credential");else{ga=null;"undefined"!=typeof rdp8bulkData&&
rdp8bulkData.release();$b=jc=gb=Da=u=null;try{if(null!=bb&&(bb.exit(),bb=null),J.onclose)J.onclose(fb);else svGlobal.logger.info("onclose: null")}catch(ea){}ua=null;N&&(N.onopen=null,N.onmessage=null,N.onclose=null,N=N.onerror=null);nb=null;ba&&(ba.release(),ba=null);I&&(I.release(),I=null);J=null}}function wb(c,a,b,d){switch(a){case 16:a=c>>8&248;var h=c>>3&252;c=c<<3&255;b[d]=a|a>>5;b[d+1]=h|h>>6;b[d+2]=c|c>>5;b[d+3]=255;break;case 15:a=c>>7&248;h=c>>2&248;c=c<<3&255;b[d]=a|a>>5;b[d+1]=h|h>>5;b[d+
2]=c|c>>5;b[d+3]=255;break;case 8:b[d]=ga.paletteRdp[0][c];b[d+1]=ga.paletteRdp[1][c];b[d+2]=ga.paletteRdp[2][c];b[d+3]=255;break;case 32:b[d]=c&255,b[d+1]=c>>8&255,b[d+2]=c>>16&255,b[d+3]=c>>24&255;default:b[d]=c&255,b[d+1]=c>>8&255,b[d+2]=c>>16&255,b[d+3]=255}}function gc(c,a){var b=c.length/a>>0,d=new Uint32Array(b),h=La;switch(a){case 1:for(var e=0;e<b;e++)d[e]=h(c[e]);break;case 2:for(e=0;e<b;e++)d[e]=h(c[2*e+1]<<8|c[2*e]);break;default:for(e=0;e<b;e++)d[e]=h(c[e*a+2]<<16)|c[e*a+1]<<8|c[e*a]}return d}
this.sessionInfo={domain:"",userName:"",sessionId:0,joinedSessions:[],suppressOutput:!1,appInfo:null};this.mode=0;this.remoteAppLogin=!0;var J=this,fb=!1,Wb=!1,Ma="object"==typeof u?u:null,wa=Ma?{}:hi5.string.queryToObj(u.substring(u.indexOf("?")+1)),Xb=hi5.Arrays.arraycopy,ia=null,ba=new BulkData,I=r(wa.decompressingRDP61)?new Bulk61Data:null,sb=null;this.enableUpdateFix=function(){sb=new q;svGlobal.logger.warn("UpdateFix enabled")};this.protocol=Ma?"":u.substring(0,u.indexOf("://")).toLowerCase();
this.setProfiler=function(c){ia=c};this.getProfiler=function(){return ia};this.gateway=function(){if(Ma)return"";var c=u.lastIndexOf("/RDP?");-1==c&&(c=u.lastIndexOf("/JOIN?"));-1==c&&(c=u.lastIndexOf("/PLAY?"));return u.substring(0,c).replace(/wss\:\/\//ig,"https://").replace(/ws\:\/\//ig,"http://")}();this.getGatewayAddr=function(){var c=J.gateway;J.ongetgatewayaddress&&(c=J.ongetgatewayaddress(c));return c};var W="object"==typeof u||0<u.indexOf("/PLAY?"),Vb=!W&&0<u.indexOf("invitation=");if(Vb){var zb=
decodeURIComponent(u),Pb=zb.indexOf(' USERNAME="');0<Pb&&(Pb+=11,zb=zb.substring(Pb,zb.indexOf('"',Pb)),u+="&novice="+zb+"&server="+zb);u+="&mapClipboard=on"}if(W)this.mode=1,Ma?u="":(x=640,k=480);else if(0<u.indexOf("/JOIN?")||Vb)this.mode=2;wa.symlink&&wa.parameters&&hi5.string.queryToObj(wa.parameters,wa);wa.gateway||(u+="&gateway="+encodeURIComponent(J.gateway));"useSSL"in wa||(u+="&useSSL="+("wss"==J.protocol));this.getDisplayName=e;this.server=e();this.port=parseInt(wa.port,10);this.getURL=
function(){return u};this.getColor=function(){return A};var L=hi5.graphic.Rectangle,xa=0<u.indexOf("nocurosr=on"),cb=0<u.indexOf("startProgram=app");u.indexOf("mapDisk=on");this.isRemoteApp=function(){return cb};var N=null,Fa=!1,ya=!1,ha=0,aa=0,fa=x-1,ca=k-1,Ab=0,bb=null,La=b,Fb=rdpBitmap.decompressInt16,mc=rdpBitmap.decompress;v(A,!0);this.setColor=function(c){v(c,!1)};this.setResolution=function(c,a){V(c,a,!1)};var ab={tag:0,channels:0,bitsPerSample:0,samplePerSec:22050,toStream:function(c){c.setLittleEndian16(this.tag);
c.setLittleEndian16(this.channels);c.setLittleEndian16(this.bitsPerSample);c.setLittleEndian32(this.samplePerSec)},fromStream:function(c){this.tag=c.getLittleEndian16();this.channels=c.getLittleEndian16();this.bitsPerSample=c.getLittleEndian16();this.samplePerSec=c.getLittleEndian32()}};this.setAudioFormat=function(c){ab.tag=c.tag;ab.channels=c.channels;ab.samplePerSec=c.samplePerSec;ab.bitsPerSample=c.bitsPerSample};this.running=function(){return Fa};this.setJoinMode=function(c){Fa&&z("8E1"+c)};
this.setJoinCloseMode=function(c){Fa&&z("8EB3\t"+c)};this.refuseControl=function(c){Fa&&z("8E3"+c)};this.giveControl=function(c){Fa&&z("8E4"+c)};this.pauseSession=function(c,a){Fa&&z("8EB"+(a?1:0)+"\t"+c)};this.closeSession=function(c){Fa&&z("8EB2\t"+c)};this.requestControl=function(){Fa&&z("8E2")};this.saveSession=function(c){Fa&&z("8E9"+(c.save?1:0)+"\t"+(c.timeout||0)+"\t"+(c.id||0))};this.allowJoin=function(c,a){Fa&&z("8EA"+c+"\t"+(a?1:0))};var Ka=new function(){function c(){if(b&&0<b.length){var a=
b.shift();Ka.sendSingleKey(a.down,a.key);0<b.length?setTimeout(c,d):b=null}}var a={" ":57,space:57,pgup:201,pageup:201,pgdn:209,pagedown:209,end:207,home:199,left:203,up:200,right:205,down:208,printscreen:183,insert:210,del:211,"delete":211,altgr:184,windows:219,windowsright:220,context:221,esc:1,backspace:14,tab:15,enter:28,meta:29,command:29,ctrl:29,shift:42,alt:56,capslock:58,f1:59,f2:60,f3:61,f4:62,f5:63,f6:64,f7:65,f8:66,f9:67,f10:68,f11:87,f12:88,numlock:69,scrolllock:70,add:78};this.sendSingleKey=
function(c,b){var d=a[b.toLowerCase()];d?J.writeScancode(c,d):(d=b.length,0!=d&&(1==d?J.writeKeyCode(c,b.toUpperCase().charCodeAt(0)):c&&J.writeText(b)))};var b=null,d=0;this.sendKeyComb=function(a,h){var e=a.split("+"),p=e.length,f;if(0!=p){var m=null,D=[];for(f=0;f<p;f++){var n=e[f];""==n&&""==m&&(n="Add");""!=n&&D.push({key:n,down:!0});m=n}p=D.length;for(f=p-1;0<=f;f--)D.push({key:D[f].key,down:!1});if(h)b=D,d=h,c();else for(f=0,p=D.length;f<p;f++)Ka.sendSingleKey(D[f].down,D[f].key)}}};this.writeRawInput=
function(c){z(c);if(J.onactivity)J.onactivity(c);if(bb){var a=c.substring(0,2);c=c.substring(2);if("80"==a||"81"==a||"82"==a||"83"==a){c=c.split("\t");var b=new Uint8Array(7),d=0;var h=parseInt(c[0]);var e=parseInt(c[1]);switch(parseInt(a,16)){case 128:d=("0"==c[2]?4096:8192)|32768;break;case 129:d="0"==c[2]?4096:8192;break;case 130:d=2048;break;case 131:d="0"==c[2]?33408:33664}b[0]=32;b[1]=d&255;b[2]=d>>8;b[3]=h&255;b[4]=h>>8;b[5]=e&255;b[6]=e>>8;bb.add(new RecordingObj(b,0,7,60))}}};var ga=new M,
Na=0;this.resetStatus=G;this.notify=function(c,a){c="8E6"+c;a&&(c+="\t"+a.join(";"));z(c)};this.run=function(){pa()};this.getDesktop=function(){return w};var ua=new hi5.DataBuffer([],0,0);this.suppressOutput=function(a){if(!J.sessionInfo.suppressOutput)return!1;void 0==a&&(a=!0);var c=new Uint8Array(a?3:11);c[0]=146;c[1]=3;c[2]=a?1:0;a||(c[3]=0,c[4]=0,c[5]=0,c[6]=0,c[7]=x-1,c[8]=x-1>>8,c[9]=k-1,c[10]=k-1>>8);N.send(c.buffer);return!0};this.refreshOutput=function(a,b,d,h){var c=new Uint8Array(d?11:
3);c[0]=146;c[1]=3;c[2]=2;d&&(c[3]=a,c[4]=a>>8,c[5]=b,c[6]=b>>8,c[7]=d,c[8]=d>>8,c[9]=h,c[10]=h>>8);N.send(c.buffer)};this.sendKeyboardSynchronize=function(c,a,b){var d=0;b&&(d|=4);a&&(d|=2);c&&(d|=1);z("8E5"+d);this.capsLock=b;this.numLock=a};var nb=new function(){var c=0,a=0,b=[0],d=new hi5.DataBuffer(b,0,0);this.addFragement=function(d,h){Xb(d.getData(),d.getPosition(),b,a,h);a+=h;c+=h};this.clearFragements=function(){d.setPosition(0);d.markEnd(c);a=c=0;return d}},gb=new NSCodecBitmap,Da=new function(a){var c=
new RemoteFXBitmap(!a);a=new RemoteFXDecoder;var b=new RemoteFXContext;this.decode=function(a,h){for(var e,p,f=a.getPosition()+h;a.getPosition()<f;){e=a.getLittleEndian16();p=a.getLittleEndian32();if(0==p)break;p=a.getPosition()-6+p;switch(e){case 52416:e=a;e.getLittleEndian32();e.getLittleEndian16();break;case 52417:a.skipPosition(4);break;case 52418:e=a;for(var m=e.getByte(),D=0;D<m;D++){var n=e.getByte(),l=e.getLittleEndian16(),k=e.getLittleEndian16();svGlobal.logger.info("Channel, id:"+n+" width:"+
l+" height:"+k)}break;case 52419:e=a;e.skipPosition(2);b.ctxId=e.getByte();b.tileSize=e.getLittleEndian16();b.setProperties(e.getLittleEndian16());break;case 52420:a.skipPosition(10);break;case 52421:a.skipPosition(2);break;case 52422:e=a;e.skipPosition(2);e.skipPosition(1);m=e.getLittleEndian16();D=c.resetRects(m);for(n=0;n<m;n++)l=D[n],l.x=e.getLittleEndian16(),l.y=e.getLittleEndian16(),l.width=e.getLittleEndian16(),l.height=e.getLittleEndian16();e.skipPosition(4);break;case 52423:e=a;m=b;e.skipPosition(6);
D=e.getLittleEndian16();m.cct=D>>>4&3;m.xft=D>>>6&15;m.et=D>>>10&15;m.qt=D>>>14&3;var q=e.getByte();e.skipPosition(1);n=e.getLittleEndian16();e.skipPosition(4);for(var l=Array(10*q),t=0,D=0;D<q;D++)k=e.getByte(),l[t++]=k&15,l[t++]=k>>>4,k=e.getByte(),l[t++]=k&15,l[t++]=k>>>4,k=e.getByte(),l[t++]=k&15,l[t++]=k>>>4,k=e.getByte(),l[t++]=k&15,l[t++]=k>>>4,k=e.getByte(),l[t++]=k&15,l[t++]=k>>>4;k=c.resetTiles(n);for(D=0;D<n;D++){var q=k[D],t=e,r=q;t.skipPosition(6);r.quantIdxY=t.getByte();r.quantIdxCb=
t.getByte();r.quantIdxCr=t.getByte();r.x=64*t.getLittleEndian16();r.y=64*t.getLittleEndian16();r.YLen=t.getLittleEndian16();r.CbLen=t.getLittleEndian16();r.CrLen=t.getLittleEndian16();d(m,e,l,q.YLen,10*q.quantIdxY,q.CbLen,10*q.quantIdxCb,q.CrLen,10*q.quantIdxCr,q.data)}break;default:svGlobal.logger.warn("unknown blockType 0x%X"+e)}a.setPosition(p)}return c};var d=a.decodeRgb;this.getResult=function(){return c}}(n),$b=new NSCodec,jc=$b.process,Za=[1,2,1,0,0,0,0,1,1,2,1,1,0,2,3,1,2,2,2,2,1,2,1,0,2,
1,2,3],yb={readVar4Bytes:function(a){var c=a.getByte(),b=0;switch((c&192)>>6){case 0:b=c&63;break;case 1:b=(c&63)<<8|a.getByte();break;case 2:b=(c&63)<<16;c=a.getByte();b|=c<<8;c=a.getByte();b|=c;break;case 3:b=(c&63)<<24,c=a.getByte(),b|=c<<16,c=a.getByte(),b|=c<<8,c=a.getByte(),b|=c}return b},readVar2Bytes:function(a){var c=a.getByte();return 0!=(c&128)?(c&127)<<8|a.getByte():c}};this._unload=Va;this.close=function(){fb=!0;svGlobal.logger.info("closing...");if(N&&N.readyState!=WebSocket.CLOSING&&
N.readyState!=WebSocket.CLOSED)try{for(;N&&N.readyState!=WebSocket.CLOSING&&N.readyState!=WebSocket.CLOSED;)W||N.readyState!=WebSocket.OPEN||z("85-1"),N.close()}finally{Va()}else Va()}}
function BulkData(){function u(b){b=(b&1431655765)<<1|b>>>1&1431655765;b=(b&858993459)<<2|b>>>2&858993459;b=(b&252645135)<<4|b>>>4&252645135;if(0==b>>>8)return b;b=(b&16711935)<<8|b>>>8&16711935;return 0==b>>>16?b:(b&65535)<<16|b>>>16&65535}function x(b,d,e,p){var f=0,m=0,t,q,l=0!=(p&1),r=A;if(0==(p&32))return n=0,h=e,0;0!=(p&64)&&(k=0);if(0!=(p&128)){for(p=65536;0<=--p;)r[p]=0;k=0}h=n=0;n=q=t=p=k;if(0==e)return 0;e+=m;do{if(0==f){if(m>=e)break;p=b[d+m++]<<24;f=8}if(0<=p){if(8>f){if(m>=e){if(0!=p)return-1;
break}p|=b[d+m++]<<24-f;f+=8}if(65536<=t)return-1;r[t++]=p>>>24&255;p<<=8;f-=8}else{p<<=1;if(0==--f){if(m>=e)return-1;p=b[d+m++]<<24;f=8}if(0<=p){if(8>f){if(m>=e)return-1;p|=b[d+m++]<<24-f;f+=8}if(65536<=t)return-1;r[t++]=(p>>>24|128)&255;p<<=8;f-=8}else{p<<=1;if(--f<(l?3:2)){if(m>=e)return-1;p|=b[d+m++]<<24-f;f+=8}if(l)switch(p>>>29){case 7:for(;9>f;f+=8){if(m>=e)return-1;p|=b[d+m++]<<24-f}p<<=3;var w=p>>>26;p<<=6;f-=9;break;case 6:for(;11>f;f+=8){if(m>=e)return-1;p|=b[d+m++]<<24-f}p<<=3;w=(p>>>
24)+64;p<<=8;f-=11;break;case 5:case 4:for(;13>f;f+=8){if(m>=e)return-1;p|=b[d+m++]<<24-f}p<<=2;w=(p>>>21)+320;p<<=11;f-=13;break;default:for(;17>f;f+=8){if(m>=e)return-1;p|=b[d+m++]<<24-f}p<<=1;w=(p>>>16)+2368;p<<=16;f-=17}else switch(p>>>30){case 3:if(8>f){if(m>=e)return-1;p|=b[d+m++]<<24-f;f+=8}p<<=2;w=p>>>26;p<<=6;f-=8;break;case 2:for(;10>f;f+=8){if(m>=e)return-1;p|=b[d+m++]<<24-f}p<<=2;w=(p>>>24)+64;p<<=8;f-=10;break;default:for(;14>f;f+=8){if(m>=e)return-1;p|=b[d+m++]<<24-f}w=(p>>>18)+320;
p<<=14;f-=14}if(0==f){if(m>=e)return-1;p=b[d+m++]<<24;f=8}if(0<=p){var v=3;p<<=1;f--}else{var B=l?14:11;do{p<<=1;if(0==--f){if(m>=e)return-1;p=b[d+m++]<<24;f=8}if(0<=p)break;if(0==--B)return-1}while(1);v=(l?16:13)-B;p<<=1;if(--f<v)for(;f<v;f+=8){if(m>=e)return-1;p|=b[d+m++]<<24-f}B=v;v=p>>>32-B&~(-1<<B)|1<<B;p<<=B;f-=B}if(65536<=t+v)return-1;w=t-w&(l?65535:8191);do r[t++]=r[w++];while(0!=--v)}}}while(1);k=t;n=q;h=t-q;return 0}var k=0,A=new Uint8Array(65536),w=new Int32Array(8),n=0,h=0,r=[6,6,6,7,
7,7,7,7,7,7,7,8,8,8,8,8,8,8,9,8,9,9,9,9,8,8,9,9,9,9,9,9,8,9,9,10,9,9,9,9,9,9,9,10,9,10,10,10,9,9,10,9,10,9,10,9,9,9,10,10,9,10,9,9,8,9,9,9,9,10,10,10,9,9,10,10,10,10,10,10,9,9,10,10,10,10,10,10,10,9,10,10,10,10,10,10,8,10,10,10,10,10,10,10,10,10,10,10,10,10,10,10,9,10,10,10,10,10,10,10,9,10,10,10,10,10,10,9,7,9,9,10,9,10,10,10,9,10,10,10,10,10,10,10,9,10,10,10,10,10,10,10,10,10,10,10,10,10,10,10,10,10,10,10,10,10,10,10,10,10,10,13,10,10,10,10,10,10,11,10,10,10,10,10,10,10,10,10,10,10,10,10,9,10,10,
10,10,10,9,10,10,10,10,10,9,10,10,10,9,10,10,10,10,10,10,10,10,10,10,10,10,10,10,10,9,10,10,10,10,10,10,10,10,10,10,10,10,10,9,10,8,9,9,10,9,10,10,10,9,10,10,10,9,9,8,7,13,13,7,7,10,7,7,6,6,6,6,5,6,6,6,5,6,5,6,6,6,6,6,6,6,6,6,6,6,6,6,6,8,5,6,7,7],q=[123,65311,65293,65063,65024,65285,65303,65128,197,65031,65299,65216,65288,65048,65307,65203,65027,162,65090,65296,65035,65026,65169,65305,65152,233,65082,65301,65042,87,65239,65309,65294,65077,65129,65314,65304,65146,65025,65315,65300,65268,65204,65033,
65308,65220,65289,65120,65136,65298,65029,65170,65185,65306,65039,65287,65110,65302,65282,65240,65256,65310,65053,59,65535,65286,65535,65137,65161,65535,65535,65068,65067,65056,65535,65211,65231,65032,65535,65248,65037,65535,65177,65535,65028,65194,65097,65535,65047,65121,65247,65535,65279,65270,65100,65535,65535,65159,65535,65316,65535,65084,65138,65535,65535,65230,65535,65278,65535,65059,65212,65034,65193,65535,65041,65535,65154,65535,65030,65178,65269,65535,65058,65101,65119,65535,65283,65249,
65535,65226,65228,65535,65049,65535,65207,65535,65535,65155,65065,65535,65535,65535,65132,65535,65261,65535,65535,65094,65116,65045,65535,65243,65190,65535,65535,65092,65535,65036,65535,65173,65276,65535,65535,65208,5833,65535,65264,65535,65080,65535,65535,65133,65150,65535,65535,65535,65535,65115,65244,65535,65535,65260,65095,65055,65535,65151,65174,65535,65535,65189,65535,65040,65088,65074,65215,65535,65535,65236,65265,65535,65535,65535,65141,65535,65535,65165,65073,65535,65125,65051,65535,65252,
65275,65535,65535,65106,65535,65038,65535,65181,65199,65535,65535,65105,65235,65535,65312,65535,65071,65535,65535,65217,65164,65535,65535,65535,65087,65535,65535,65142,65535,65274,65107,65061,65535,65124,65253,65535,65535,65198,65535,65043,65535,65160,65182,65535,65091,65535,65535,65188,65171,65535,65535,65535,65085,65535,65535,65259,65241,65535,65044,65114,65535,65064,65149,65535,65535,65130,65535,65535,65281,65222,65224,65535,65535,65205,65535,65535,65535,65172,65144,65535,65535,65535,65187,65535,
65535,65242,65112,65535,65054,65093,65258,65535,65131,65535,65535,65079,65535,65535,65535,65148,65206,65535,65535,65272,65535,65535,65535,65223,65179,65535,65535,65535,65104,65535,65535,65197,65250,65535,65050,65123,65102,65535,65535,65273,65535,65139,65535,65535,65535,65072,65163,65535,65535,65213,65070,256,65535,65262,65234,65535,65535,65535,65196,65535,65535,65180,65156,65535,65060,65103,65271,65535,65535,65251,65122,65535,65535,65535,65535,65162,65140,65535,65535,65086,65535,65535,65535,65233,
65214,65535,65535,65069,65535,65098,65267,65535,65535,65245,65118,65046,65535,65096,65192,65535,65195,65175,65535,65535,65232,65535,65535,65229,65209,65535,65535,65535,65066,65535,65535,65158,65134,65535,65535,65535,65246,65535,65535,65117,65099,65057,65535,65263,65176,65535,65535,65153,65535,65535,65535,65191,65535,65210,65277,65535,65535,65535,65227,65535,65535,65135,65081,65535,65535,65535,65157,65535,268,65254,65127,65052,65535,65108,65202,65535,65535,65183,65535,65535,65535,65113,65201,65535,
65218,65535,65535,65078,65266,65535,65535,65238,65143,65535,65535,65535,65075,65535,65535,65167,65109,65062,266,65284,65255,65535,289,65126,65535,65535,65535,65200,65184,65535,271,65168,65535,65535,65237,65535,65535,65219,65076,65535,65535,65535,65166,65535,273,65145,65089,267],e=[511,0,508,448,494,347,486,482],b=[4,2,3,4,3,4,4,5,4,5,5,6,6,7,7,8,7,8,8,9,9,8,9,9,9,9,9,9,9,9,9,9],B=[4065,4064,4066,4072,14,4069,4068,4074,4081,4067,21,4071,4079,70,4080,4077,4095,4087,4091,25,4093,4084,300,4075,4094,4086,
4090,137,4092,4083,4088,4082],d=[0,4,10,19],C=[0,0,0,0,1,1,2,2,3,3,4,4,5,5,6,6,7,7,8,8,9,9,10,10,11,11,12,12,13,13,14,14,15],v=[1,2,3,4,5,7,9,13,17,25,33,49,65,97,129,193,257,385,513,769,1025,1537,2049,3073,4097,6145,8193,12289,16385,24577,32769,49153,65537],V=[0,0,0,0,0,0,0,0,1,1,1,1,2,2,2,2,3,3,3,3,4,4,4,4,6,6,8,8,14,14],z=[2,3,4,5,6,7,8,9,10,12,14,16,18,22,26,30,34,42,50,58,66,82,98,114,130,194,258,514,2,2],y=new hi5.DataBuffer(A,0,1),R=hi5.Arrays.arraycopy,f=hi5.Arrays.fill;this.reset=function(){k=
0;A=new Uint8Array(65536);h=n=0;y=new hi5.DataBuffer(A,0,1)};this.release=function(){A=y=w=null};this.getArrayBuffer=function(){return A.buffer.slice(n,n+h)};this.getData=function(){y.setPosition(n);y.markEnd(n+h);return y};this.toPDU=function(){var b=new Uint8Array(65576);b[0]=29;b[2]=1;b[3]=2;b[4]=k;b[5]=k>>8;b[6]=k>>16;b[7]=k>>24;b.set(A,8);b.set(new Uint8Array(w.buffer),65544);return b};this.fromStream=function(b){k=b.getLittleEndian32();var d=b.getPosition();A.set(b.getData().subarray(d,d+65536));
b.skipPosition(65536);for(d=0;8>d;d++)w[d]=b.getLittleEndian32()};this.getDecompressedLength=function(){return h};this.dec5=function(b,d,e,f){return x(b,d,e,f)};this.dec=function(y,l,m,p){if(2==(p&15)){var D=A,S=w,t=k,P=0,ja=l,Z=0,ka=0,M=0;h=0;n=t;0!=(p&64)&&(R(D,t-32768,D,0,32768),n=k=t=32768);0!=(p&128)&&(t=0,f(D,0,65536,0),f(S,0,S.length,0),n=0);if(32!=(p&32))R(y,0,D,t,m),t+=m,h=t-k;else{var G=0;for(var pa=l+m;ja<pa&&!(M=y[ja++],P|=M<<G,ka+=8,G+=8,32<=G););P=u(P);ja<pa?(Z=u(y[ja++])&255,m=8):m=
0;for(;8<=ka;){l=0;for(G=5;13>=G;G++)if(12!=G){M=u(P&4294967295<<32-G);var a=q[M&511^M>>>9^M>>>4^M>>>7];0!=(a^M)>>>9?M=a&511:(a=(M>>>8^M&255)>>>2&15,0!=M>>>9&&(a=~a),M=q[e[(a&65535)%12]]);if(G==r[M])break}P<<=G;ka-=G;if(256>M)D[t++]=M&255;else if(256<M&&289>M){a=M-257;G=C[a];l=v[a]-1;0!=G&&(l+=u(P&4294967295<<32-G));a=S;var rb=l;var K=a[2]|a[3]<<16,K=K<<16;a[2]=K&65535;a[3]=K>>>16&65535;var Ib=a[0]|a[1]<<16,K=K|Ib>>>16;a[2]=K&65535;a[3]=K>>>16&65535;Ib=Ib<<16|rb;a[0]=Ib&65535;a[1]=Ib>>>16&65535;P<<=
G;ka-=G}else if(288<M&&293>M)a=M-289,l=S[a],0!=a&&(G=S,rb=G[0],G[0]=G[a],G[a]=rb);else if(256==M)break;for(G=32-ka;0<G;)if(m<G)M=Z>>>8-m,P|=M<<32-ka-m,ka+=m,G-=m,ja<pa?(Z=u(y[ja++])&255,m=8):m=G=0;else{m>G?(P|=Z>>>8-G,Z<<=G,Z&=255,m-=G,ka=32):(P|=Z>>>8-G,ka=32,ja<pa?(Z=u(y[ja++])&255,m=8):m=0);break}if(0!=l){for(G=2;9>=G&&(M=u(P&4294967295<<32-G),a=B[M&31^M>>>5^M>>>9],0!=(a^M)>>>5?M=a&31:(M=M>>>4&15,M=B[d[(M^M>>>2^M>>>3)&3]]),G!=b[M]);G++);P<<=G;ka-=G;G=V[M];a=z[M];0!=G&&(a+=u(P&4294967295<<32-G));
P<<=G;ka-=G;rb=t-l;G=a>l?l:a;for(M=0;0<G;)D[t++]=D[rb++],G--;for(;a>l;)M=M>=l?0:M,D[t++]=D[rb+M++],a--;for(G=32-ka;0<G;)if(m<G)M=Z>>>8-m,P|=M<<32-ka-m,ka+=m,G-=m,ja<pa?(Z=u(y[ja++])&255,m=8):m=G=0;else{m>G?(P|=Z>>>8-G,Z<<=G,Z&=255,m-=G,ka=32):(P|=Z>>>8-G,ka=32,ja<pa?(Z=u(y[ja++])&255,m=8):m=0);break}}}h=0!=(p&128)?t:t-k}k=t;return 0}return x(y,l,m,p)}}
function Bulk61Data(){var u=0,x=new Uint8Array(2E6),k=0,A=0,w=new hi5.DataBuffer(x,0,1),n=hi5.Arrays.arraycopy;this.reset=function(){u=0;x=new Uint8Array(2E6);A=k=0;w=new hi5.DataBuffer(x,0,1)};this.release=function(){x=w=null};this.getArrayBuffer=function(){return x.buffer.slice(k,k+A)};this.getData=function(){w.setPosition(k);w.markEnd(k+A);return w};this.toPDU=function(){var h=new Uint8Array(2000008);h[0]=29;h[2]=1;h[3]=9;h[4]=u;h[5]=u>>8;h[6]=u>>16;h[7]=u>>24;h.set(x,8);return h};this.fromStream=
function(h){u=h.getLittleEndian32();var n=h.getPosition();x.set(h.getData().subarray(n,n+2E6))};this.getDecompressedLength=function(){return A};this.dec=function(h,r,q,e){0!=(e&4)&&(u=0);k=u;A=0;var b=r;if(0==(e&2)){var w=h[b++]|h[b++]<<8;e=b+8*w;for(var d=0;d<w;d++){var C=h[b++]|h[b++]<<8,v=h[b++]|h[b++]<<8,V=h[b++]|h[b++]<<8|h[b++]<<16|h[b++]<<24;var z=v-A;n(h,e,x,u,z);u+=z;e+=z;A=v;for(z=0;z<C;z++)x[u++]=x[V++],A++}}else e=b;if(z=r+q-e)n(h,e,x,u,z),A+=z,u+=z;return 0}}
var rdpBitmap=new function(){function u(k,A,w,n,h,r){for(var q,e=0,b,B,d,C,v=0,u,z=A,y=r;e<n;){r=y+w*n*4-(e+1)*w*4;d=0;u=r;q=0;if(0==v)for(;q<w;){b=k[A++];B=b&15;b=b>>4&15;C=B<<4|b;47>=C&&16<=C&&(B=C,b=0);for(;0<b;)d=k[A++],h[r]=d,r+=4,q++,b--;for(;0<B;)h[r]=d,r+=4,q++,B--}else for(;q<w;){b=k[A++];B=b&15;b=b>>4&15;C=B<<4|b;47>=C&&16<=C&&(B=C,b=0);for(;0<b;)C=k[A++],0!=(C&1)?(C>>=1,C+=1,d=-C):d=C>>=1,C=h[v+4*q]+d,h[r]=C,r+=4,q++,b--;for(;0<B;)C=h[v+4*q]+d,h[r]=C,r+=4,q++,B--}e++;v=u}return A-z}function x(k,
A,w,n,h,r){var q,e;for(e=0;e<n;e++)for(q=0;q<w;q++)h[r+4*((n-e-1)*w+q)]=k[A+(e*w+q)]}this.decompressInt16=function(k,A,w,n,h){var r=-1,q=-1;w=h+w;for(var e,b,B,d=k,C=-1,v,u=0,z=0,y=0,x=4294967295,f,K=!1,l=!1,m=new Uint32Array(k*A);h<w;){v=0;b=n[h++];e=b>>4;switch(e){case 12:case 13:case 14:e-=6;b&=15;B=16;break;case 15:e=b&15;9>e?(b=n[h++],b|=n[h++]<<8):b=11>e?8:1;B=0;break;default:e>>=1,b&=31,B=32}0!=B&&(f=2==e||7==e,0==b?b=f?n[h++]+1:n[h++]+B:f&&(b<<=3));switch(e){case 0:C!=e||d==k&&-1==r||(K=!0);
break;case 8:f=n[h++]|n[h++]<<8,u=4278190080|f>>8&248|f>>13&7|(f>>3&252|f>>9&3)<<8|(f<<3&248|f>>2&7)<<16;case 3:f=n[h++]|n[h++]<<8;z=4278190080|f>>8&248|f>>13&7|(f>>3&252|f>>9&3)<<8|(f<<3&248|f>>2&7)<<16;break;case 6:case 7:f=n[h++]|n[h++]<<8;x=4278190080|f>>8&248|f>>13&7|(f>>3&252|f>>9&3)<<8|(f<<3&248|f>>2&7)<<16;e-=5;break;case 9:y=3;e=2;v=3;break;case 10:y=5,e=2,v=5}C=e;for(B=0;0<b;)switch(d>=k&&(d=0,A--,r=q,q=0+A*k),e){case 0:K&&(m[q+d]=-1==r?x:m[r+d]^x|4278190080,K=!1,b--,d++);if(-1==r){for(;0!=
(b&-8)&&d+8<k;)for(var p=0;8>p;p++)m[q+d]=4278190080,b--,d++;for(;0<b&&d<k;)m[q+d]=4278190080,b--,d++}else{for(;0!=(b&-8)&&d+8<k;)for(p=0;8>p;p++)m[q+d]=m[r+d],b--,d++;for(;0<b&&d<k;)m[q+d]=m[r+d],b--,d++}break;case 1:if(-1==r){for(;0!=(b&-8)&&d+8<k;)for(p=0;8>p;p++)m[q+d]=x,b--,d++;for(;0<b&&d<k;)m[q+d]=x,b--,d++}else{for(;0!=(b&-8)&&d+8<k;)for(p=0;8>p;p++)m[q+d]=m[r+d]^x|4278190080,b--,d++;for(;0<b&&d<k;)m[q+d]=m[r+d]^x|4278190080,b--,d++}break;case 2:if(-1==r){for(;0!=(b&-8)&&d+8<k;)for(p=0;8>
p;p++)B<<=1,B&=255,0==B&&(y=0!=v?v&255:n[h++],B=1),m[q+d]=0!=(y&B)?x:4278190080,b--,d++;for(;0<b&&d<k;)B<<=1,B&=255,0==B&&(y=0!=v?v&255:n[h++],B=1),m[q+d]=0!=(y&B)?x:4278190080,b--,d++}else{for(;0!=(b&-8)&&d+8<k;)for(p=0;8>p;p++)B<<=1,B&=255,0==B&&(y=0!=v?v&255:n[h++],B=1),m[q+d]=0!=(y&B)?m[r+d]^x|4278190080:m[r+d],b--,d++;for(;0<b&&d<k;)B<<=1,B&=255,0==B&&(y=0!=v?v&255:n[h++],B=1),m[q+d]=0!=(y&B)?m[r+d]^x|4278190080:m[r+d],b--,d++}break;case 3:for(;0!=(b&-8)&&d+8<k;)for(p=0;8>p;p++)m[q+d]=z,b--,
d++;for(;0<b&&d<k;)m[q+d]=z,b--,d++;break;case 4:for(;0!=(b&-8)&&d+8<k;)for(p=0;8>p;p++)f=n[h++]|n[h++]<<8,m[q+d]=4278190080|f>>8&248|f>>13&7|(f>>3&252|f>>9&3)<<8|(f<<3&248|f>>2&7)<<16,b--,d++;for(;0<b&&d<k;)f=n[h++]|n[h++]<<8,m[q+d]=4278190080|f>>8&248|f>>13&7|(f>>3&252|f>>9&3)<<8|(f<<3&248|f>>2&7)<<16,b--,d++;break;case 8:for(;0!=(b&-8)&&d+8<k;)for(p=0;8>p;p++)l?(m[q+d]=z,l=!1):(m[q+d]=u,l=!0,b++),b--,d++;for(;0<b&&d<k;)l?(m[q+d]=z,l=!1):(m[q+d]=u,l=!0,b++),b--,d++;break;case 13:for(;0!=(b&-8)&&
d+8<k;)for(p=0;8>p;p++)m[q+d]=4294967295,b--,d++;for(;0<b&&d<k;)m[q+d]=4294967295,b--,d++;break;case 14:for(;0!=(b&-8)&&d+8<k;)for(p=0;8>p;p++)m[q+d]=4278190080,b--,d++;for(;0<b&&d<k;)m[q+d]=4278190080,b--,d++;break;default:b--,d++}}return m};this.byte2int=function(k,u,w){u||(u=k.length);w||(w=0);u=Math.floor(u/4);for(var n=new Uint32Array(u),h,r=0;r<u;r++)h=(r<<2)+w,n[r]=(k[h+3]&255)<<24|k[h+2]&255|(k[h+1]&255)<<8|(k[h+0]&255)<<16;return n};this.decompressInt32=function(k,A,w,n,h){w=n[h];h+=1;var r=
k*A,q=new Uint32Array(4*r);if(0==(w&32)){for(var e=h,b,B,d=0,C,v,V,z=e,y=3;d<A;){b=y+k*A*4-(d+1)*k*4;for(B=0;B<k;){C=n[e++];v=C&15;C=C>>4&15;V=v<<4|C;47>=V&&16<=V&&(v=V,C=0);for(;0<C;)e++,q[b]=255,b+=4,B++,C--;for(;0<v;)q[b]=255,b+=4,B++,v--}d++}h+=e-z}else for(b=0;b<r;b++)e=b<<2,q[e+3]=255;0!=(w&16)?(w=u(n,h,k,A,q,2),h+=w,w=u(n,h,k,A,q,1),u(n,h+w,k,A,q,0)):(x(n,h,k,A,q,2),h+=r,x(n,h,k,A,q,1),x(n,h+r,k,A,q,0));return rdpBitmap.byte2int(q)};this.decompressInt24=function(k,u,w,n,h){var r=-1,q=-1;w=
h+w;for(var e,b,B,d=k,C=-1,v,A=0,z=0,y=0,x=4294967295,f=!1,K=!1,l,m=new Uint32Array(k*u);h<w;){v=0;b=n[h++];e=b>>4;switch(e){case 12:case 13:case 14:e-=6;b&=15;B=16;break;case 15:e=b&15;9>e?(b=n[h++],b|=n[h++]<<8):b=11>e?8:1;B=0;break;default:e>>=1,b&=31,B=32}0!=B&&(l=2==e||7==e,0==b?b=l?n[h++]+1:n[h++]+B:l&&(b<<=3));switch(e){case 0:C!=e||d==k&&-1==r||(f=!0);break;case 8:A=4278190080|n[h++]<<16|n[h++]<<8|n[h++];case 3:z=4278190080|n[h++]<<16|n[h++]<<8|n[h++];break;case 6:case 7:x=4278190080|n[h++]<<
16|n[h++]<<8|n[h++];e-=5;break;case 9:y=3;e=2;v=3;break;case 10:y=5,e=2,v=5}C=e;for(B=0;0<b;)switch(d>=k&&(d=0,u--,r=q,q=0+u*k),e){case 0:f&&(m[q+d]=-1==r?x:m[r+d]^x|4278190080,f=!1,b--,d++);if(-1==r){for(;0!=(b&-8)&&d+8<k;)for(l=0;8>l;l++)m[q+d]=4278190080,b--,d++;for(;0<b&&d<k;)m[q+d]=4278190080,b--,d++}else{for(;0!=(b&-8)&&d+8<k;)for(l=0;8>l;l++)m[q+d]=m[r+d],b--,d++;for(;0<b&&d<k;)m[q+d]=m[r+d],b--,d++}break;case 1:if(-1==r){for(;0!=(b&-8)&&d+8<k;)for(l=0;8>l;l++)m[q+d]=x,b--,d++;for(;0<b&&d<
k;)m[q+d]=x,b--,d++}else{for(;0!=(b&-8)&&d+8<k;)for(l=0;8>l;l++)m[q+d]=m[r+d]^x|4278190080,b--,d++;for(;0<b&&d<k;)m[q+d]=m[r+d]^x|4278190080,b--,d++}break;case 2:if(-1==r){for(;0!=(b&-8)&&d+8<k;)for(l=0;8>l;l++)B<<=1,B&=255,0==B&&(y=0!=v?v&255:n[h++],B=1),m[q+d]=0!=(y&B)?x:4278190080,b--,d++;for(;0<b&&d<k;)B<<=1,B&=255,0==B&&(y=0!=v?v&255:n[h++],B=1),m[q+d]=0!=(y&B)?x:4278190080,b--,d++}else{for(;0!=(b&-8)&&d+8<k;)for(l=0;8>l;l++)B<<=1,B&=255,0==B&&(y=0!=v?v&255:n[h++],B=1),m[q+d]=0!=(y&B)?m[r+d]^
x|4278190080:m[r+d],b--,d++;for(;0<b&&d<k;)B<<=1,B&=255,0==B&&(y=0!=v?v&255:n[h++],B=1),m[q+d]=0!=(y&B)?m[r+d]^x|4278190080:m[r+d],b--,d++}break;case 3:for(;0!=(b&-8)&&d+8<k;)for(l=0;8>l;l++)m[q+d]=z,b--,d++;for(;0<b&&d<k;)m[q+d]=z,b--,d++;break;case 4:for(;0!=(b&-8)&&d+8<k;)for(l=0;8>l;l++)m[q+d]=4278190080|n[h++]<<16|n[h++]<<8|n[h++],b--,d++;for(;0<b&&d<k;)m[q+d]=4278190080|n[h++]<<16|n[h++]<<8|n[h++],b--,d++;break;case 8:for(;0!=(b&-8)&&d+8<k;)for(l=0;8>l;l++)K?(m[q+d]=z,K=!1):(m[q+d]=A,K=!0,b++),
b--,d++;for(;0<b&&d<k;)K?(m[q+d]=z,K=!1):(m[q+d]=A,K=!0,b++),b--,d++;break;case 13:for(;0!=(b&-8)&&d+8<k;)for(l=0;8>l;l++)m[q+d]=4294967295,b--,d++;for(;0<b&&d<k;)m[q+d]=4294967295,b--,d++;break;case 14:for(;0!=(b&-8)&&d+8<k;)for(l=0;8>l;l++)m[q+d]=4278190080,b--,d++;for(;0<b&&d<k;)m[q+d]=4278190080,b--,d++}}return m};this.decompress=function(k,u,w,n,h){var r=-1,q=0;w+=h;var e=k,b=-1,B=0,d=0,C=0,v=4294967295,x=!1,z=!1,y=new Uint8Array(k*u);for(y[0]=0;h<w;){var A=0;var f=n[h++];var K=f>>4;switch(K){case 12:case 13:case 14:K-=
6;f&=15;var l=16;break;case 15:K=f&15;9>K?(f=n[h++],f|=n[h++]<<8):f=11>K?8:1;l=0;break;default:K>>=1,f&=31,l=32}if(0!=l){var m=2==K||7==K;0==f?f=m?n[h++]+1:n[h++]+l:m&&(f<<=3)}switch(K){case 0:b!=K||e==k&&-1==r||(x=!0);break;case 8:B=n[h++];case 3:d=n[h++];break;case 6:case 7:v=n[h++];K-=5;break;case 9:C=3;K=2;A=3;break;case 10:C=5,K=2,A=5}b=K;for(l=0;0<f;)switch(e>=k&&(e=0,u--,r=q,q=0+u*k),K){case 0:x&&(y[q+e]=-1==r?v:y[r+e]^v,x=!1,f--,e++);if(-1==r){for(;0!=(f&-8)&&e+8<k;)for(m=0;8>m;m++)y[q+e]=
0,f--,e++;for(;0<f&&e<k;)y[q+e]=0,f--,e++}else{for(;0!=(f&-8)&&e+8<k;)for(m=0;8>m;m++)y[q+e]=y[r+e],f--,e++;for(;0<f&&e<k;)y[q+e]=y[r+e],f--,e++}break;case 1:if(-1==r){for(;0!=(f&-8)&&e+8<k;)for(m=0;8>m;m++)y[q+e]=v,f--,e++;for(;0<f&&e<k;)y[q+e]=v,f--,e++}else{for(;0!=(f&-8)&&e+8<k;)for(m=0;8>m;m++)y[q+e]=y[r+e]^v,f--,e++;for(;0<f&&e<k;)y[q+e]=y[r+e]^v,f--,e++}break;case 2:if(-1==r){for(;0!=(f&-8)&&e+8<k;)for(m=0;8>m;m++)l<<=1,l&=255,0==l&&(C=0!=A?A:n[h++],l=1),y[q+e]=0!=(C&l)?v:0,f--,e++;for(;0<
f&&e<k;)l<<=1,l&=255,0==l&&(C=0!=A?A:n[h++],l=1),y[q+e]=0!=(C&l)?v:0,f--,e++}else{for(;0!=(f&-8)&&e+8<k;)for(m=0;8>m;m++)l<<=1,l&=255,0==l&&(C=0!=A?A:n[h++],l=1),y[q+e]=0!=(C&l)?y[r+e]^v:y[r+e],f--,e++;for(;0<f&&e<k;)l<<=1,l&=255,0==l&&(C=0!=A?A:n[h++],l=1),y[q+e]=0!=(C&l)?y[r+e]^v:y[r+e],f--,e++}break;case 3:for(;0!=(f&-8)&&e+8<k;)for(m=0;8>m;m++)y[q+e]=d,f--,e++;for(;0<f&&e<k;)y[q+e]=d,f--,e++;break;case 4:for(;0!=(f&-8)&&e+8<k;)for(m=0;8>m;m++)y[q+e]=n[h++],f--,e++;for(;0<f&&e<k;)y[q+e]=n[h++],
f--,e++;break;case 8:for(;0!=(f&-8)&&e+8<k;)for(m=0;8>m;m++)z?(y[q+e]=d,z=!1):(y[q+e]=B,z=!0,f++),f--,e++;for(;0<f&&e<k;)z?(y[q+e]=d,z=!1):(y[q+e]=B,z=!0,f++),f--,e++;break;case 13:for(;0!=(f&-8)&&e+8<k;)for(m=0;8>m;m++)y[q+e]=255,f--,e++;for(;0<f&&e<k;)y[q+e]=255,f--,e++;break;case 14:for(;0!=(f&-8)&&e+8<k;)for(m=0;8>m;m++)y[q+e]=0,f--,e++;for(;0<f&&e<k;)y[q+e]=0,f--,e++;break;default:f--,e++}}return y}};
function MSGSMEncoder(){function u(a,b){return-32768==a&&-32768==b?32767:a*b>>15<<16>>16}function x(a,b){return-32768==a&&-32768==b?32767:a*b+16384>>15<<16>>16}function k(a,b){if(0>=a){if(0<=b)return a+b;var d=-(a+1)-(b+1);return 2147483647<=d?-2147483648:-d-2}if(0>=b)return a+b;d=a+b;return 2147483647<d?2147483647:d}function A(a){if(0>a){if(-1073741824>=a)return 0;a=~a}return(0!=(a&4294901760)?0!=(a&4278190080)?-1+S[255&a>>24]:7+S[255&a>>16]:0!=(a&65280)?15+S[255&a>>8]:23+S[255&a])<<16>>16}function w(a,
b){return 16<=b?0>a?-1:-0:-16>=b?0:0>b?a<<-b<<16>>16:a>>b<<16>>16}function n(a,b,d,e,f,h){a=u(a<<16>>16,f[h]);b=a+(b<<16>>16);b=(-32768>b?-32768:32767<b?32767:b)+256;a=(-32768>b?-32768:32767<b?32767:b)>>9<<16>>16;f[h]=(a>d?d-e:a<e?0:a-e)<<16>>16}function h(a,b){var d=pa[a+3*b]>>2<<16>>16;return d*d}function r(a,b,d,e,f,h,p){a=a[d]+h;f=((-32768>a?-32768:32767<a?32767:a)<<26>>16)-(f<<17>>16);e=x(p,-32768>f?-32768:32767<f?32767:f);p=e+e;b[d]=-32768>p?-32768:32767<p?32767:p}function q(a){for(var b,d,
e=0;8>e;e++)0>a[e]?(b=(-32768==a[e]?32767:-a[e])<<16>>16,d=(b>>2<<16>>16)+26112,a[e]=-(11059>b?b<<1:20070>b?b+11059:-32768>d?-32768:32767<d?32767:d)<<16>>16):(b=a[e],d=(b>>2<<16>>16)+26112,a[e]=(11059>b?b<<1:20070>b?b+11059:-32768>d?-32768:32767<d?32767:d)<<16>>16)}function e(a,b,d,e,f){for(var h=a.u,p,m,n,k,q,t;0!=d;){d--;p=k=e[f];for(t=0;8>t;t++)n=h[t],q=b[t],h[t]=k,m=x(q,p),k=n+m,k=-32768>k?-32768:32767<k?32767:k,m=x(q,n),p+=m,p=-32768>p?-32768:32767<p?32767:p;e[f++]=p}a.u=h}var b=[6554,16384,
26214,32767],B=[29128,26215,23832,21846,20165,18725,17476,16384],d=[18431,20479,22527,24575,26623,28671,30719,32767],C=new function(){this.dp0=new Int16Array(280);this.mp=this.l_z2=this.z1=0;this.u=new Int16Array(8);this.larpp=[new Int16Array(8),new Int16Array(8)];this.j=0;this.nrp=40;this.v=new Int16Array(9);this.msr=0},v=new Int16Array(8),V=new Int16Array(4),z=new Int16Array(4),y=new Int16Array(4),R=new Int16Array(4),f=new Int16Array(52),K=new Int16Array(160),l=new Uint8Array(33),m=0,p=hi5.Arrays.arraycopy;
this.encode=function(a,S,ec,Ib){for(var rb=S,ta,sa=0;160>sa;sa++)ta=a[rb++],K[sa]=0>ta?32768*ta:32767*ta;D=!D;for(var F=0,kb=0,jb=0,$a=0,Q=120,xb=new Int16Array(50),H=new Int16Array(160),vc=0,Fc=0,lc=C.z1,Va=C.l_z2,wb=C.mp,gc,J,fb,Wb,Ma,wa,Xb=160;0!=Xb;){Xb--;Wb=K[vc++]>>3<<2<<16>>16;gc=Wb-lc<<16>>16;lc=Wb;Ma=gc;Ma<<=15;J=Va>>15<<16>>16;fb=Va-(J<<15)<<16>>16;Ma+=x(fb,32735);wa=32735*J;Va=k(wa,Ma);wa=k(Va,16384);J=x(wb,-28180);var wb=wa>>15<<16>>16,ia=wb+J;H[Fc++]=-32768>ia?-32768:32767<ia?32767:ia}C.z1=
lc;C.l_z2=Va;C.mp=wb;var ba,I=0,sb=0,W;for(W=0;159>=W;W++){var Vb=H[W]+0;var zb=-32768>Vb?-32768:32767<Vb?32767:Vb;zb>sb&&(sb=zb)}var Pb=0==sb?0:4-A(sb<<16)<<16>>16;if(0<Pb)switch(Pb){case 1:for(W=0;159>=W;W++)H[W]=x(H[W],16384);break;case 2:for(W=0;159>=W;W++)H[W]=x(H[W],8192);break;case 3:for(W=0;159>=W;W++)H[W]=x(H[W],4096);break;case 4:for(W=0;159>=W;W++)H[W]=x(H[W],2048)}var L=H[I];p([0,0,0,0,0,0,0,0,0],0,t,0,t.length);t[0]+=L*H[I-0];L=H[++I];t[0]+=L*H[I-0];t[1]+=L*H[I-1];L=H[++I];t[0]+=L*H[I-
0];t[1]+=L*H[I-1];t[2]+=L*H[I-2];L=H[++I];t[0]+=L*H[I-0];t[1]+=L*H[I-1];t[2]+=L*H[I-2];t[3]+=L*H[I-3];L=H[++I];t[0]+=L*H[I-0];t[1]+=L*H[I-1];t[2]+=L*H[I-2];t[3]+=L*H[I-3];t[4]+=L*H[I-4];L=H[++I];t[0]+=L*H[I-0];t[1]+=L*H[I-1];t[2]+=L*H[I-2];t[3]+=L*H[I-3];t[4]+=L*H[I-4];t[5]+=L*H[I-5];L=H[++I];t[0]+=L*H[I-0];t[1]+=L*H[I-1];t[2]+=L*H[I-2];t[3]+=L*H[I-3];t[4]+=L*H[I-4];t[5]+=L*H[I-5];t[6]+=L*H[I-6];L=H[++I];t[0]+=L*H[I-0];t[1]+=L*H[I-1];t[2]+=L*H[I-2];t[3]+=L*H[I-3];t[4]+=L*H[I-4];t[5]+=L*H[I-5];t[6]+=
L*H[I-6];t[7]+=L*H[I-7];++I;for(ba=I;160>ba;++ba)L=H[ba],t[0]+=L*H[ba-0],t[1]+=L*H[ba-1],t[2]+=L*H[ba-2],t[3]+=L*H[ba-3],t[4]+=L*H[ba-4],t[5]+=L*H[ba-5],t[6]+=L*H[ba-6],t[7]+=L*H[ba-7],t[8]+=L*H[ba-8];for(W=0;9>W;W++)t[W]<<=1;if(0<Pb)for(W=0;160>W;W++)H[W]<<=Pb;var xa=new Int16Array(1),cb=0,N,Fa=new Int16Array(9),ya=new Int16Array(9),ha=new Int16Array(9);if(0==t[0])for(N=0;8>N;N++)v[N]=0;else{xa[0]=A(t[0]);for(N=0;8>=N;N++)Fa[N]=t[N]<<xa[0]>>16;p(Fa,0,ha,0,7);p(Fa,0,ya,0,8);for(var aa=1;8>=aa;aa++,
cb++){xa[0]=ya[1];xa[0]=(0>xa[0]?-32768==xa[0]?32767:-xa[0]:xa[0])<<16>>16;if(ya[0]<xa[0]){for(N=aa;8>N;N++)v[N]=0;break}var fa=cb;var ca=xa[0],Ab=ca,bb=ya[0],La=0,Fb=15;if(0==ca)var mc=0;else{for(;0!=Fb;)Fb--,La=La<<17>>16,Ab<<=1,Ab>=bb&&(Ab-=bb,La++);mc=La<<16>>16}v[fa]=mc;0<ya[1]&&(v[cb]=-v[cb]);if(8==aa)break;xa[0]=x(ya[1],v[cb]);var ab=ya[0]+xa[0];ya[0]=-32768>ab?-32768:32767<ab?32767:ab;for(var Ka=1;Ka<=8-aa;Ka++){xa[0]=x(ha[Ka],v[cb]);var ga=ya[Ka+1]+xa[0];ya[Ka]=-32768>ga?-32768:32767<ga?
32767:ga;xa[0]=x(ya[Ka+1],v[cb]);var Na=ha[Ka]+xa[0];ha[Ka]=-32768>Na?-32768:32767<Na?32767:Na}}}for(var ua,nb=0;8>nb;nb++)ua=v[nb],ua=(0>ua?-32768==ua?32767:-ua:ua)<<16>>16,22118>ua?ua>>=1:31130>ua?ua-=11059:(ua-=26112,ua<<=2),v[nb]=0>v[nb]?-ua:ua;var gb=0;n(20480,0,31,-32,v,gb++);n(20480,0,31,-32,v,gb++);n(20480,2048,15,-16,v,gb++);n(20480,-2560,15,-16,v,gb++);n(13964,94,7,-8,v,gb++);n(15360,-1792,7,-8,v,gb++);n(8534,-341,3,-4,v,gb++);n(9036,-1144,3,-4,v,gb++);var Da=new Int16Array(8),$b=C.j;var jc=
$b^1;C.j=jc;var Za=C.larpp[$b],yb=C.larpp[jc],c=0;r(v,Za,c++,0,0,-32,13107);r(v,Za,c++,0,0,-32,13107);r(v,Za,c++,0,2048,-16,13107);r(v,Za,c++,0,-2560,-16,13107);r(v,Za,c++,0,94,-8,19223);r(v,Za,c++,0,-1792,-8,17476);r(v,Za,c++,0,-341,-4,31454);r(v,Za,c++,0,-1144,-4,29708);for(var ea=0;8>ea;ea++){var Qc=(yb[ea]>>2<<16>>16)+(Za[ea]>>2<<16>>16);Da[ea]=-32768>Qc?-32768:32767<Qc?32767:Qc;var Rc=Da[ea]+(yb[ea]>>1<<16>>16);Da[ea]=-32768>Rc?-32768:32767<Rc?32767:Rc}q(Da);e(C,Da,13,H,0);for(var oc=0;8>oc;oc++){var Sc=
(yb[oc]>>1<<16>>16)+(Za[oc]>>1<<16>>16);Da[oc]=-32768>Sc?-32768:32767<Sc?32767:Sc}q(Da);e(C,Da,14,H,13);for(var ac=0;8>ac;ac++){var Tc=(yb[ac]>>2<<16>>16)+(Za[ac]>>2<<16>>16);Da[ac]=-32768>Tc?-32768:32767<Tc?32767:Tc;var Uc=Da[ac]+(Za[ac]>>1<<16>>16);Da[ac]=-32768>Uc?-32768:32767<Uc?32767:Uc}q(Da);e(C,Da,13,H,27);for(var wc=0;8>wc;wc++)Da[wc]=Za[wc];q(Da);e(C,Da,120,H,40);for(var hc=C.dp0,Qb,xc,Vc=0;3>=Vc;Vc++,kb+=13){for(var ld=H,md=40*Vc,Zd=xb,nd=hc,$d=hc,od=Q,pd=V,qd=y,Wc=jb++,lb=void 0,Xc=void 0,
rd=void 0,sd=void 0,ic=void 0,bc=void 0,yc=void 0,T=void 0,td=ld,ud=md,X=nd,Y=od,Yc=qd,ae=pd,zc=Wc,U=new Int16Array(40),Ac=0,Gb=0;39>=Gb;Gb++)lb=td[Gb+ud],lb=(0>lb?-32768==lb?32767:-lb:lb)<<16>>16,lb>Ac&&(Ac=lb);lb=0;0!=Ac&&(lb=A(Ac<<16));Xc=6<lb?0:6-lb<<16>>16;for(Gb=0;39>=Gb;Gb++)U[Gb]=td[Gb+ud]>>Xc;bc=0;for(T=yc=40;120>=T;T++){var E=1;var O=U[0]*X[Y-T];O+=U[1]*X[E+Y-T];E++;O+=U[2]*X[E+Y-T];E++;O+=U[3]*X[E+Y-T];E++;O+=U[4]*X[E+Y-T];E++;O+=U[5]*X[E+Y-T];E++;O+=U[6]*X[E+Y-T];E++;O+=U[7]*X[E+Y-T];
E++;O+=U[8]*X[E+Y-T];E++;O+=U[9]*X[E+Y-T];E++;O+=U[10]*X[E+Y-T];E++;O+=U[11]*X[E+Y-T];E++;O+=U[12]*X[E+Y-T];E++;O+=U[13]*X[E+Y-T];E++;O+=U[14]*X[E+Y-T];E++;O+=U[15]*X[E+Y-T];E++;O+=U[16]*X[E+Y-T];E++;O+=U[17]*X[E+Y-T];E++;O+=U[18]*X[E+Y-T];E++;O+=U[19]*X[E+Y-T];E++;O+=U[20]*X[E+Y-T];E++;O+=U[21]*X[E+Y-T];E++;O+=U[22]*X[E+Y-T];E++;O+=U[23]*X[E+Y-T];E++;O+=U[24]*X[E+Y-T];E++;O+=U[25]*X[E+Y-T];E++;O+=U[26]*X[E+Y-T];E++;O+=U[27]*X[E+Y-T];E++;O+=U[28]*X[E+Y-T];E++;O+=U[29]*X[E+Y-T];E++;O+=U[30]*X[E+Y-
T];E++;O+=U[31]*X[E+Y-T];E++;O+=U[32]*X[E+Y-T];E++;O+=U[33]*X[E+Y-T];E++;O+=U[34]*X[E+Y-T];E++;O+=U[35]*X[E+Y-T];E++;O+=U[36]*X[E+Y-T];E++;O+=U[37]*X[E+Y-T];E++;O+=U[38]*X[E+Y-T];E++;O+=U[39]*X[E+Y-T];O>bc&&(yc=T<<16>>16,bc=O)}ae[zc]=yc;bc=bc<<1>>6-Xc;for(Gb=ic=0;39>=Gb;Gb++){var vd=X[Gb-yc+Y]>>3<<16>>16;ic+=vd*vd}ic<<=1;if(0>=bc)Yc[zc]=0;else if(bc>=ic)Yc[zc]=3;else for(var lb=A(ic),sd=bc<<lb>>16<<16>>16,rd=ic<<lb>>16<<16>>16,Bc=0;2>=Bc&&!(sd<=u(rd,b[Bc]));Bc++)Yc[zc]=Bc;var Oa=void 0,da=void 0,
cc=void 0,Cc=pd[Wc],Dc=nd,Ec=ld,Ja=md,Hb=$d,fc=Zd,Wa=od;switch(qd[Wc]){case 0:cc=3277;for(da=0;39>=da;da++)Hb[da+Wa]=x(cc,Dc[da-Cc+Wa]),Oa=Ec[da+Ja]-Hb[da+Wa],fc[da+5]=-32768>Oa?-32768:32767<Oa?32767:Oa;break;case 1:cc=11469;for(da=0;39>=da;da++)Hb[da+Wa]=x(cc,Dc[da-Cc+Wa]),Oa=Ec[da+Ja]-Hb[da+Wa],fc[da+5]=-32768>Oa?-32768:32767<Oa?32767:Oa;break;case 2:cc=21299;for(da=0;39>=da;da++)Hb[da+Wa]=x(cc,Dc[da-Cc+Wa]),Oa=Ec[da+Ja]-Hb[da+Wa],fc[da+5]=-32768>Oa?-32768:32767<Oa?32767:Oa;break;case 3:for(cc=
32767,da=0;39>=da;da++)Hb[da+Wa]=x(cc,Dc[da-Cc+Wa]),Oa=Ec[da+Ja]-Hb[da+Wa],fc[da+5]=-32768>Oa?-32768:32767<Oa?32767:Oa}for(var wd=xb,be=R,ma=z,mb=$a++,xd=f,tb=kb,Bb=new Int16Array(13),db=new Int16Array(13),na=void 0,ub=wd,Pa=0;39>=Pa;Pa++)na=4096,na+=-134*ub[Pa+0]+-374*ub[Pa+1]+2054*ub[Pa+3]+5741*ub[Pa+4]+8192*ub[Pa+5]+5741*ub[Pa+6]+2054*ub[Pa+7]+-374*ub[Pa+9]+-134*ub[Pa+10],na=na>>13<<16>>16,pa[Pa]=-32768>na?-32768:32767<na?32767:na;var yd=void 0,Cb=void 0,Aa=void 0,ce=Bb,Qa=ma,oa=mb,Xa=0,yd=Aa=
0+(h(0,1)+h(0,2)+h(0,3)+h(0,4)+h(0,5)+h(0,6)+h(0,7)+h(0,8)+h(0,9)+h(0,10)+h(0,11)+h(0,12)),Aa=Aa+h(0,0),Cb=Aa<<1,Aa=0+(h(1,0)+h(1,1)+h(1,2)+h(1,3)+h(1,4)+h(1,5)+h(1,6)+h(1,7)+h(1,8)+h(1,9)+h(1,10)+h(1,11)+h(1,12)),Aa=Aa<<1;Aa>Cb&&(Xa=1,Cb=Aa);Aa=0+(h(2,0)+h(2,1)+h(2,2)+h(2,3)+h(2,4)+h(2,5)+h(2,6)+h(2,7)+h(2,8)+h(2,9)+h(2,10)+h(2,11)+h(2,12));Aa<<=1;Aa>Cb&&(Xa=2,Cb=Aa);Aa=yd+h(3,12);Aa<<=1;Aa>Cb&&(Xa=3);for(var Db=0;12>=Db;Db++)ce[Db]=pa[Xa+3*Db];Qa[oa]=Xa;for(var ob=void 0,Ya=void 0,Ra=void 0,Ba=
void 0,vb=void 0,zd=void 0,Ca=void 0,pc=void 0,pb=void 0,Ga=Bb,Zc=xd,de=tb,$c=be,Jb=mb,Ha=0,Ya=0;12>=Ya;Ya++)Ca=Ga[Ya],Ca=0>Ca?-32768==Ca?32767:-Ca:Ca,Ca>Ha&&(Ha=Ca);Ba=0;Ca=Ha>>9<<16>>16;for(Ya=pb=0;5>=Ya;Ya++)pb=0>=Ca?pb|1:pb|0,Ca=Ca>>1<<16>>16,0==pb&&Ba++;var Kb=(Ha>>(Ba+5<<16>>16)<<16>>16)+(Ba<<3<<16>>16),pc=-32768>Kb?-32768:32767<Kb?32767:Kb,Sa=0;15<pc&&(Sa=(pc>>3<<16>>16)-1<<16>>16);ob=pc-(Sa<<3)<<16>>16;if(0==ob)Sa=-4,ob=7;else{for(;7>=ob;)ob=(ob<<1|1)<<16>>16,Sa--;ob-=8}G==G?(P=Sa,ja=ob):
(Z=Sa,ka=ob);Ba=P;Ra=ja;zd=6-Ba<<16>>16;vb=B[Ra];for(Ya=0;12>=Ya;Ya++)Ca=Ga[Ya]<<zd<<16>>16,Ca=u(Ca,vb),Ca=Ca>>12<<16>>16,Zc[Ya+de]=Ca+4<<16>>16;ja=Ra;P=Ba;$c[Jb]=pc;var Lb=void 0,Ta=void 0,va=void 0,Mb=void 0,qc=void 0,qa=void 0,ee=xd,qb=db,ra=tb;G==G?(qc=d[ja],Ta=6-P<<16>>16):(qc=d[ka],Ta=6-Z<<16>>16);for(var Mb=-32768>Ta?-32768:32767<Ta?32767:Ta,Ta=Mb-1,eb=-32768>Ta?-32768:32767<Ta?32767:Ta,va=16<=eb?0:-16>=eb?-0:0>eb?w(1,-eb):1<<eb<<16>>16,Rb=M=0;13>Rb;Rb++)qa=(ee[ra++]<<1)-7<<16>>16,qa=qa<<28>>
16,qa=x(qc,qa),Lb=qa+va,qa=-32768>Lb?-32768:32767<Lb?32767:Lb,qb[M++]=w(qa,Mb);var za=void 0,Eb=db,Ua=wd,Ad=G,Sb=13,Gc=0,za=Ad==G?5:0;switch(ma[mb]){case 3:Ua[za++]=0;do Ua[za++]=0,Ua[za++]=0,Ua[za++]=Eb[Gc++],--Sb;while(0!=Sb);break;case 2:do Ua[za++]=0,Ua[za++]=0,Ua[za++]=Eb[Gc++],--Sb;while(0!=Sb);break;case 1:do Ua[za++]=0,Ua[za++]=Eb[Gc++],Ua[za++]=0,--Sb;while(0!=Sb);break;case 0:do Ua[za++]=Eb[Gc++],Ua[za++]=0,Ua[za++]=0,--Sb;while(0!=Sb)}Ad==G&&(Ua[za++]=0);for(Qb=0;39>=Qb;Qb++)xc=xb[5+Qb]+
hc[Qb+Q],hc[Qb+Q]=-32768>xc?-32768:32767<xc?32767:xc;Q+=40}for(Qb=0;120>Qb;Qb++)hc[Qb]=hc[160+Qb];if(D){var g=v[0]<<4|v[1]<<10;l[F++]=g>>4;g=g>>5|v[2]<<11;l[F++]=g>>7;g=g>>5|v[3]<<11;g=g>>4|v[4]<<12;l[F++]=g>>6;g=g>>4|v[5]<<12;g=g>>3|v[6]<<13;l[F++]=g>>7;g=g>>3|v[7]<<13;g=g>>7|V[0]<<9;l[F++]=g>>5;g=g>>2|y[0]<<14;g=g>>2|z[0]<<14;g=g>>6|R[0]<<10;l[F++]=g>>3;g=g>>3|f[0]<<13;l[F++]=g>>8;g=g>>3|f[1]<<13;g=g>>3|f[2]<<13;g=g>>3|f[3]<<13;l[F++]=g>>7;g=g>>3|f[4]<<13;g=g>>3|f[5]<<13;g=g>>3|f[6]<<13;l[F++]=
g>>6;g=g>>3|f[7]<<13;g=g>>3|f[8]<<13;l[F++]=g>>8;g=g>>3|f[9]<<13;g=g>>3|f[10]<<13;g=g>>3|f[11]<<13;l[F++]=g>>7;g=g>>3|f[12]<<13;g=g>>7|V[1]<<9;l[F++]=g>>5;g=g>>2|y[1]<<14;g=g>>2|z[1]<<14;g=g>>6|R[1]<<10;l[F++]=g>>3;g=g>>3|f[13]<<13;l[F++]=g>>8;g=g>>3|f[14]<<13;g=g>>3|f[15]<<13;g=g>>3|f[16]<<13;l[F++]=g>>7;g=g>>3|f[17]<<13;g=g>>3|f[18]<<13;g=g>>3|f[19]<<13;l[F++]=g>>6;g=g>>3|f[20]<<13;g=g>>3|f[21]<<13;l[F++]=g>>8;g=g>>3|f[22]<<13;g=g>>3|f[23]<<13;g=g>>3|f[24]<<13;l[F++]=g>>7;g=g>>3|f[25]<<13;g=g>>
7|V[2]<<9;l[F++]=g>>5;g=g>>2|y[2]<<14;g=g>>2|z[2]<<14;g=g>>6|R[2]<<10;l[F++]=g>>3;g=g>>3|f[26]<<13;l[F++]=g>>8;g=g>>3|f[27]<<13;g=g>>3|f[28]<<13;g=g>>3|f[29]<<13;l[F++]=g>>7;g=g>>3|f[30]<<13;g=g>>3|f[31]<<13;g=g>>3|f[32]<<13;l[F++]=g>>6;g=g>>3|f[33]<<13;g=g>>3|f[34]<<13;l[F++]=g>>8;g=g>>3|f[35]<<13;g=g>>3|f[36]<<13;g=g>>3|f[37]<<13;l[F++]=g>>7;g=g>>3|f[38]<<13;g=g>>7|V[3]<<9;l[F++]=g>>5;g=g>>2|y[3]<<14;g=g>>2|z[3]<<14;g=g>>6|R[3]<<10;l[F++]=g>>3;g=g>>3|f[39]<<13;l[F++]=g>>8;g=g>>3|f[40]<<13;g=g>>
3|f[41]<<13;g=g>>3|f[42]<<13;l[F++]=g>>7;g=g>>3|f[43]<<13;g=g>>3|f[44]<<13;g=g>>3|f[45]<<13;l[F++]=g>>6;g=g>>3|f[46]<<13;g=g>>3|f[47]<<13;l[F++]=g>>8;g=g>>3|f[48]<<13;g=g>>3|f[49]<<13;g=g>>3|f[50]<<13;l[F++]=g>>7;g=g>>3|f[51]<<13;l[F]=g>>12;m=l[F]}else g=m<<6|v[0]<<10,l[F++]=g>>6,g=g>>6|v[1]<<10,l[F++]=g>>8,g=g>>5|v[2]<<11,g=g>>5|v[3]<<11,l[F++]=g>>6,g=g>>4|v[4]<<12,g=g>>4|v[5]<<12,l[F++]=g>>6,g=g>>3|v[6]<<13,g=g>>3|v[7]<<13,l[F++]=g>>8,g=g>>7|V[0]<<9,g=g>>2|y[0]<<14,l[F++]=g>>7,g=g>>2|z[0]<<14,g=
g>>6|R[0]<<10,l[F++]=g>>7,g=g>>3|f[0]<<13,g=g>>3|f[1]<<13,g=g>>3|f[2]<<13,l[F++]=g>>6,g=g>>3|f[3]<<13,g=g>>3|f[4]<<13,l[F++]=g>>8,g=g>>3|f[5]<<13,g=g>>3|f[6]<<13,g=g>>3|f[7]<<13,l[F++]=g>>7,g=g>>3|f[8]<<13,g=g>>3|f[9]<<13,g=g>>3|f[10]<<13,l[F++]=g>>6,g=g>>3|f[11]<<13,g=g>>3|f[12]<<13,l[F++]=g>>8,g=g>>7|V[1]<<9,g=g>>2|y[1]<<14,l[F++]=g>>7,g=g>>2|z[1]<<14,g=g>>6|R[1]<<10,l[F++]=g>>7,g=g>>3|f[13]<<13,g=g>>3|f[14]<<13,g=g>>3|f[15]<<13,l[F++]=g>>6,g=g>>3|f[16]<<13,g=g>>3|f[17]<<13,l[F++]=g>>8,g=g>>3|f[18]<<
13,g=g>>3|f[19]<<13,g=g>>3|f[20]<<13,l[F++]=g>>7,g=g>>3|f[21]<<13,g=g>>3|f[22]<<13,g=g>>3|f[23]<<13,l[F++]=g>>6,g=g>>3|f[24]<<13,g=g>>3|f[25]<<13,l[F++]=g>>8,g=g>>7|V[2]<<9,g=g>>2|y[2]<<14,l[F++]=g>>7,g=g>>2|z[2]<<14,g=g>>6|R[2]<<10,l[F++]=g>>7,g=g>>3|f[26]<<13,g=g>>3|f[27]<<13,g=g>>3|f[28]<<13,l[F++]=g>>6,g=g>>3|f[29]<<13,g=g>>3|f[30]<<13,l[F++]=g>>8,g=g>>3|f[31]<<13,g=g>>3|f[32]<<13,g=g>>3|f[33]<<13,l[F++]=g>>7,g=g>>3|f[34]<<13,g=g>>3|f[35]<<13,g=g>>3|f[36]<<13,l[F++]=g>>6,g=g>>3|f[37]<<13,g=g>>
3|f[38]<<13,l[F++]=g>>8,g=g>>7|V[3]<<9,g=g>>2|y[3]<<14,l[F++]=g>>7,g=g>>2|z[3]<<14,g=g>>6|R[3]<<10,l[F++]=g>>7,g=g>>3|f[39]<<13,g=g>>3|f[40]<<13,g=g>>3|f[41]<<13,l[F++]=g>>6,g=g>>3|f[42]<<13,g=g>>3|f[43]<<13,l[F++]=g>>8,g=g>>3|f[44]<<13,g=g>>3|f[45]<<13,g=g>>3|f[46]<<13,l[F++]=g>>7,g=g>>3|f[47]<<13,g=g>>3|f[48]<<13,g=g>>3|f[49]<<13,l[F++]=g>>6,g=g>>3|f[50]<<13,g=g>>3|f[51]<<13,l[F++]=g>>8;var Zb,Tb=D?32:33;for(Zb=0;Zb<Tb;Zb++)ec[Zb+Ib]=l[Zb];return Tb};var D=!1,S=[8,7,6,6,5,5,5,5,4,4,4,4,4,4,4,4,
3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],t=new Int32Array(9),
P=0,ja=0,Z=0,ka=0,M=0,G=0,pa=new Int16Array(40)}
function MSGSM(){function u(p,n,v,t,u,y,z,ka){var D=0;f(K,0,160,0);f(l,0,40,0);for(var G=0;3>=G;G++,D+=13){var pa=u[G],a=v[G],S=D,ja=y,Z=l,P=new Int32Array(13);P.buffer||f(P,0,13,0);var ta=0;15<pa&&(ta=(pa>>3)-1);pa-=ta<<3;if(0==pa)ta=-4,pa=7;else{for(;7>=pa;)pa=pa<<1|1,ta--;pa-=8}var sa=Array(2);sa[0]=ta;sa[1]=pa;var ta=P,pa=S,S=q[sa[1]];sa=h(6,sa[0]);var F=h(sa,1);F=16<=F?0:-16>=F?-0:0>F?r(1,-F):1<<F;for(var kb=0,jb=0;13>jb;jb++){var $a=(ja[pa++]<<1)-7;$a<<=12;$a=w(S,$a);$a+=F;-32768>$a?$a=-32768:
32767<$a&&($a=32767);ta[kb++]=r($a,sa)}ja=13;S=ta=0;switch(a){case 3:Z[S++]=0;case 2:Z[S++]=0;case 1:Z[S++]=0;case 0:Z[S++]=P[ta++],ja--}do Z[S++]=0,Z[S++]=0,Z[S++]=P[ta++];while(0<--ja);for(;4>++a;)Z[S++]=0;P=n[G];a=t[G];Z=l;C=P=40>P||120<P?C:P;ja=e[a];for(ta=0;39>=ta;ta++)a=w(ja,b[ta-P+120]),a+=Z[ta],-32768>a?a=-32768:32767<a&&(a=32767),b[ta+120]=a;R(b,40,b,0,120);R(b,120,K,40*G,39)}n=B[d];v=B[d^=1];t=0;x(p,n,t++,0,0,-32,13107);x(p,n,t++,0,0,-32,13107);x(p,n,t++,0,2048,-16,13107);x(p,n,t++,0,-2560,
-16,13107);x(p,n,t++,0,94,-8,19223);x(p,n,t++,0,-1792,-8,17476);x(p,n,t++,0,-341,-4,31454);x(p,n,t++,0,-1144,-4,29708);p=m;for(u=0;8>u;u++)t=(v[u]>>2)+(n[u]>>2),-32768>t?t=-32768:32767<t&&(t=32767),t+=v[u]>>1,-32768>t?t=-32768:32767<t&&(t=32767),p[u]=t;k(m);A(m,13,K,z,0,ka);p=m;for(u=0;8>u;u++)t=(v[u]>>1)+(n[u]>>1),-32768>t?t=-32768:32767<t&&(t=32767),p[u]=t;k(m);A(m,14,K,z,13,ka);p=m;for(u=0;8>u;u++)t=(v[u]>>2)+(n[u]>>2),-32768>t?t=-32768:32767<t&&(t=32767),t+=n[u]>>1,-32768>t?t=-32768:32767<t&&
(t=32767),p[u]=t;k(m);A(m,13,K,z,27,ka);p=m;for(v=0;8>v;v++)p[v]=n[v];k(m);A(m,120,K,z,40,ka);n=ka;for(v=ka+160;v-- >ka;n++)p=w(V,28180),V=z[n]+p,-32768>V?V=-32768:32767<V&&(V=32767),p=V<<1,-32768>p?p=-32768:32767<p&&(p=32767),z[n]=p}function x(b,d,e,f,m,n,k){f=b[e]+n;-32768>f?f=-32768:32767<f&&(f=32767);f=h(f<<10,m<<1);f=w(k,f);f+=f;-32768>f?f=-32768:32767<f&&(f=32767);d[e]=f}function k(b){for(var d,e=0;8>e;e++)0>b[e]?(d=-32768==b[e]?32767:-b[e],b[e]=-(11059>d?d<<1:20070>d?d+11059:n(d>>2,26112))):
(d=b[e],b[e]=11059>d?d<<1:20070>d?d+11059:n(d>>2,26112))}function A(b,d,e,f,m,n){for(var p,k,q;0!=d;){d--;p=e[m];for(var l=7;0<=l;l--)k=b[l],q=v[l],q=((-32768==k&&-32768==q?32767:65535&k*q+16384>>15)&65535)<<16>>16,p=h(p,q),k=((-32768==k&&-32768==p?32767:65535&k*p+16384>>15)&65535)<<16>>16,k=v[l]+k,-32768>k?k=-32768:32767<k&&(k=32767),v[l+1]=k;f[n+m++]=v[0]=p}}function w(b,d){return-32768==b&&-32768==d?32767:(b*d+16384>>15&65535)<<16>>16}function n(b,d){var e=b+d;return-32768>e?-32768:32767<e?32767:
e}function h(b,d){var e=b-d;return-32768>e?-32768:32767<e?32767:e}function r(b,d){return 16<=d?0>b?-1:0:-16>=d?0:0>d?b<<-d:b>>d}var q=[18431,20479,22527,24575,26623,28671,30719,32767],e=[3277,11469,21299,32767],b=new Int32Array(280),B=[new Int32Array(8),new Int32Array(8)],d=0,C=40,v=new Int32Array(9),V=0,z=new Int32Array(320);z[0]=0;var y=[.1],R=hi5.Arrays.arraycopy,f=hi5.Arrays.fill;this.decode=function(b,d,e){var f=0,h;e=d+e;for(var m=new Int32Array(8),n=new Int32Array(4),k=new Int32Array(4),p=
new Int32Array(4),q=new Int32Array(4),l=new Int32Array(52);d<e;){var a=b[d++]&255;m[0]=a&63;a>>>=6;a|=b[d++]<<2&1023;m[1]=a&63;a>>>=6;a|=b[d++]<<4&4095;m[2]=a&31;a>>>=5;m[3]=a&31;a>>>=5;a|=b[d++]<<2&1023;m[4]=a&15;a>>>=4;m[5]=a&15;a>>>=4;a|=b[d++]<<2&1023;m[6]=a&7;a>>>=3;m[7]=a&7;a>>>=3;a|=b[d++]<<4&4095;n[0]=a&127;a>>>=7;p[0]=a&3;a>>>=2;k[0]=a&3;a>>>=2;a|=b[d++]<<1&511;q[0]=a&63;a>>>=6;l[0]=a&7;a=b[d++]&255;l[1]=a&7;a>>>=3;l[2]=a&7;a>>>=3;a|=b[d++]<<2&1023;l[3]=a&7;a>>>=3;l[4]=a&7;a>>>=3;l[5]=a&
7;a>>>=3;a|=b[d++]<<1&511;l[6]=a&7;a>>>=3;l[7]=a&7;a>>>=3;l[8]=a&7;a=b[d++]&255;l[9]=a&7;a>>>=3;l[10]=a&7;a>>>=3;a|=b[d++]<<2&1023;l[11]=a&7;a>>>=3;l[12]=a&7;a>>>=3;a|=b[d++]<<4&4095;n[1]=a&127;a>>>=7;p[1]=a&3;a>>>=2;k[1]=a&3;a>>>=2;a|=b[d++]<<1&511;q[1]=a&63;a>>>=6;l[13]=a&7;a=b[d++]&255;l[14]=a&7;a>>>=3;l[15]=a&7;a>>>=3;a|=b[d++]<<2&1023;l[16]=a&7;a>>>=3;l[17]=a&7;a>>>=3;l[18]=a&7;a>>>=3;a|=b[d++]<<1&511;l[19]=a&7;a>>>=3;l[20]=a&7;a>>>=3;l[21]=a&7;a=b[d++]&255;l[22]=a&7;a>>>=3;l[23]=a&7;a>>>=3;
a|=b[d++]<<2&1023;l[24]=a&7;a>>>=3;l[25]=a&7;a>>>=3;a|=b[d++]<<4&4095;n[2]=a&127;a>>>=7;p[2]=a&3;a>>>=2;k[2]=a&3;a>>>=2;a|=b[d++]<<1&511;q[2]=a&63;a>>>=6;l[26]=a&7;a=b[d++]&255;l[27]=a&7;a>>>=3;l[28]=a&7;a>>>=3;a|=b[d++]<<2&1023;l[29]=a&7;a>>>=3;l[30]=a&7;a>>>=3;l[31]=a&7;a>>>=3;a|=b[d++]<<1&511;l[32]=a&7;a>>>=3;l[33]=a&7;a>>>=3;l[34]=a&7;a=b[d++]&255;l[35]=a&7;a>>>=3;l[36]=a&7;a>>>=3;a|=b[d++]<<2&1023;l[37]=a&7;a>>>=3;l[38]=a&7;a>>>=3;a|=b[d++]<<4&4095;n[3]=a&127;a>>>=7;p[3]=a&3;a>>>=2;k[3]=a&3;
a>>>=2;a|=b[d++]<<1&511;q[3]=a&63;a>>>=6;l[39]=a&7;a=b[d++]&255;l[40]=a&7;a>>>=3;l[41]=a&7;a>>>=3;a|=b[d++]<<2&1023;l[42]=a&7;a>>>=3;l[43]=a&7;a>>>=3;l[44]=a&7;a>>>=3;a|=b[d++]<<1&511;l[45]=a&7;a>>>=3;l[46]=a&7;a>>>=3;l[47]=a&7;a=b[d++]&255;l[48]=a&7;a>>>=3;l[49]=a&7;a>>>=3;a|=b[d++]<<2&1023;l[50]=a&7;a>>>=3;l[51]=a&7;a>>>=3;u(m,n,k,p,q,l,z,0);a&=15;a|=b[d++]<<4&4095;m[0]=a&63;a>>>=6;m[1]=a&63;a=b[d++]&255;m[2]=a&31;a>>>=5;a|=b[d++]<<3&2047;m[3]=a&31;a>>>=5;m[4]=a&15;a>>>=4;a|=b[d++]<<2&1023;m[5]=
a&15;a>>>=4;m[6]=a&7;a>>>=3;m[7]=a&7;a=b[d++]&255;n[0]=a&127;a>>>=7;a|=b[d++]<<1&511;p[0]=a&3;a>>>=2;k[0]=a&3;a>>>=2;a|=b[d++]<<5&8191;q[0]=a&63;a>>>=6;l[0]=a&7;a>>>=3;l[1]=a&7;a>>>=3;a|=b[d++]<<1&511;l[2]=a&7;a>>>=3;l[3]=a&7;a>>>=3;l[4]=a&7;a=b[d++]&255;l[5]=a&7;a>>>=3;l[6]=a&7;a>>>=3;a|=b[d++]<<2&1023;l[7]=a&7;a>>>=3;l[8]=a&7;a>>>=3;l[9]=a&7;a>>>=3;a|=b[d++]<<1&511;l[10]=a&7;a>>>=3;l[11]=a&7;a>>>=3;l[12]=a&7;a=b[d++]&255;n[1]=a&127;a>>>=7;a|=b[d++]<<1&511;p[1]=a&3;a>>>=2;k[1]=a&3;a>>>=2;a|=b[d++]<<
5&8191;q[1]=a&63;a>>>=6;l[13]=a&7;a>>>=3;l[14]=a&7;a>>>=3;a|=b[d++]<<1&511;l[15]=a&7;a>>>=3;l[16]=a&7;a>>>=3;l[17]=a&7;a=b[d++]&255;l[18]=a&7;a>>>=3;l[19]=a&7;a>>>=3;a|=b[d++]<<2&1023;l[20]=a&7;a>>>=3;l[21]=a&7;a>>>=3;l[22]=a&7;a>>>=3;a|=b[d++]<<1&511;l[23]=a&7;a>>>=3;l[24]=a&7;a>>>=3;l[25]=a&7;a=b[d++]&255;n[2]=a&127;a>>>=7;a|=b[d++]<<1&511;p[2]=a&3;a>>>=2;k[2]=a&3;a>>>=2;a|=b[d++]<<5&8191;q[2]=a&63;a>>>=6;l[26]=a&7;a>>>=3;l[27]=a&7;a>>>=3;a|=b[d++]<<1&511;l[28]=a&7;a>>>=3;l[29]=a&7;a>>>=3;l[30]=
a&7;a=b[d++]&255;l[31]=a&7;a>>>=3;l[32]=a&7;a>>>=3;a|=b[d++]<<2&1023;l[33]=a&7;a>>>=3;l[34]=a&7;a>>>=3;l[35]=a&7;a>>>=3;a|=b[d++]<<1&511;l[36]=a&7;a>>>=3;l[37]=a&7;a>>>=3;l[38]=a&7;a=b[d++]&255;n[3]=a&127;a>>>=7;a|=b[d++]<<1&511;p[3]=a&3;a>>>=2;k[3]=a&3;a>>>=2;a|=b[d++]<<5&8191;q[3]=a&63;a>>>=6;l[39]=a&7;a>>>=3;l[40]=a&7;a>>>=3;a|=b[d++]<<1&511;l[41]=a&7;a>>>=3;l[42]=a&7;a>>>=3;l[43]=a&7;a=b[d++]&255;l[44]=a&7;a>>>=3;l[45]=a&7;a>>>=3;a|=b[d++]<<2&1023;l[46]=a&7;a>>>=3;l[47]=a&7;a>>>=3;l[48]=a&7;a>>>=
3;a|=b[d++]<<1&511;l[49]=a&7;a>>>=3;l[50]=a&7;a>>>=3;l[51]=a&7;u(m,n,k,p,q,l,z,160);a=320*f++;for(h=0;320>h;h++)y[a++]=z[h]/32768}y.length=320*f;return y};var K=new Int32Array(160),l=new Int32Array(40),m=new Int32Array(8)}
function NSCodecBitmap(){var u=new Uint32Array(10240),x=0,k=new Uint8Array(10240),A=0,w=new Uint8Array(10240),n=0,h=new Uint8Array(10240),r=0,q=new Uint8Array(0),e=0;this.getData=function(){return u};this.getDataSize=function(){return x};this.resetData=function(b){u.length<b&&(u=new Uint32Array(b));x=b;return u};this.resetLumaPlane=function(b){k.length<b&&(k=new Uint8Array(b));A=b;return k};this.getLumaPlanceSize=function(){return A};this.resetOrangeChromaPlane=function(b){w.length<b&&(w=new Uint8Array(b));
n=b;return w};this.getOrangeChromaPlane=function(){return n};this.resetGreenChromaPlane=function(b){h.length<b&&(h=new Uint8Array(b));r=b;return h};this.getGreenChromaPlane=function(){return r};this.resetAlphaPlane=function(b){q.length<b&&(q=new Uint8Array(b));e=b;return q};this.getAlphaPlane=function(){return e}}
function NSCodec(){function u(u,w,n,h,r){if(0==n)k(h,0,r,255);else if(n<r){var q=r;for(r=0;4<q;){var e=u[w++];5==q?(h[r++]=e,q--):e==u[w]?(w++,255>(u[w]&255)?(n=u[w++]&255,n+=2):(w++,n=(u[w+3]&255)<<24|(u[w+2]&255)<<16|(u[w+1]&255)<<8|u[w]&255,w+=4),k(h,r,r+n,e),r+=n,q-=n):(h[r++]=e,q--)}for(n=0;4>n;n++)h[r++]=u[w++]}else x(u,w,h,0,r)}var x=hi5.Arrays.arraycopy,k=hi5.Arrays.fill;this.process=function(k,w,n,h,r){w=k.getLittleEndian32();var q=k.getLittleEndian32(),e=k.getLittleEndian32();k.skipPosition(4);
var b=k.getByte(),B=k.getByte();k.skipPosition(2);var d=k.getData(),x=k.getPosition(),v=r.resetData(n*h),A=n+(~(n&7)+1&7),z=h+(~(h&1)+1&1);var y=A*z;var R=r.resetLumaPlane(y),f=r.resetOrangeChromaPlane(y);r=r.resetGreenChromaPlane(y);y=n*h;var z=0<B?(A>>1)*(z>>1):y,K=0<B?z:y;u(d,x,w,R,0<B?A*h:y);x+=w;u(d,x,q,f,z);u(d,x+q,e,r,K);for(var l,m,p,D,S,d=0,x=n+(~(n&7)+1&7),t=b-1,A=0;A<h;A++)for(0<B?(z=A*x,y=(A>>1)*(x>>1),K=(A>>1)*(x>>1)):(z=A*n,y=A*n,K=A*n),b=0;b<n;b++)l=R[z]&255,m=(f[y]&255)<<t<<24>>24,
p=r[K]<<t<<24>>24,D=l+m-p,S=l+p,l=l-m-p,l=0>l?0:255<l?255:l,S=0>S?0:255<S?255:S,D=0>D?0:255<D?255:D,v[d++]=4278190080|l<<16|S<<8|D,z++,y+=0<B?b%2:1,K+=0<B?b%2:1;k.skipPosition(w+q+e)}}
function RfxBitStream(u,x,k){var A=u,w=k,n=0,h=8,r=x;this.attach=function(k,e,b){A=k;w=b;n=0;h=8;r=e};this.getBits=function(k){for(var e,b=0;n<w&&0<k;)e=k,e>h&&(e=h),0!=b&&(b<<=e),b|=A[n+r]>>h-e&(1<<e)-1,h-=e,k-=e,0==h&&(h=8,n++);return b};this.putBits=function(k,e){for(var b=e,q;n<w&&0<b;)q=b,q>h&&(q=h),A[n+r]|=(k>>b-q&(1<<q)-1)<<h-q,h-=q,b-=q,0==h&&(h=8,n++)};this.eos=function(){return n>w};this.left=function(){return n>=w?0:8*(w-n-1)+h};this.getProcessBytes=function(){return 8>h?n+1:n}}
function RemoteFXTile(){this.y=this.x=this.CrLen=this.CbLen=this.YLen=this.quantIdxCr=this.quantIdxCb=this.quantIdxY=0;this.data=new Uint32Array(4096)}
function RemoteFXDecoder(){function u(w,n,h,r,q,e,b){h=w.et;var u=4096,d=w.bitStream;var C=1;var v=C<<3,V=1,z=V<<3,y=0;for(null==d?d=new RfxBitStream(r,q,e):d.attach(r,q,e);!d.eos()&&0<u;)if(0!=C){for(;!d.eos();){q=d.getBits(1);if(0!=q)break;C=r=1<<C;C>u&&(C=u);0<C&&(A(b,y,y+C,0),y+=C);u-=r;v+=4;80<v&&(v=80);0>v&&(v=0);C=v>>3}C=r=C=d.getBits(C);C>u&&(C=u);0<C&&(A(b,y,y+C,0),y+=C);u-=r;C=d.getBits(1);r=0;do if(q=d.getBits(1),1==q)r++;else break;while(1);q=d.getBits(V);q|=r<<V;0==r?(z+=-2,80<z&&(z=
80),0>z&&(z=0),V=z>>3):1!=r&&(z+=r,80<z&&(z=80),0>z&&(z=0),V=z>>3);r=q+1;0<u&&(b[y++]=0!=C?-r:r);u--;v+=-6;80<v&&(v=80);0>v&&(v=0);C=v>>3}else{r=0;do if(q=d.getBits(1),1==q)r++;else break;while(1);q=d.getBits(V);q|=r<<V;0==r?(z+=-2,80<z&&(z=80),0>z&&(z=0),V=z>>3):1!=r&&(z+=r,80<z&&(z=80),0>z&&(z=0),V=z>>3);r=q;if(1!=h){e=r;for(q=0;0!=e;)e>>=1,q++;q=d.getBits(q);r-=q;0!=q&&0!=r?(v+=-6,80<v&&(v=80),0>v&&(v=0),C=v>>3):0==q&&0==r&&(v+=6,80<v&&(v=80),0>v&&(v=0),C=v>>3);0<u&&(b[y++]=0!=(q&1)?-1*(q+1>>1):
q>>1);u--;0<u&&(b[y++]=0!=(r&1)?-1*(r+1>>1):r>>1);u--}else 0==r?(0<u&&(b[y++]=0),u--,v+=3):(0<u&&(b[y++]=0!=(r&1)?-1*(r+1>>1):r>>1),u--,v+=-3),80<v&&(v=80),0>v&&(v=0),C=v>>3}h=64;u=4032;for(d=4033;1<h;u++,d++,h--)b[d]+=b[u];k(b,0,4096,5);k(b,0,1024,n[8]-6);k(b,1024,1024,n[7]-6);k(b,2048,1024,n[9]-6);k(b,3072,256,n[5]-6);k(b,3328,256,n[4]-6);k(b,3584,256,n[6]-6);k(b,3840,64,n[2]-6);k(b,3904,64,n[1]-6);k(b,3968,64,n[3]-6);k(b,4032,64,n[0]-6);w=w.dwtBuffer;x(b,3840,w,8);x(b,3072,w,16);x(b,0,w,32)}function x(k,
n,h,r){var q,e;var b=r<<1;var u=n+r*r*3;var d=n;var w=0;var v=n+r*r;var x=n+r*r*2;var z=r*r*2;for(q=0;q<r;q++){h[w]=k[u]-(k[d]+k[d]+1>>1)<<16>>16;h[z]=k[v]-(k[x]+k[x]+1>>1)<<16>>16;for(e=1;e<r;e++){var y=e<<1;h[w+y]=k[u+e]-(k[d+e-1]+k[d+e]+1>>1)<<16>>16;h[z+y]=k[v+e]-(k[x+e-1]+k[x+e]+1>>1)<<16>>16}for(e=0;e<r-1;e++)y=e<<1,h[w+y+1]=(k[d+e]<<1)+(h[w+y]+h[w+y+2]>>1)<<16>>16,h[z+y+1]=(k[x+e]<<1)+(h[z+y]+h[z+y+2]>>1)<<16>>16;y=e<<1;h[w+y+1]=(k[d+e]<<1)+h[w+y]<<16>>16;h[z+y+1]=(k[x+e]<<1)+h[z+y]<<16>>16;
u+=r;d+=r;w+=b;v+=r;x+=r;z+=b}for(y=0;y<b;y++){for(e=0;e<r;e++)q=e<<1,w=n+q*b+y,z=e*b+y,d=z+r*b,k[w]=h[z]-((0<e?h[d-b]:h[d])+h[d]+1>>1)<<16>>16;for(e=0;e<r;e++)q=e<<1,w=n+q*b+y,z=e*b+y,d=z+r*b,k[w+b]=(h[d]<<1)+(k[w]+k[w+(e<r-1?2*b:0)]>>1)<<16>>16}}function k(k,n,h,r){if(0!=r)for(;0<h;n++,h--)k[n]<<=r}var A=hi5.Arrays.fill;this.decodeRgb=function(k,n,h,r,q,e,b,x,d,A){u(k,h,q,n.getData(),n.getPosition(),r,k.yrBuffer);n.skipPosition(r);u(k,h,b,n.getData(),n.getPosition(),e,k.cbgBuffer);n.skipPosition(e);
u(k,h,d,n.getData(),n.getPosition(),x,k.crbBuffer);n.skipPosition(x);n=k.yrBuffer;h=k.cbgBuffer;r=k.crbBuffer;for(e=0;4096>e;e++)b=n[e],x=h[e],d=r[e],b=b+4096<<16,q=b+91947*d,d=b-22544*x-46792*d,b+=115998*x,q>>=21,d>>=21,b>>=21,n[e]=0>q?0:255<q?255:q,h[e]=0>d?0:255<d?255:d,r[e]=0>b?0:255<b?255:b;n=k.yrBuffer;h=k.cbgBuffer;k=k.crbBuffer;for(r=0;4096>r;r++)A[r]=4278190080|k[r]<<16|h[r]<<8|n[r]}}
function RemoteFXBitmap(u){var x=[new hi5.graphic.Rectangle],k=[new RemoteFXTile],A=0,w=0;this.resetRects=function(k){if(x.length<k){var h=x.length;for(x.length=k;h<k;h++)x[h]=new hi5.graphic.Rectangle}A=k;return x};this.resetTiles=function(n){var h=0;if(u){if(k.length<n)for(h=k.length,k.length=n;h<n;h++)k[h]=new RemoteFXTile}else for(;h<n;h++)k[h]=new RemoteFXTile;w=n;return k};this.getRectSize=function(){return A};this.getTileSize=function(){return w};this.getRects=function(){return x};this.getTiles=
function(){return k}}function RemoteFXContext(){this.ctxId=0;this.tileSize=64;this.qt=this.et=this.xft=this.cct=this.flags=0;this.yrBuffer=new Int32Array(4096);this.cbgBuffer=new Int32Array(4096);this.crbBuffer=new Int32Array(4096);this.dwtBuffer=new Int32Array(4096);var u=this;this.setProperties=function(x){u.flags=x&7;u.cct=x>>3&3;u.xft=x>>5&15;u.et=x>>9&15};this.bitStream=new RfxBitStream};
