var $jscomp=$jscomp||{};$jscomp.scope={};$jscomp.defineProperty="function"==typeof Object.defineProperties?Object.defineProperty:function(m,z,I){m!=Array.prototype&&m!=Object.prototype&&(m[z]=I.value)};$jscomp.getGlobal=function(m){return"undefined"!=typeof window&&window===m?m:"undefined"!=typeof global&&null!=global?global:m};$jscomp.global=$jscomp.getGlobal(this);
$jscomp.polyfill=function(m,z,I,N){if(z){I=$jscomp.global;m=m.split(".");for(N=0;N<m.length-1;N++){var S=m[N];S in I||(I[S]={});I=I[S]}m=m[m.length-1];N=I[m];z=z(N);z!=N&&null!=z&&$jscomp.defineProperty(I,m,{configurable:!0,writable:!0,value:z})}};$jscomp.polyfill("Array.prototype.fill",function(m){return m?m:function(m,I,N){var z=this.length||0;0>I&&(I=Math.max(0,z+I));if(null==N||N>z)N=z;N=Number(N);0>N&&(N=Math.max(0,z+N));for(I=Number(I||0);I<N;I++)this[I]=m;return this}},"es6-impl","es3");
var svManager={getInstance:function(){var m=window.$rdp;return m&&m.running&&m.running()?m:null}};svGlobal.getInstance=svManager.getInstance;
function connvertServer(m){var z={};z.id=m.id;z.server=m.id;z.displayName=m.displayName||m.id;if(m=m.rdp){for(var I in m)z[I]=m[I];z.user=m.username||"";z.pwd=m.password||"";z.useConsole=m.console||!1;z.legacyMode=m.leagacyMode||m.legacyMode||!1;z.server_bpp=m.color||16;z.exe=m.remoteProgram||"";z.args=m.remoteArgs||"";z.startProgram=0<z.exe.length?"app":z.command&&0<z.command.length?"shell":"noapp"}return z}
function Rdp2(m){m=svGlobal.util.getServerArgs(m);if(!m||!m.gateway)return hi5.notifications.notify({msg:__svi18n.noauth}),null;var z=m.gateway||"",I=0,N=0,S=16,Y=1==m.useSSL||"true"==m.useSSL||"on"==m.useSSL||null;m.width&&(I=parseInt(m.width,10));m.height&&(N=parseInt(m.height,10));m.color&&(S=parseInt(m.color,10));m.server_bpp&&(S=parseInt(m.server_bpp,10));m=hi5.browser.obj2url(m);null===Y&&(Y="https:"==location.protocol);return new Rdp((Y?"wss://":"ws://")+z+"/RDP?"+m,I,N,S)}
svGlobal.Rdp2||(svGlobal.Rdp2=Rdp2);
function Rdp(m,z,I,N){var S,Y;function Z(a){return"on"==a||"true"==a||1==a}function pa(){var a=f.gateway;f.ongetgatewayaddress&&(a=f.ongetgatewayaddress(a));return a}function wb(){var a=hi5.storage.get("SV_CONN_SHARE_ID");a||(a=hi5.tool.uuid(),hi5.storage.set("SV_CONN_SHARE_ID",a));return a}function qa(){return k.displayName||k.server||k.symlink||k.id||"undefined"}function Ba(a,b,c){f.ontitlechange&&(a=f.ontitlechange(a,c));f.setTitle&&a&&(b=b||window,b.document.title=a)}function Va(a,b){x?x.resize(a,
b):x=new Wa(a,b);return x}function ra(a,b){switch(a){case 16:case 8:case 24:case 32:break;case 15:return k.invitation||f.showMessage("15 bit color is not supported anymore."),!1;default:return!1}ma=a;b&&(L?L.postMessage({type:0,cmd:1,data:a}):C&&C.setColor(a));return!0}function Xa(){U?(D=(k.waWidth||hi5.browser.getScreenWidth())|0,K=(k.waHeight||hi5.browser.getScreenHeight())|0):(D&=-4,K&=-4);k.minWidth&&D<k.minWidth&&(D=k.minWidth|0);k.minHeight&&K<k.minHeight&&(K=k.minHeight|0)}function ha(a,b,
c,e){D=a;K=b;Ca=Da=0;Ea=D-1;Fa=K-1;Xa();svGlobal.logger.warn("resolution changed, w:"+a+" h:"+b);x=Va(D,K);q.setSize(D,K,U?"hidden":null);c&&(L?L.postMessage({type:0,cmd:2,data:{w:D,h:K}}):C&&C.setResolution(D,K));if(f.onresolutionchange&&!e)f.onresolutionchange(a,b)}function A(a){ba||(L?(Ga.data=a,"string"!=typeof a?L.postMessage(Ga,[a]):L.postMessage(Ga)):C.writeRawInput(a))}function Ya(a){switch(a){case "\r":break;case "\n":f.writeScancode(28);break;case "\t":f.writeScancode(15);break;default:A("86"+
a)}}function Ha(a){if(f){var b=__svi18n.errorCode[a];b||(b="error "+a);if(f.onerror)f.onerror({name:a,message:b});f.displayMsg&&hi5.notifications.notify({msg:b});0<svGlobal.log&&console.error&&console.error(b)}}function Ia(a){if(f){var b=__svi18n.info[a];b||(b="info "+a);f.displayMsg&&hi5.notifications.notify({msg:b});svGlobal.logger.info(b)}}function Ja(){ia=J=!1;L?L.postMessage({type:0,cmd:3}):C&&C.resetStatus()}function xb(){var a=q.getFocused(),a=a?a.getWindow():window;return"&waWidth="+k.waWidth+
"&waHeight="+k.waHeight+"&dpWidth="+a.innerWidth+"&dpHeight="+a.innerHeight}function yb(a){var b={},c=0,e=a;this.enabled=!0;hi5.EventControl(this);var d=this,g=null,h=0,y=!0,E=!0;this.setDownload=function(a){y=a};this.setUpload=function(a){E=a};this.release=function(){b=e=a=d=null};this.read=function(g,h,e){var l=b[b[g]];if("undefined"!=typeof l){var p=l.name;if(1>l.size)f.showMessage(__svi18n.file.zero+p,null,3E3);else{var p=l.slice(h,h+e),r=new FileReader;r.onloadend=function(b){b.target.readyState==
FileReader.DONE&&(b=new Uint8Array(b.target.result),a.send(g,h,e,b,l.preferPaste),c+=e,d.fireEvent("progress",[c]))};r.readAsArrayBuffer(p)}}};this.mkdirs=function(b){d.enabled&&("/"!=b.charAt(b.length-1)&&(b+="/"),a.start([b],0,!0))};this.addFiles=function(c,g){var e=c.length;if(e&&d.enabled&&E){var l=g&&!!(X&65536);h=Date.now();for(var p=0;p<e;p++){var r=c[p];g&&(r.preferPaste=!0);var y=r.fullPath||r.name;if(f.beforeupload&&f.beforeupload(r,y,l))return;d.fireEvent("beforeupload",[r,y,l]);y=encodeURIComponent(y);
b[y]=r}a.start(c,g);d.fireEvent("uploadstarted",[l])}};this.removeFile=function(a){e.remove(a)};this.confirmId=function(a,d,g){b[a]=d;g&&(c+=parseInt(g))};this.close=function(a){var g=!0,e={size:c,duration:Date.now()-h};if(a){var l=b[a];if(l){g=b[l].preferPaste;delete b[a];delete b[l];a=decodeURIComponent(l);if(f.onfileuploaded)f.onfileuploaded(a,g,e);d.fireEvent("fileuploaded",[a,g&&!!(X&65536),e])}for(var y in b)return}else b={};h=c=0;d.fireEvent("uploaded",[g&&!!(X&65536),e]);if(f.onuploaded)f.onuploaded(g&&
!!(X&65536),e)};this.cancelAll=function(){e.cancelAll();if(f.onuploadingCancelled)f.onuploadingCancelled();d.fireEvent("uploadingCancelled");d.close()};this.list=function(a,b){g=b;e.list(a)};this.notifyFiles=function(a){g&&g(a);d.fireEvent("files")};this.download=function(){y&&e.download()}}function zb(){function a(a,c){var b=c.length,d=new Uint8Array(2+2*b);d[0]=58;d[1]=a;for(var g,h=2,f=0;f<b;f++)g=c.charCodeAt(f),d[h++]=g&255,d[h++]=g>>8&255;A(d.buffer)}this.start=function(a,c,e){for(var b=a.length,
g=20*b+2,h=0,f=new Uint8Array(8),E=2,p,r,m;h<b;h++)g=e?g+2*(encodeURIComponent(a[h]).length+1):g+2*(encodeURIComponent(a[h].fullPath||a[h].name).length+1);g=new Uint8Array(g);g[0]=58;g[1]=0;c&&(g[1]|=128);for(h=0;h<b;h++){c=e?0:a[h].size;g[E++]=c&255;g[E++]=c>>8&255;g[E++]=c>>16&255;g[E++]=c>>24&255;4294967296>c?E+=4:(c=hi5.NumUtils.splitInt64(c).high,g[E++]=c&255,g[E++]=c>>8&255,g[E++]=c>>16&255,g[E++]=c>>24&255);e||hi5.NumUtils.toBytes(a[h].lastModified||a[h].lastModifiedDate.getTime(),f);g.set(f,
E);E+=12;c=encodeURIComponent(e?a[h]:a[h].fullPath||a[h].name);p=c.length;for(r=0;r<p;r++)m=c.charCodeAt(r),g[E++]=m&255,g[E++]=m>>8&255;E+=2}A(g.buffer)};this.send=function(a,c,e,d,g){var b=new Uint8Array(22+e);b[0]=58;b[1]=3;g&&(b[1]|=128);g=2;b[g++]=a&255;b[g++]=a>>8&255;b[g++]=a>>16&255;b[g++]=a>>24&255;b[g++]=c&255;b[g++]=c>>8&255;b[g++]=c>>16&255;b[g++]=c>>24&255;4294967296>c?g+=4:(c=hi5.NumUtils.splitInt64(c).high,b[g++]=c&255,b[g++]=c>>8&255,b[g++]=c>>16&255,b[g++]=c>>24&255);b[g++]=e&255;
b[g++]=e>>8&255;b[g++]=e>>16&255;b[g++]=e>>24&255;b.set(d,g+4);A(b.buffer)};this.remove=function(b){a(6,b)};this.list=function(b){a(5,b)};this.cancelAll=function(){a(7,"")};this.download=function(){a(136,"")}}function Za(a){R||(R=new yb(new zb));a.setFileHandler(R)}function $a(a,b,c){var e=!1;this.exe=a;this.args=b||"";this._dir=c||"";var d=this;this.close=function(){!e&&J&&(e=!0,A("8C5"+d.exe+"\t"+d.args+"\t"+f.sessionInfo.appInfo.session))}}function Ka(a){var b=this;a||(a=143);this.send=function(c){var e=
!!c.buffer,d=e?c:c.getData(),g=64==a;c=e?d.length:c.getEnd()||d.length;c<d.length&&(d=e?d.subarray(0,c):d.slice(0,c));e=g?5:9;c=new Uint8Array(e+c);c[0]=a;if(g)c[1]=b.id,c[2]=b.id>>8,c[3]=b.id>>16,c[4]=b.id>>24;else for(var g=b.name,h=Math.min(g.length,8),f=0;f<h;f++)c[1+f]=g.charCodeAt(f);c.set(d,e);A(c.buffer)};this.name="";this.count=this.id=this.flags=0}function Ab(){var a=window.opener;if(a)try{if(a.__sparkUser&&a.__sparkUser.session)return a.__sparkUser;if(a.opener&&a.opener.__sparkUser.session)return a.opener.__sparkUser}catch(b){}return null}
function ab(){var a="";k&&Z(k.connectif)&&k.symlink&&"sessionStorage"in window&&(a="SV_"+k.symlink,k.domain&&(a+=k.domain),k.user&&(a+=k.user));return a}function Bb(){var a=ab(),b="";a&&(b=sessionStorage[a]||"")&&(b="&preSymJoin="+b);return b}function Cb(a,b){var c=0,e=q.size(),d=Array(e),g=Array(e),h=0,y=0,E=0,p=0,r=0,m=0,l="";if(a){g=x.parseMonitorDef(a);for(e=g.length;c<e;c++){var u=g[c];u[0]<E&&(E=u[0]);u[1]<p&&(p=u[1]);u[2]>r&&(r=u[2]);u[3]>m&&(m=u[3])}0>E&&(h=-E);0>p&&(y=-p);u=0>b?[E,p,r,m]:
g[b];k.width=u[2]-u[0]+1;k.height=u[3]-u[1]+1;c=q.getSurface(0);c.setMonitor(u[0],u[1],u[2],u[3]);if(h||y)for(u=c.getMousePosition(),u.left+=h,u.right+=h,u.top+=y,u.bottom+=y,c=0;c<e;c++)u=g[c],u[0]+=h,u[1]+=y,u[2]+=h,u[3]+=y;x.setMonitorLayout(g);0>b&&x.setMonitorCount(0);f.reconnectOnResize=!1;return"&monitorDef="+a+"&width="+k.width+"&height="+k.height}if(1<e&&!U){for(q.verifyMonitors();c<e;c++)u=q.getSurface(c),u=u.getMousePosition(),u.left<E&&(E=u.left),u.top<p&&(p=u.top),u.right>r&&(r=u.right),
u.bottom>m&&(m=u.bottom),d[c]=u,l&&(l+=","),l+=u.left+":"+u.top+":"+u.right+":"+u.bottom;0>E&&(h=-E);0>p&&(y=-p);for(c=0;c<e;c++){u=q.getSurface(c).getMousePosition();if(h||y)u.left+=h,u.right+=h,u.top+=y,u.bottom+=y;g[c]=[u.left,u.top,u.right,u.bottom,u.left==h&&u.top==y?1:0]}x.setMonitorLayout(g);f.reconnectOnResize=!1}l&&(svGlobal.logger.warn("MonitorDef:"+l),k.width=r-E+1,k.height=m-p+1,l="&monitorDef="+l+"&width="+k.width+"&height="+k.height);return l}function bb(){if(!J){ia=!1;U&&ha(D,K,!1,
!1);var a="";if(ba)G.init(!1,!0,!1,0);else{a=m+"&width="+D+"&height="+K+"&server_bpp="+ma+"&audio="+(F.available||La)+Bb()+Cb(k.monitorDef,k.monitor);0>m.indexOf("waWidth")&&(a+=xb());var b=new Date;k.tzOffset||(a+="&tzOffset="+b.getTimezoneOffset());a+="&time="+b.getTime();void 0==k.soundPref&&(k.soundPref=0,a+="&soundPref=0");var c="",e="";b="";for(b in ea){var d=ea[b];"flags"in d&&(c&&(c+=",",e+=","),c+=d.name,e+=d.flags)}c&&(a=a+("&channelName="+c)+("&channelFlags="+e));c="";for(b in fa)d=fa[b],
"flags"in d&&(c&&(c+=","),c+=d.name);c&&(a+="&gwChannelName="+c);if(d=Ab())b=d.account,d=d.session,b&&(a+="&account="+b),d&&(a+="&session="+d);b=hi5.browser.isTouch&&(1024<=window.innerWidth||768<=window.innerHeight);k.audioRecord=Z(k.audioRecord)&&hi5.audio.recordable;G.init(b,!!k.remotefx,k.audioRecord,k.soundPref);k.audioRecord&&(a+="&audioRecord=on");k.decompressingRDP61&&(a+="&decompressingRDP61=on");0<G.count&&(a+="&dvcChannels="+G.names.join(","));hi5.browser.binaryWS()&&(a+="&binary=on");
t.existingFile&&(a+="&existingFile="+t.existingFile);a+="&isTouch="+b+"&gatewayAddr="+encodeURIComponent(pa());a=f.modifyURL(a);t.copyTextOnly&&Z(k.mapClipboard)&&(a+="&copyTextOnly=on");(b=hi5.browser.cookie.get("__SV_TOKEN_A"))&&(a+="&__SV_TOKEN_A="+encodeURIComponent(b));(b=svGlobal.Rdp.languageToKeyboard.detect())&&(a+="&_keyboard="+b);m=a}b=!0===t.updateFix;void 0==t.wsPost&&(t.wsPost=!1);L?(ba&&(ba.onopen=Ma,ba.onclose=sa,ba.onmessage=function(a){Na.data=a.data;L.postMessage(Na,[Na.data])}),
L.postMessage({type:0,cmd:0,data:{addr:a,width:D,height:K,server_bpp:ma,libPath:hi5.libPath,libMin:hi5.libMin,updateFix:b,wsPost:t.wsPost}})):(C=new RdpGeneral(ba||a,D,K,ma,x,!1,t.wsPost),b&&C.enableUpdateFix(),C.run());svGlobal.logger.info(m);L?L.addEventListener("message",cb,!1):(C.onopen=Ma,C.onmessage=db,C.onclose=sa,C.onerror=Ha,C.oninfo=Ia,C.onloggedin=eb,C.onresolutionchange=function(a,b){ha(a,b,!1,k.monitorDef&&0<=k.monitor?!0:!1)},C.onAltSecWindows=fb,C.onMoveCursor=Oa,C.onCloseSurface=gb,
C.onColorChange=ra,C.onHistoryReceived=function(){Pa()},C.onLockKeyState=function(a){if(f.onLockKeyState)f.onLockKeyState(a)});if(a=q.getSurface(q.size()-1))U?a&&(a.remoteApp=new $a(k.exe,k.args,"")):Ba(qa(),a.getWindow());if(k.invitation){var g=null;a&&(g=a.initChat(k.expert));ta=new f.GatewayChannel;ta.name="C_H_A_T";ta.process=function(a){a=a.getUnicodeString(a.getEnd()-a.getPosition(),!0);g&&g.add(a,k.novice)};g&&(g.onchat=function(a){if(J){var b=Array(2*a.length),b=new hi5.DataBuffer(b,0,b.length);
b.setUnicodeString(a);b.markEnd();ta.send(b)}});f.addGatewayChannel(ta)}hi5.browser.isIE&&!ua&&(ua=hi5.browser.loadFlash(t.flash||hi5.libPath+"plugin.swf"))&&(hb=!0)}}function cb(a){a=a.data;switch(a.type){case 1:switch(a.event){case 0:Ma();break;case 1:sa(a.expected);break;case 2:Ha(a.code);break;case 3:Ia(a.code);break;case 4:eb();break;case 5:ha(a.w,a.h,!1,k.monitorDef&&0<=k.monitor?!0:!1);break;case 6:Oa(a.x,a.y,!0);break;case 7:gb();break;case 8:0==a.id&&Pa();O&&O.check(1<a.id?15555:0);break;
case 9:ra(a.color);break;case 10:if(f.onLockKeyState)f.onLockKeyState(a.state);break;default:svGlobal.logger.warn("Invalid worker event "+a.type)}break;case 2:x.setRGBs(a.x,a.y,a.w,a.h,a.pixel,a.offset,a.scansize);break;case 3:x.moveArea(a.srcx,a.srcy,a.cx,a.cy,a.dx,a.dy);break;case 5:x.fillRect(a.l,a.t,a.w,a.h,a.color);break;case 6:x.drawLine(a.x1,a.y1,a.x2,a.y2,a.color);break;case 7:x.bitBlt(a.opcode,a.dstwidth,a.x,a.y,a.cx,a.cy,a.src,a.srcwidth,a.srcx,a.srcy);break;case 8:x.drawLineExt(a.x1,a.y1,
a.x2,a.y2,a.color,a.opcode);break;case 9:ib(a);break;case 10:db(a);break;case 11:P.attach(a.data,0,a.data.length);fb(P,a.size);break;case 12:x.drawText(a.font,a.flags,a.mixmode,a.foregroundColor,a.backgroundColor,a.clipLeft,a.clipTop,a.clipcx,a.clipcy,a.boxLeft,a.boxTop,a.boxcx,a.boxcy,a.x,a.y,a.length,a.text,a._left,a._top,a._right,a._bottom);break;case 13:x.drawBitmap(a.cacheID,a.cacheIDX,a.x,a.y,a.cx,a.cy,a.srcx,a.srcy,a.opcode);break;case 14:x.saveDesktop(a.x,a.y,a.cx,a.cy,a.offset);break;case 15:x.restoreDesktop(a.x,
a.y,a.cx,a.cy,a.offset);break;case 16:x.putFont(a.font,a.character,a.glyph);break;case 17:x.putCursor(a.idx,a.cursor);break;case 18:x.setCursor(a.idx);break;case 19:x.getHistory(A,function(){L.postMessage({type:0,cmd:7})});O&&O.check(15555);break;case 20:P.attach(a.data,a.off,a.data.length-a.off);x.setHistory(a.order,P);break;case 21:x.putBitmap(a.id,a.idx,a.bitmap);break;default:svGlobal.logger.warn("Invalid worker msg "+a.type)}}function jb(a){O&&O.check(a)}function Ma(){J=!0;if(f.onopen)f.onopen();
t.joinCloseMode&&f.setJoinCloseMode(t.joinCloseMode)}function gb(){q&&q.close()}function db(a){var b=a.data;if("string"!=typeof b){a=new Uint8Array(b);P.attach(a,0,b.byteLength);var c=P.getLittleEndian16();switch(c){case 28:a=P;b=a.getAscllString(8);c=fa[b];null!=c?c.process(a):svGlobal.logger.warn("Channel "+b+" not found");break;case 55:a=P;switch(a.getByte()){case 0:S=a.getLittleEndian16();Y=a.getLittleEndian16();ka=a.getLittleEndian32();a.skipPosition(6);la=a.getLittleEndian16();svGlobal.logger.info("Audio Format, tag="+
S+" channels="+Y+" bitsPerSample="+la+" samplePerSec="+ka);kb();break;case 1:Db(a)}O&&O.check();break;case 56:lb(P.getUnicodeString(P.getEnd()-P.getPosition(),!1));break;case 60:mb(P);break;case 62:nb(P.getUnicodeString(P.getEnd()-P.getPosition(),!1));break;case 63:ob(P);O&&O.check();break;case 64:b=P;c=b.getByte();a=b.getLittleEndian32();switch(c){case 1:b=b.getAscllString();if(G[b]&&(G[b].id=a,svGlobal.logger.info("DVC create, name:"+b+" id:"+a),G[a]=G[b],G[a].onopen))G[a].onopen();break;case 3:G[a]&&
G[a].process(b);break;case 4:if(G[a]&&G[a].onclose)G[a].onclose();svGlobal.logger.info("close DVC, id:"+a)}O&&O.check();break;case 146:b=P;switch(b.getByte()){case 0:a=new Uint8Array(2);a[0]=146;a[1]=1;A(a.buffer);break;case 5:a=b.getByte();b=b.getLittleEndian32();0!=a||b&4||(X^=65536,q.execute("setFeature",[X]));break;case 6:Q.remoteLockFlags=b.getLittleEndian32();Q.checkLockFlags=!0;if(f.onLockKeyState)f.onLockKeyState({capsLock:0!=(Q.remoteLockFlags&4),numLock:0!=(Q.remoteLockFlags&2),scrollLock:0!=
(Q.remoteLockFlags&1)},{capsLock:0!=(Q.localLockFlags&4),numLock:0!=(Q.localLockFlags&2),scrollLock:0!=(Q.localLockFlags&1)});svGlobal.logger.info("remoteLockFlags: "+Q.remoteLockFlags)}break;default:if(f.onunknownmessage)f.onunknownmessage(c,P);else svGlobal.logger.warn("@TODO:"+c+"\n")}}else switch(c=parseInt(b.substring(0,2),16),a=b.substring(2),c){case 0:a=m.substring(m.indexOf("?")+1);A("00"+a);A("87"+navigator.userAgent);break;case 15:if(f){Qa=!1;na=f.reconnectTimes;(f&&0==f.mode||Z(k.connectif))&&
Pa();c="";for(c in ea)if((b=ea[c])&&b.onopen)b.onopen();for(c in fa)if((b=fa[c])&&b.onopen)b.onopen();a&&(a=JSON.parse(a),a.capability&&f&&(f.sessionInfo.suppressOutput=a.capability.suppressOutput))}break;case 26:b=JSON.parse(a);if(f.onnotify)f.onnotify(b);if(b.name){svGlobal.logger.info("msg="+a);if(b.type&&f.onerror)f.onerror(b);a=__svi18n.errorCode["S"+b.name]||"";a+=b.message;f.showMessage(a,null)}else 0<svGlobal.log&&console.erro("No error code for message:"+a);break;case 27:q.drawLicense(a);
break;case 50:if(J)switch(b=parseInt(a.substring(0,1),10),a=a.substring(1),b){case 1:Eb(a);break;case 2:va?(va.type==a?f.writeRawInput("881"+a+"\t"+va.text):f.writeRawInput("881ERROR\t"),va=null):!(b=q.getFocused())||b.processClipReq(a)||!t.clipWarnAlways&&pb||!k||k.leagacyMode||(f.showMessage(__svi18n.info.menucopy,null,5E3),pb=!0);break;case 5:(b=q.getFocused())&&"0"!=a&&b.setIgnorePaste(!0)}break;case 51:q.setReadOnly("1"==a);break;case 54:b=a.split("\t");a=pa()+b[0];a=f.modifyURL(a);svGlobal.logger.info("Downloading file:"+
a+" name:"+b[1]+" driver:"+b[2]);f.onprintingready&&f.onprintingready({link:a,printerName:b[1],pinterDriver:b[2]})||(b=q.getFocused())&&b.showPDF(a);break;case 55:b=parseInt(a.substring(0,1),16);a=a.substring(1);switch(b){case 0:a=a.split("\t");S=parseInt(a[0],10);Y=parseInt(a[1],10);la=parseInt(a[2],10);ka=parseInt(a[3],10);svGlobal.logger.debug("Audio Format, tag="+S+" channels="+Y+" bitsPerSample="+la+" samplePerSec="+ka);kb();break;case 1:Fb(a)}break;case 56:lb(a);break;case 57:b=a.split("\t");
svGlobal.logger.debug(a);if(a=q.getWinById(parseInt(b[0]))){if(!q.hasApp(b[1])){(c=q.getOwnerSurface(a))&&c.railWin&&(c.railWin.appId=b[1],c.railWin.addApp(b[1]));if(f.onremoteappstart)f.onremoteappstart({id:b[1]});if(a.isVisible()&&a.titleInfo&&f.ontitlechange)f.ontitlechange(c.railWin.getFullTitle(a.id),b[1])}a.appId=b[1]}break;case 58:b=a;if(R)if(a=parseInt(b.charAt(0),10),b=b.substring(1),5==a)R.notifyFiles(JSON.parse(b));else switch(b=b.split("\t"),a){case 1:R.confirmId(b[0],b[1],b[2]);break;
case 2:R.read(b[0],parseInt(b[1],10),parseInt(b[2],10));break;case 4:R.close(b[0]);break;case 9:a='<a href="'+b[0]+'" download="'+b[1]+'" target="_blank">'+__svi18n.info.fileReady+"</a>",q.getFocused().showMessage({msg:a,title:__svi18n.info.download})}break;case 59:a=hi5.Base64.dec(a,0);X=(new RdpBuffer(a,0,a.length)).getLittleEndian32();if(ga||!(X&16||X&65536))Ra=!1,R=null;X&64&&f.showMessage(__svi18n.info.recording);R&&(R.setUpload(!(X&128)),R.setDownload(!(X&131072)));q.execute("setFeature",[X]);
break;case 60:mb(b64ToBuffer(a));break;case 61:a=JSON.parse(a);switch(a.type){case 0:ha(a.width,a.height,!0,!1);ra(a.color);(b=a.server)&&f&&(f.server=a.server);qb=a.length;c=q.getFocused();U=1==a.isRail;c&&(c.setAutoScale(!U),b&&Ba(qa(),c.getWindow()),b=a.keyboard,"undefined"!=typeof b&&0==b&&c.setUnicode(!0),b=a.mapDisk)&&(Ra=!0,Za(c));if(f.onopened)f.onopened(a);break;case 1:a=a.duration;if(f.onprogress)f.onprogress(a,qb);break;case 2:2==a.status?(Ja(),J=!0):(b=0==a.status,b==x.isPaused()||f.onsessionpause&&
f.onsessionpause(b,a)||(x.pause(b),b||q.repaint(0,0,x.width-1,x.height-1),a.warn&&f.showMessage(b?__svi18n.info.sessionPaused:__svi18n.info.sessionResumed)))}break;case 62:nb(a);break;case 63:ob(b64ToBuffer(a));break;default:if(f.onunknownmessage)f.onunknownmessage(c,a);else svGlobal.logger.warn("@TODO:"+b+"\n")}}function Pa(){if(!ga&&!V&&(V=!0,f&&(t.pingInterval&&f.startPing(t.pingInterval),f.onready)))f.onready()}function Gb(a,b){var c=0,e=!1;this.width=a;this.interval=b;var d=0;this.start=function(){e||
(e=!0,c=setInterval(function(){var b=q.getFocused();b&&J&&(b=b.getThumbnail(a))&&b.length!=d&&(A("8E7"+b),d=b.length)},b))};this.stop=function(){clearInterval(c)}}function Hb(a,b){!W||W.width==a&&W.interval==b||(W.stop(),W=null);W||(W=new Gb(a,b));W.start()}function ob(a){var b=a.getAscllString(8);(b=ea[b])&&b.process&&b.process(a)}function nb(a){var b=parseInt(a.substring(0,1),16),c=a.substring(1);a=!1;var e=f.sessionInfo.appInfo;switch(b){case 0:var d=JSON.parse(c);Ja();J=!0;a=d.width;b=d.height;
if(a==D&&b==K)break;ha(a,b,!1,!1);break;case 1:d=JSON.parse(c);f.sessionInfo.joinedSessions.push(d.numericId);e.sessions[d.numericId]=d.name||d.__ip;if(!e.joined||t.alertJoin)f.onsessionjoin&&(a=f.onsessionjoin(d)),a||f.showMessage(__svi18n.info.joinsession.applyArgs([d.numericId,d.__ip,d.name]));break;case 2:d=JSON.parse(c);f.sessionInfo.joinedSessions.removeElm(d.numericId);delete e.sessions[d.numericId];if(!e.joined||t.alertJoin)f.onsessionexit&&(a=f.onsessionexit(d)),a||f.showMessage(__svi18n.info.exitsession.applyArgs([d.numericId,
d.__ip,d.name]));break;case 3:d=JSON.parse(c);e.joinMode!=d.mode&&(e.joinMode=d.mode,b=hi5.$("joinSelect"))&&(b.value=d.mode);if(e.hasControl)break;e.hasControl=!0;q.setReadOnly(!1,2==d.mode);if(b=hi5.$("requestControl"))b.disabled=!0;f.ongivecontrol&&(a=f.ongivecontrol());if(a)break;f.showMessage(__svi18n.info.givecontrol,null,5E3);break;case 4:d=JSON.parse(c);q.setReadOnly(!0,2==d.mode);e.hasControl=!1;if(b=hi5.$("requestControl"))b.disabled=!1;f.ontakebackcontrol&&(a=f.ontakebackcontrol());if(a)break;
f.showMessage(__svi18n.info.nocontrol,null,5E3);break;case 5:d=JSON.parse(c);f.onrequirecontrol&&(a=f.onrequirecontrol(d));if(a)break;a=__svi18n.info.title.applyArgs([d.name,d.numericId,d.__ip]);b=__svi18n.info.recontrol;x.isPaused&&(b+="<br><br>"+(__svi18n.info.autoresume||""));hi5.notifications.notify({title:a,msg:b,cbYes:function(){f.giveControl(d.numericId);this.destroy();x.isPaused()&&f.pauseSession(f.sessionInfo.appInfo.numericId,!1)},cbNo:function(){f.refuseControl(d.numericId);this.destroy()}});
break;case 6:q.execute("setTouchRemoting",[!0]);break;case 7:d=JSON.parse(c);d.width&&d.height&&ha(d.width,d.height,!0,k.monitorDef&&0<=k.monitor?!0:!1);d.color&&(ra(d.color,!0),svGlobal.logger.warn("Color depth changed to:"+d.color));d.version&&(f.sessionInfo.protocolVersion=d.version);break;case 8:d=JSON.parse(c);Qa=!0;if(f.onrequestcredential&&f.onrequestcredential(d,Q.reconnect))break;if(f.onautherror&&f.onautherror(d,Q.reconnect))break;q.getFocused().requestCredential(d,Q.reconnect);break;case 9:d=
JSON.parse(c);0<d.interval&&0<d.width?Hb(d.width,d.interval):W&&(W.stop(),W=null);break;case 11:d=JSON.parse(c),f.onrequirejoin&&(a=f.onrequirejoin(d)),a||(a=__svi18n.info.title.applyArgs([d.name,d.numericId,d.__ip]),hi5.notifications.notify({title:a,msg:__svi18n.info.reqjoin,cbYes:function(){f.allowJoin(d.numericId,!0);this.destroy()},cbNo:function(){f.allowJoin(d.numericId,!1);this.destroy()}}))}}function mb(a){switch(a.getByte()){case 32:if(!x.isPaused()){var b=a.getLittleEndian16(),c=a.getLittleEndian16(),
e=a.getLittleEndian16(),d=void 0,g=void 0;t.noCursorName||(d=a.getLittleEndian32(),f.sessionInfo.appInfo&&(g=f.sessionInfo.appInfo.sessions[d]));Oa(c,e,!0,g,d,b)}}}function Oa(a,b,c,e,d,g){x.isPaused()||q.getFocused().moveCursor(a,b,c,e,d,g)}function ib(a){q.setCursor(a)}function lb(a){a=JSON.parse(a);rb=a.session;a.server||(a.server=qa());var b=hi5.$("joinSelect");b&&(b.value=a.joinMode);if(b=hi5.$("requestControl"))b.disabled=a.hasControl;a.joined?q.execute("setAutoScale",[!0]):(f.mode=0,Z(k.connectif)&&
q.setSize(D,K),t.disableJoinedAppResize&&(f.windowState=0));var b=t.page&&t.page.join||"join.html",c=pa(),b=c+"/"+b+"?id="+(a.joined||a.numericId),e=a.webAddress;e&&0<e.length&&e.toLowerCase()!=c.toLowerCase()&&(c=e.indexOf("://"),f.protocol="http"==e.substring(0,c)?"ws":"wss",f.gateway=e,b+="&gateway="+encodeURIComponent(e));b=f.modifyURL(b);a.joinLink=b;f.sessionInfo.appInfo=a;"isApp"in a&&U!==a.isApp&&(U=a.isApp,Xa(),q.setSize(D,K,U?"hidden":null),x=Va(D,K),ia||q.execute("setAutoScale",[!0]));
a.ver&&a.ver!=svGlobal.version&&svGlobal.logger.warn("Client:"+svGlobal.version+" server:"+a.ver);t.cursorNameOnly=a.isAssistance;if(f.onsessionstart)f.onsessionstart(f.sessionInfo)}function Fb(a){function b(a){var b=0;a*=g;for(h=0;h<g;h++)b|=(d[a+h]&255)<<8*h;b>f?(b-=p,b/=-m):b/=f;return b}if(F.available&&!x.isPaused()){var c=a.indexOf("\t"),e=a.substring(0,c),d=hi5.Base64.dec(a,c+1);1!=S&&(oa||(oa=new MSGSM),d=oa.decode(d,0,d.length));a=la;var g=a>>3,h=0,f=Math.pow(2,a-1)-1,m=-f-1,p=Math.pow(2,
a);a=0;var c=Y,r=Math.floor(Math.floor(d.length/g)/c),k=F.getBuffer(r),l=k.getChannelData(0),u=k.getChannelData(1);for(a=0;a<r;){var q=2*a,M=b(q);1==c?(l[a]=M,u[a]=M):(l[a]=M,u[a]=b(q+1));a++}a=F.playBuffer(k);setTimeout(function(a){return function(){A("8A"+a)}}(e),1E3*(a-F.delay))}}function Db(a){function b(a){return function(){A("8A"+a)}}var c=a.getByte(),e=a.getLittleEndian16(),d=Date.now();a.skipPosition(8);a=Ib(a,c,e,0);a=1E3*(a-F.delay);ga||(e+=Date.now()-d+a,setTimeout(b(c+","+e),a))}function Ib(a,
b,c,e){if(hb&&!x.isPaused()){var d=c=0,g=a.getPosition();b=a.getData();e||(e=a.getEnd()-g);var h=e;if(41222==S)(c=F.getContext())&&c.decodeAudioData(b.buffer.slice(g),function(a){a=F.playBuffer(a);ga||setTimeout(sendLater(Ia),1E3*(a-F.delay))},function(a){svGlobal.logger.warn(a)});else{if(d=1!=S)oa||(oa=new MSGSM),b=oa.decode(b,g,h),g=0,h=b.length;var f=la,m=f>>3,p=Math.floor(h/m),r=a=0,k=0;d||(a=Math.pow(2,f-1)-1,r=-a-1,k=Math.pow(2,f));f=Y;if(ua){g="";if(d){for(;c<h;c++)0<c&&(g+=","),g+=b[c]+","+
b[c]+","+b[c]+","+b[c];ua.write(g);return e/65*.025}for(;c<h;)0<c&&(g+=","),d=b[c++]|b[c++]<<8,9>d?d=0:d>a?(d-=k,d/=-r):d/=a,g+=d,1==f&&(g+=","+d);ua.write(g);return e/m/ka*.6}e=g;g=Math.floor(p/f);h=F.getBuffer(g);m=h.getChannelData(0);p=h.getChannelData(1);c=0;if(d)for(;c<g;)1==f?p[c]=m[c]=b[e++]:(m[c]=b[e++],p[c]=b[e++]),c++;else for(;c<g;)d=b[e++]|b[e++]<<8,d>a?(d-=k,d/=-r):d/=a,1==f?m[c]=d:(m[c]=d,d=b[e++]|b[e++]<<8,d>a?(d-=k,d/=-r):d/=a),p[c]=d,c++;return F.playBuffer(h)}}}function kb(){L&&
L.postMessage({type:0,cmd:5,data:{tag:S,channels:Y,samplePerSec:ka,bitsPerSample:la}})}function Jb(a){if(!f.openLink||2E3<a.length)return!1;var b=a.indexOf(";");0<b&&(a=a.substring(b+1));b=a;a=a.toLowerCase();var c=0==a.indexOf("http://")||0==a.indexOf("https://")||0==a.indexOf("ftp://")||0==a.indexOf("mailto:")||0==a.indexOf("tel:")||0==a.indexOf("callto:");c||(0==a.indexOf("www.")?(c=!0,a="http://"+a):0==a.indexOf("ftp.")&&(c=!0,a="ftp://"+a));if(c){if(0<a.indexOf("\r")||0<a.indexOf("\n"))return!1;
if(f.onurlredirection&&f.onurlredirection(c))return!0;a=q.getFocused();if(!a)return!1;a.processLink(b);return!0}return!1}function Eb(a){"text/plain;"!=a&&(!(1666<Date.now()-Q.reqCopyTime)||f.onservercopy&&f.onservercopy(a)||(Jb(a),q.copyToClip(a)),setTimeout(function(){A("883")},999))}function eb(){if(!ia&&(setTimeout(function(){J&&A("884")},333),f.onloggedin))f.onloggedin();Sa=ia=!0;U&&q.execute("setAutoScale",[!1]);R&&(R.enabled=!0);za&&!U&&(x.setContext(q.getFocused().context),q.repaint(0,0,x.width-
1,x.height-1))}function sa(a){if(f){svGlobal.logger.warn("closed "+(f.sessionInfo.appInfo?f.sessionInfo.appInfo.numericId:0));var b=ab();b&&f.sessionInfo.appInfo&&0==f.mode&&(sessionStorage[b]=f.sessionInfo.appInfo.session);if(f&&(b=0==f.mode,!J&&b&&Ha("connection"),b=b&&(J||na<f.reconnectTimes)&&0<na&&!a,V=J=!1,b)){na--;f.showMessage(__svi18n.info.reconnecting+" "+(f.reconnectTimes-na)+"/"+f.reconnectTimes,null,3E3);setTimeout(bb,5);svGlobal.logger.info("Reconnecting..."+na);return}if(Qa)svGlobal.logger.info("Req credential");
else{L&&(L.postMessage({type:0,cmd:4}),L.removeEventListener("message",cb,!1));R&&(R.release(),R=null);H=m=null;G&&(G.close(),G=null);ea&&hi5.Arrays.release(ea);fa&&hi5.Arrays.release(fa);W&&(W.stop(),W=null);F&&(F.close(),F=null);try{if(f.onclose)f.onclose(a);else svGlobal.logger.info("onclose: null");q&&(q.close(),q=null)}catch(c){}P=null;C&&(C.onopen=null,C.onmessage=null,C.onclose=null,C=C.onerror=null);q=Q=null;x&&(x.release(),x=null);hi5.browser.isChromeApp?chrome.runtime.onSuspend.removeListener(f.close):
window.removeEventListener("unload",f.close,!1);f=null;window&&window.$rdp==this&&(window.$rdp=null)}}}function sb(){C&&J?C.close():sa(!0)}function fb(a,b){var c=a.getLittleEndian32();if(0!=(c&16777216)){var e=a.getLittleEndian32();if(0!=(c&1073741824)){a.getLittleEndian16();a.getByte();var c=a.getByte(),d=a.getLittleEndian16(),g=a.getLittleEndian16(),h=0;16>c&&(h=a.getLittleEndian16());var f=a.getLittleEndian16(),m=a.getLittleEndian16();a.getBytes(f);h&&a.getBytes(h);if(8<=c&&(h=q.getFocused())&&
h.onremoteappicon){f=new hi5.graphic.Bitmap(d,g,32);a.getPosition();for(var d=new Uint8Array(d*g*4),g=a.getPosition(),m=g+m,p,r=a.getData(),k=0,l,u;g<m;)switch(c){case 16:(p=r[g++]|r[g++]<<8)?(u=p>>7&248,l=p>>2&248,p=p<<3&248,u|=u>>5,l|=l>>5,p|=p>>5,d[k++]=p,d[k++]=l,d[k++]=u,d[k++]=255):k+=4;break;case 32:d[k++]=r[g++],d[k++]=r[g++],d[k++]=r[g++],d[k++]=r[g++]}f.putPixels(d,0,d.length);e=q.getWinById(e);h.onremoteappicon(e,f)}}else 0!=(c&2147483648)?svGlobal.logger.info("XXX rail cache icon, winId="+
e):0!=(c&536870912)?(svGlobal.logger.info("***** delete winId="+e),q.delWin(e)):Kb(a,c,e)}else if(0!=(c&33554432))svGlobal.logger.info("XXX Alt Sec window Notify="+c);else if(0!=(c&67108864))if(svGlobal.logger.info("*** -- Alt Sec window Desktop="+c),0!=(c&1))svGlobal.logger.info("Desktop non monitored flags="+c);else{if(0!=(c&32)&&(e=a.getLittleEndian32(),svGlobal.logger.info("Desktop monitored flags="+c+" winId="+e),q.setTitle(e),x.getContext()||(e=q.getFocused())&&x.setContext(e.context),0!=(c&
16)&&(e=a.getByte(),0<e)))for(c=q.zOrders,c.length=e,h=0;h<e;h++)c[h]=a.getLittleEndian32(),svGlobal.logger.info("---zorders:"+c[h])}else svGlobal.logger.info("XXX Alt Sec window order flgas="+c)}function Kb(a,b,c){U||(U=!0);var e=0==(b&268435456);svGlobal.logger.info("\n\n=========== winId="+c+" existed="+e);var d=q.getWinById(c);d?e=!0:d=new q.LocalWin(c);if(d){0!=(b&2)&&(d.ownerWinid=a.getLittleEndian32(),svGlobal.logger.info("***** ownerWinid="+d.ownerWinid));0!=(b&8)&&(d.style=a.getLittleEndian32(),
d.extStyle=a.getLittleEndian32(),svGlobal.logger.info("***** winId="+c+" style="+d.style+" extStyle="+d.extStyle),svGlobal.logger.info("*****--- WS_POPUP="+(0!=(d.style&2147483648))),svGlobal.logger.info("*****--- WS_DLGFRAME="+(0!=(d.style&4194304))),svGlobal.logger.info("*****--- DS_MODALFRAME="+(0!=(d.style&128))),svGlobal.logger.info("*****--- WS_EX_DLGMODALFRAME="+(0!=(d.extStyle&1))),svGlobal.logger.info("*****--- WS_EX_TOOLWINDOW="+(0!=(d.extStyle&128))),svGlobal.logger.info("*****--- WS_BORDER="+
(0!=(d.style&8388608))),svGlobal.logger.info("*****--- WS_CAPTION="+(0!=(d.style&12582912))),svGlobal.logger.info("*****--- WS_OVERLAPPED="+(0!=(d.style&0))),svGlobal.logger.info("*****--- WS_OVERLAPPEDWINDOW="+(0!=(d.style&13565952))),svGlobal.logger.info("*****--- WS_POPUPWINDOW="+(0!=(d.style&2156396544))),svGlobal.logger.info("*****--- WS_SIZEBOX="+(0!=(d.style&262144))),svGlobal.logger.info("*****--- WS_CHILD="+(0!=(d.style&1073741824))),svGlobal.logger.info("*****--- WS_SIZEBOX="+(0!=(d.style&
262144))),svGlobal.logger.info("*****--- WS_EX_MDICHILD="+(0!=(d.extStyle&64))),svGlobal.logger.info("*****--- WS_EX_LAYERED="+(0!=(d.extStyle&524288))));0!=(b&16)&&(d.setShowState(a.getByte()),svGlobal.logger.info("***** winId="+c+" showState="+d.showState),2==d.showState&&0!=t.noMinimize&&setTimeout(function(){d.exeCommand(61728)},50));var g=0!=(b&4);if(g){var h=a.getLittleEndian16();d.titleInfo=a.getUnicodeString(h,!1);svGlobal.logger.info("***** winId="+c+" title="+d.titleInfo)}0!=(b&16384)&&
(d.clientOffsetX=a.getLittleEndian32(),d.clientOffsetY=a.getLittleEndian32(),svGlobal.logger.info("***** winId="+c+" coffX"+d.clientOffsetX+" coffY="+d.clientOffsetY));0!=(b&65536)&&(d.clientAreaWidth=a.getLittleEndian32(),d.clientAreaHeight=a.getLittleEndian32(),svGlobal.logger.info("***** winId="+c+" cw"+d.clientAreaWidth+" ch="+d.clientAreaHeight));0!=(b&131072)&&(d.rpContent=a.getLittleEndian32());0!=(b&262144)&&(d.rootParentHandle=a.getLittleEndian32());if(0!=(b&2048)){var h=a.getLittleEndian32(),
f=a.getLittleEndian32();d.winOffsetX=h;d.winOffsetY=f;svGlobal.logger.info("***** winId="+c+" offX"+d.winOffsetX+" offY="+d.winOffsetY)}0!=(b&32768)&&(d.winClientDeltaX=a.getLittleEndian32(),d.winClientDeltaY=a.getLittleEndian32(),svGlobal.logger.info("***** winId="+c+" dX"+d.winClientDeltaX+" dY="+d.winClientDeltaY));0!=(b&1024)&&(d.winWidth=a.getLittleEndian32(),d.winHeight=a.getLittleEndian32(),svGlobal.logger.info("***** winId="+c+" w"+d.winWidth+" h="+d.winHeight));0!=(b&256)&&(h=a.getLittleEndian16(),
0<h&&a.skipPosition(8*h));0!=(b&4096)&&(d.visibleOffsetX=a.getLittleEndian32(),d.visibleOffsetY=a.getLittleEndian32());0!=(b&512)&&(b=a.getLittleEndian16(),d.numVisibilityRects=b,0<b&&a.skipPosition(8*b));if(e)q.onWinChange(d);else q.addWin(d);g&&q.setTitle(c)}else svGlobal.logger.warn("XXX, No win with id:"+c)}function Wa(a,b){function c(a,b,d,c,g){0<g.width?g.union(a,b,d,c):(g.x=a,g.y=b,g.width=d,g.height=c)}function e(a,b,d,g){for(J=0;J<L;J++){var n=K[J];if(a>=n[0]&&b>=n[1]&&d<=n[2]&&g<=n[3])return G[J]}return null}
function d(a,b,d,g){if(L){var n=e(a,b,a+d-1,b+g-1);n&&c(a,b,d,g,n)}else c(a,b,d,g,t)}function g(a,b,d,g,c,h,e){for(var n=c*d+g,v=a.setRGB,B=a.getRGB,w=0;w<e;w++){for(var f=0;f<h;f++){if(a){var aa=B(g+f,c+w);v(g+f,c+w,~aa&16777215)}else b[n]=~b[n]&16777215;n++}n+=d-h}}function h(a,b,d,g,c,h,f,e,l,r){b=r*e+l;null==f&&(f=a);for(a=0;a<h;a++){for(l=0;l<c;l++)q[g+a][d+l]=q[g+a][d+l]&f[b]&16777215|4278190080,b++;b+=e-c}}function f(a,b,d,g,c,h,f,e,l,r){b=r*e+l;l=a.setRGB;r=a.getRGB;null==f&&(f=a);for(a=0;a<
h;a++){for(var n=0;n<c;n++){var v=r(d+n,g+a);l(d+n,g+a,v|f[b]&16777215);b++}b+=e-c}}function m(a,b,d,g){var c=F;if(c){var n=c.getRGB(b,d);switch(a){case 0:c.setRGB(b,d,0);break;case 1:c.setRGB(b,d,~(n|g)&16777215);break;case 2:c.setRGB(b,d,n&~g&16777215);break;case 3:c.setRGB(b,d,~g&16777215);break;case 4:c.setRGB(b,d,16777215*(~n&g));break;case 5:c.setRGB(b,d,~n&16777215);break;case 6:c.setRGB(b,d,n^g&16777215);break;case 7:c.setRGB(b,d,~n&g&16777215);break;case 8:c.setRGB(b,d,n&g&16777215);break;
case 9:c.setRGB(b,d,n^~g&16777215);break;case 10:break;case 11:c.setRGB(b,d,n|~g&16777215);break;case 12:c.setRGB(b,d,g);break;case 13:c.setRGB(b,d,(~n|g)&16777215);break;case 14:c.setRGB(b,d,n|g&16777215);break;case 15:c.setRGB(b,d,16777215);break;default:svGlobal.logger.warn("unsupported pixel opcode: "+a),c.setRGB(b,d,g)}}}function p(a,b,d,g,c,h,f,e,l){a>e||b>l||(d=a+d-1,d>e&&(d=e),a<h&&(a=h),d=d-a+1,g=b+g-1,g>l&&(g=l),b<f&&(b=f),g=g-b+1,1>d||1>g||F.fillRect(a,b,d,g,c))}function r(a,b,d,g,c,h,
f,e,l,r,p,m){if(!(b>p||d>m)){var n=b+g-1;n>p&&(n=p);l=b<l?l:b;n=n-b+1;p=d+c-1;p>m&&(p=m);r=d<r?r:d;m=p-d+1;if(!(1>n||1>m)){p=128;var v=0;f|=4278190080;e|=4278190080;if(l==b&&r==d&&n==g&&m==c)if(0==a)for(var B=0;B<c;B++){a=d+B;for(var w=0;w<g;w++)0==p&&(v++,p=128),0!=(h[v]&p)&&(q[a][b+w]=e),p>>=1;v++;p=128;v==h.length&&(v=0)}else for(B=0;B<c;B++){a=d+B;for(w=0;w<g;w++)0==p&&(v++,p=128),q[a][b+w]=0!=(h[v]&p)?e:f,p>>=1;v++;p=128;v==h.length&&(v=0)}else if(0==a)for(B=0;B<m;B++){a=d+B;for(w=0;w<n;w++)0==
p&&(v++,p=128),b+w>=l&&a>=r&&0!=(h[v]&p)&&(q[a][b+w]=e),p>>=1;v++;p=128;v==h.length&&(v=0)}else for(B=0;B<m;B++){a=d+B;for(w=0;w<n;w++)0==p&&(v++,p=128),b+w>=l&&d+B>=r&&(q[a][b+w]=0!=(h[v]&p)?e:f),p>>=1;v++;p=128;v==h.length&&(v=0)}}}}function k(a,b,d,g,c){this.offset=a;this.baseLine=b;this.width=d;this.height=g;this.fontData=c}function l(a,b,d,g,c,h){this.data=a;this.left=g;this.top=c;this.width=b;this.height=d;this.bitsperpixel=h;this.bytesperpixel=Math.floor((h+7)/8)}function u(a,b,d,g,c,h,e,f,
l){this.cache_idx=a;this.rawData=b;this.none=!b;this.hotX=d;this.hotY=g;this.width=c;this.height=h;this.xorSize=f;this.andSize=l;this.result="";this.distance=0;this.bpp=e;this.system="";if(b){if(!this.distance){a=0;if(b){e=0;for(var n=b.length;e<n;e++)0!=b[e]&&(a+=e%c+(e/c|0))}this.distance=a}if(!this.system){a:switch(this.distance){case 507:a="text";break a;case 2046:case 4359:a="default";break a;default:a=""}this.system=a}}a="";if(!this.system&&b){e=c*h*4;a=62+e+f+l;n=new Uint8Array(a);a=new hi5.DataBuffer(n,
0,a);a.setLittleEndian16(0);a.setLittleEndian16(2);a.setLittleEndian16(1);a.setByte(c);a.setByte(h);a.setByte(0);a.setByte(0);a.setLittleEndian16(d);a.setLittleEndian16(g);a.setLittleEndian32(40+e+f+l);a.setLittleEndian32(22);a.setLittleEndian32(40);a.setLittleEndian32(c);a.setLittleEndian32(2*h);a.setLittleEndian16(1);a.setLittleEndian16(32);a.setLittleEndian32(0);a.setLittleEndian32(f+l);a.setLittleEndian32(0);a.setLittleEndian32(0);a.setLittleEndian32(0);a.setLittleEndian32(0);for(d=h-1;0<=d;d--)for(g=
0;g<c;g++)h=b[c*d+g],a.setByte(h&255),a.setByte(h>>8&255),a.setByte(h>>16&255),a.setByte(h>>24&255);a="data:image/x-icon;base64,"+hi5.Base64.enc(a.getData())}this.url=a}var q=[],M=null,t=new hi5.graphic.Rectangle(0,0,0,0),x="Uint8ClampedArray"in window,T=null,A=0,z=0,C=0,I=0,D=null,K,G,J=0,L=0;this.width=a;this.height=b;var N=!1,F=this,H={imgData:null,left:0,top:0,width:0,height:0};this.setProfiler=function(a){T=a};this.getDirtyArea=function(){return t};this.setImgRect=function(a,b,d,g){A=a;z=b;C=
d;I=g};this.parseMonitorDef=function(a){var b=a.split(","),d=b.length,g=[];if(1<d){for(var c=!1,h=0;h<d;h++){var e=b[h].split(":");if(4==e.length)g[h]=Array(5),g[h][0]=parseInt(e[0]),g[h][1]=parseInt(e[1]),g[h][2]=parseInt(e[2]),g[h][3]=parseInt(e[3]),g[h][4]=0==g[h][0]&&0==g[h][1]?1:0;else{c=!0;break}}c&&(svGlobal.logger.warn("invaiid monitorDef:"+a),g.length=0)}return g};this.setMonitorLayout=function(a){var b=a.length,d=0;K=a;for(G=Array(b);d<b;d++)G[d]=new hi5.graphic.Rectangle(0,0,0,0);L=b};
this.setMonitorCount=function(a){L=a};this.addImg=function(a){C&&(D&&URL.revokeObjectURL(D.src),D=a)};this.flushImgs=function(){D&&(URL.revokeObjectURL(D.src),D=null,C=0)};this.getData=function(){return q};this.pause=function(a){N=a};this.release=function(){t=null;hi5.Arrays.release(G);F.flushImgs();q=M=F=null;H=H.imgData=null};this.isPaused=function(){return N};this.setContext=function(d){d!=M&&(M||!d||d.createImageData(1,1).data.buffer||(x=!1),M=d,null!=M&&(H.imgData=M.createImageData(a,b)))};this.getContext=
function(){return M};this.resize=function(d,g){if(q.length!=g||q[0].length!=d){for(var c=0;c<g;c++)q[c]=new Uint32Array(d);q.length=g;F.width=a=d;F.height=b=g;null!=M&&(H.imgData=M.createImageData(a,b))}};F.resize(a,b);this.getBuffer=function(){return q};this.setRGB=function(a,b,d){q[b][a]=d|4278190080};this.getRGB=function(a,b){return q[b][a]};this.setRGBs=function(a,g,c,h,e,f,l){var n,v=a+c,w=g+h;w>b&&(w=b);if(e.subarray)for(var B=g;B<w;B++,f+=l)q[B].set(e.subarray(f,f+c),a);else for(var p,B=g;B<
w;B++,f+=l){var r=f;p=q[B];for(n=a;n<v;n++)p[n]=e[r++]}d(a,g,c,h)};this.moveArea=function(a,b,g,c,h,e){if(0<e){var n=a+h,f=b+e,v,l;if(q[0].set)for(l=c-1;0<=l;l--)q[f+l].set(q[b+l].subarray(a,a+g),n);else for(l=c-1;0<=l;l--){var w=q[f+l],p=q[b+l];for(v=0;v<g;v++)w[n+v]=p[a+v]}}else if(0>e)if(n=a+h,f=b+e,l=0,q[0].set)for(;l<c;l++)q[f+l].set(q[b+l].subarray(a,a+g),n);else for(;l<c;l++)for(w=q[f+l],p=q[b+l],v=0;v<g;v++)w[n+v]=p[a+v];else if(0<h)for(n=a+h,f=b+e,v=g-1;0<=v;v--)for(w=n+v,p=a+v,l=0;l<c;l++)q[f+
l][w]=q[b+l][p];else for(n=a+h,f=b+e,v=0;v<g;v++)for(w=n+v,p=a+v,l=0;l<c;l++)q[f+l][w]=q[b+l][p];d(a+h,b+e,g,c)};this.getRGBs=function(a,b,d,g,c){var h=new Uint32Array(d*g),n=a+d;g=b+g;for(var e=0;b<g;b++)h.set(q[b].subarray(a,n),e),e+=d;c(h)};this.repaint=function(d,g,c,h){var n=H.imgData.data,e=0,f,l;T&&T.begin("paint");0>d&&(c+=d,d=0);0>g&&(h+=g,g=0);d+c>a&&(c=a-d);g+h>b&&(h=b-g);var v=d+c;var w=g+h;if(x)for(n=new Uint32Array(n.buffer),l=g;l<w;l++)n.set(q[l].subarray(d,v),e),e+=a;else{var p=4*
(a-c)|0;for(l=g;l<w;l++){for(f=d;f<v;f++){var r=q[l][f];n[e++]=r&255;n[e++]=r>>8&255;n[e++]=r>>16&255;n[e++]=255}e+=p}}H.left=d;H.top=g;H.width=c;H.height=h;T&&T.end("paint");return H};this.postPaint=d;this.draw=function(a,b,d,g){if(M&&!N)if(D&&D.complete&&(M.drawImage(D,A,z,C,I),URL.revokeObjectURL(D.src),D=null),L){if(a=e(a,b,d,g),a.width)return F.repaint(a.x,a.y,a.width,a.height),a.width=0,H}else if(t.width)return F.repaint(t.x,t.y,t.width,t.height),t.width=0,H;return null};this.fillRect=function(a,
b,g,c,h){var n=a+g,e=b+c;if(q[0].fill)for(var f,l=b;l<e;l++)q[l].fill(h,a,n);else for(l=b;l<e;l++)for(f=a;f<n;f++)q[l][f]=h;d(a,b,g,c)};this.drawLine=function(a,b,d,g,c){if(b==g){if(a>d){var h=a;a=d;d=h}var e=q[b];d++;if(e.fill)e.fill(c,a,d);else for(h=a;h<d;h++)e[h]=c}else if(a==d)for(b>g&&(h=b,b=g,g=h),g++,h=b;h<g;h++)q[h][a]=c;else{var n=Math.abs(d-a),f=Math.abs(g-b);h=a;var e=b;d=d>=a?a=1:a=-1;b=g>=b?g=1:g=-1;if(n>=f){b=a=0;var l=n;var v=n/2|0;var p=f}else g=d=0,l=f,v=f/2|0,p=n,n=f;if(!(1>n))for(n++,
f=0;f<n;f++)q[e][h]=c,v+=p,v>=l&&(v-=l,h+=a,e+=g),h+=d,e+=b}};this.bitBlt=function(a,b,c,e,l,p,r,m,k,y){var n=F;switch(a){case 0:m=n.setRGB;for(n=c;n<c+l;n++)for(k=e;k<e+p;k++)m(n,k,0);break;case 1:a=r;k=y*m+k;y=n.setRGB;b=n.getRGB;null==a&&(a=n);for(n=0;n<p;n++){for(r=0;r<l;r++)y(c+l,e+p,~(b(c+l,e+p)|a[k])&16777215);k+=m-l}break;case 2:a=r;k=y*m+k;y=n.setRGB;b=n.getRGB;null==a&&(a=n);for(n=0;n<p;n++){for(r=0;r<l;r++){var v=b(c+l,e+p);y(c+l,e+p,v&~a[k]&16777215);k++}k+=m-l}break;case 3:g(n,r,m,k,
y,l,p);r?n.setRGBs(c,e,l,p,r,y*m+k,m):n.moveArea(k,y,l,p,c-k,e-y);break;case 4:g(n,null,b,c,e,l,p);h(n,b,c,e,l,p,r,m,k,y);break;case 5:g(n,null,b,c,e,l,p);break;case 6:a=r;k=y*m+k;null==a&&(a=n);for(n=0;n<p;n++){for(y=0;y<l;y++)q[e+n][c+y]=q[e+n][c+y]^a[k]&16777215|4278190080,k++;k+=m-l}break;case 7:a=r;k=y*m+k;y=n.setRGB;b=n.getRGB;null==a&&(a=n);for(n=0;n<p;n++){for(r=0;r<l;r++)v=b(c+r,e+n),y(c+r,e+n,~(v&a[k])&16777215),k++;k+=m-l}break;case 8:h(n,b,c,e,l,p,r,m,k,y);break;case 9:a=r;k=y*m+k;y=n.setRGB;
b=n.getRGB;null==a&&(a=n);for(n=0;n<p;n++){for(r=0;r<l;r++)v=b(c+r,e+n),y(c+r,e+n,v^~a[k]&16777215),k++;k+=m-l}break;case 10:break;case 11:a=r;k=y*m+k;y=n.setRGB;b=n.getRGB;null==a&&(a=n);for(n=0;n<p;n++){for(r=0;r<l;r++)v=b(c+r,e+n),y(c+r,e+n,v|~a[k]&16777215),k++;k+=m-l}break;case 12:r?n.setRGBs(c,e,l,p,r,y*m+k,m):n.moveArea(k,y,l,p,c-k,e-y);break;case 13:g(n,null,b,c,e,l,p);f(n,b,c,e,l,p,r,m,k,y);break;case 14:f(n,b,c,e,l,p,r,m,k,y);break;case 15:m=n.setRGB;for(n=c;n<c+l;n++)for(k=e;k<e+p;k++)m(n,
k,16777215);break;default:svGlobal.logger.warn("unsupported opcode: "+a)}d(c,e,l,p)};this.drawLineExt=function(a,b,g,c,h,e){if(a==g||b==c){var n;if(b==c)if(g>a){var l=g-a;if(!(1>l))for(n=0;n<l;n++)m(e,a+n,b,h)}else{if(l=a-g,!(1>l))for(n=0;n<l;n++)m(e,g+n,b,h)}else if(c>b){if(l=c-b,!(1>l))for(n=0;n<l;n++)m(e,a,b+n,h)}else if(l=b-c,!(1>l))for(n=0;n<l;n++)m(e,a,c+n,h)}else{var f=Math.abs(g-a),p=Math.abs(c-b);n=a;l=b;var r,v;var k=g>=a?r=1:r=-1;var y=c>=b?v=1:v=-1;if(f>=p){y=r=0;var w=f;var q=f/2>>0;
var u=p}else v=k=0,w=p,q=p/2>>0,u=f,f=p;if(1>f)return;for(p=0;p<=f;p++)m(e,n,l,h),q+=u,q>=w&&(q-=w,n+=r,l+=v),n+=k,l+=y}h=Math.min(a,g);a=Math.max(a,g);g=Math.min(b,c);b=Math.max(b,c);0>a-h||0>b-g||d(h,g,a-h+1,b-g+1)};this.drawText=function(a,b,g,c,h,e,l,f,k,m,y,q,u,E,ja,t,M,x,T,ya,A){var n=0;1<q?p(m,y,q,u,h,x,T,ya,A):1==g&&p(e,l,f,k,h,x,T,ya,A);for(var v=t,w=0;w<t;)switch(M[n+w]){case 255:var B=M[n+w+2];if(B>v-n){w=t=0;break}B=M.slice?M.slice(n,n+B):M.subarray(n,n+B);ca[M[n+w+1]]=B;w+=3;t-=w;n=w;
w=0;break;case 254:var aa=(B=ca[M[n+w+1]])?B:null;aa&&0==aa[1]&&0==(b&32)&&(0!=(b&4)?ja+=M[n+w+2]:E+=M[n+w+2]);w=w+2<t?w+3:w+2;t-=w;n=w;w=0;if(!aa)break;for(var Lb=aa.length,da=0;da<Lb;da++){B=Q.getFont(a,aa[da]);if(0==(b&32)){var z=aa[++da];0!=(z&128)?(0!=(b&4)?ja+=aa[da+1]|aa[da+2]<<8:E+=aa[da+1]|aa[da+2]<<8,da+=2):0!=(b&4)?ja+=z:E+=z}B&&(r(g,E+B.offset&65535,ja+B.baseLine&65535,B.width,B.height,B.fontData,h,c,x,T,ya,A),0!=(b&32)&&(E+=B.width))}break;default:B=Q.getFont(a,M[n+w]),0==(b&32)&&(z=
M[n+ ++w],0!=(z&128)?(0!=(b&4)?ja+=M[n+w+1]|M[n+w+2]<<8:E+=M[n+w+1]|M[n+w+2]<<8,w+=2):0!=(b&4)?ja+=z:E+=z),B&&(r(g,E+B.offset&65535,ja+B.baseLine&65535,B.width,B.height,B.fontData,h,c,x,T,ya,A),0!=(b&32)&&(E+=B.width)),w++}1<q?0<u&&d(m,y,q,u):0<f&&0<k&&d(e,l,f,k)};this.drawBitmap=function(b,d,g,c,h,e,l,f,p){var n=S.getBitmap(b,d);n?(b=n.width,d=n.height,h>b&&(h=b),e>d&&(e=d),12==p?F.setRGBs(g,c,h,e,n.data,f*b+l,b):F.bitBlt(p,a,g,c,h,e,n.data,b,l,f)):svGlobal.logger.warn("Failed to get bitmap from cache, id:"+
b+" idx="+d)};this.saveDesktop=function(a,b,d,g,c){F.getRGBs(a,b,d,g,function(h){P.save(a,b,d,g,c,h)})};this.restoreDesktop=function(a,b,d,g,c){(c=P.restore(a,b,d,g,c))?F.setRGBs(a,b,d,g,c,0,d):svGlobal.logger.warn("XXX no matched desktop save.")};this.putFont=function(a,b,d){Q.putFont(a,b,d)};this.putBitmap=function(a,b,d){S.putBitmap(a,b,d)};this.putCursor=function(a,b){O.set(a,b)};this.setCursor=function(a){if(!N&&-1!=a){var b=O.get(a);if(b)F.onSetCursor(b);else svGlobal.logger.warn("invalid cursor"+
a)}};var R=0;this.isSendingHistory=function(){return 2E3>Date.now()-R};this.getHistory=function(a,b){var d=null;T&&T.begin("his_bitmap");S.forEach(function(b,g,c){if(b){var h=0,e=0;c=0;for(var l=b.length;c<l;c++)b[c].data&&(h++,e+=b[c].data.length);if(h&&e){d=new Uint32Array(e+8*h+2);d[0]=67174429;d[1]=h;h=2;for(c=0;c<l;c++)e=b[c],e.data&&(d[h++]=g,d[h++]=c,d[h++]=e.left,d[h++]=e.top,d[h++]=e.width,d[h++]=e.height,d[h++]=e.bitsperpixel,d[h++]=e.data.length,d.set(e.data,h),h+=e.data.length);a(d.buffer)}}});
T&&T.end("his_bitmap");T&&T.begin("his_font");(d=Q.toPDU())&&a(d.buffer);T&&T.end("his_font");(d=O.toPDU())&&a(d.buffer);for(var g=4,c=0,h=ca.length;c<h;c++)ca[c]&&(g+=ca[c].length+6);if(4<g){d=new Uint8Array(g);d[0]=29;d[2]=1;d[3]=7;for(var e=4,c=0,h=ca.length;c<h;c++)ca[c]&&ca[c].length&&(d[e++]=c,d[e++]=c>>8,g=ca[c].length,d[e++]=g,d[e++]=g>>8,d[e++]=g>>16,d[e++]=g>>24,d.set(ca[c],e),e+=g);a(d.buffer)}(d=P.toPDU())&&a(d.buffer);b();R=Date.now()};this.setHistory=function(a,b){switch(a){case 4:T&&
T.begin("his_bitmap_dec");for(var d=b.getLittleEndian32(),c=0;c<d;c++){var g=b.getLittleEndian32(),h=b.getLittleEndian32(),e=b.getLittleEndian32(),f=b.getLittleEndian32(),p=b.getLittleEndian32(),r=b.getLittleEndian32(),k=b.getLittleEndian32();var m=b.getLittleEndian32();var y=new Uint32Array(b.getData().buffer,b.getPosition(),m),v=new Uint32Array(m);v.set(y);b.skipPosition(4*m);S.putBitmap(g,h,new l(v,p,r,e,f,k))}T&&T.end("his_bitmap_dec");break;case 5:Q.fromStream(b);break;case 6:O.fromStream(b);
break;case 7:for(;b.has(6);)if(c=b.getLittleEndian16(),m=b.getLittleEndian32())d=b.getData().subarray(b.getPosition(),b.getPosition()+m),ca[c]=d,b.skipPosition(m);break;case 9:P.fromStream(b)}};var O=new function(){var a=[];this.set=function(b,d){a[b]=d};this.get=function(b){return a[b]};this.total=function(){return a.length};this.toPDU=function(){for(var b=2,d=2,c=0,g=0,h=a.length,e;g<h;g++)if(e=a[g])c++,d=d+7+(e.rawData?e.rawData.length:0);if(!c)return null;d=new Uint32Array(d);d[0]=100728861;d[1]=
c;for(g=0;g<h;g++)if(e=a[g])if(c=e.rawData?e.rawData.length:0,d[b++]=e.cache_idx|e.bpp<<16,d[b++]=e.hotX|e.hotY<<16,d[b++]=e.width|e.height<<16,d[b++]=e.xorSize,d[b++]=e.andSize,d[b++]=e.distance,d[b++]=c)d.set(e.rawData,b),b+=c;return d};this.fromStream=function(b){var d=b.getPosition();b=new Uint32Array(b.getData().buffer,d);for(var c=b[0],g=0,e,h,l,f,p,r,k,m,y,q,v,d=1;g<c;g++)e=b[d]&65535,h=b[d++]>>16,l=b[d]&65535,f=b[d++]>>16,p=b[d]&65535,r=b[d++]>>16,k=b[d++],m=b[d++],y=b[d++],q=b[d++],v=null,
q&&(v=new Uint32Array(q),v.set(b.subarray(d,d+q)),d+=q),h=new u(e,v,l,f,p,r,h,k,m),y&&(h.distance=y),a[e]=h}},P=new function(){function a(a,b,d,c,g,e){this.x=a;this.y=b;this.cx=d;this.cy=c;this.offset=g;this.data=e}var b=[];this.save=function(d,c,g,e,h,l){d=new a(d,c,g,e,h,l);c=0;for(g=b.length;c<g;c++)if(!b[c]){b[c]=d;return}b.push(d)};this.restore=function(a,d,c,g,e){for(var h,l=0,f=b.length;l<f;l++)if((h=b[l])&&h.x==a&&h.y==d&&h.cx==c&&h.cy==g){if(h.offset==e)return a=h.data,b[l]=null,a;svGlobal.logger.warn("TODO: offset")}return null};
this.toPDU=function(){for(var a=0,d=2,c=0,g=b.length;c<g;c++)b[c]&&(a++,d+=b[c].data.length+6);if(!a||!d)return null;var d=new Uint32Array(d),h=2;d[0]=151060509;d[1]=a;for(c=0;c<g;c++)if(a=b[c])d[h++]=a.x,d[h++]=a.y,d[h++]=a.cx,d[h++]=a.cy,d[h++]=a.offset,d[h++]=a.data.length,d.set(a.data,h),h+=a.data.length;return d};this.fromStream=function(a){a=new Uint32Array(a.getData().buffer,a.getPosition());for(var b=1,d=a[0],c,g,h,e,l,f,p,n=0;n<d;n++)c=a[b++],g=a[b++],h=a[b++],e=a[b++],l=a[b++],f=a[b++],
p=new Uint32Array(f),f=b+f,p.set(a.subarray(b,f)),b=f,this.save(c,g,h,e,l,p)}},ca=[],Q=new function(){var a=[];this.putFont=function(b,d,c){a[b]||(a[b]=[]);a[b][d]=c};this.getFont=function(b,d){return a[b]?a[b][d]:null};this.toPDU=function(){var b=0,d,c,g;var h=4;for(var e,l=a.length;b<l;b++)if((g=a[b])&&g.length)for(e=g.length,d=0;d<e;d++)(c=g[d])&&(h+=15+c.fontData.length);if(5>h)return null;var f=new Uint8Array(h);h=new hi5.DataBuffer(f,0,h);f[0]=29;f[2]=1;f[3]=5;h.skipPosition(4);b=0;for(l=a.length;b<
l;b++)if((g=a[b])&&g.length)for(e=g.length,d=0;d<e;d++)if(c=g[d])h.setByte(b),h.setLittleEndian16(d),h.setLittleEndian16(c.offset),h.setLittleEndian16(c.baseLine),h.setLittleEndian16(c.width),h.setLittleEndian16(c.height),h.setLittleEndian32(c.fontData.length),h.setBytes(c.fontData);return f};this.fromStream=function(a){for(;a.has(15);){var b=a.getByte(),d=a.getLittleEndian16(),c=a.getLittleEndian16(),g=a.getLittleEndian16(),h=a.getLittleEndian16(),e=a.getLittleEndian16(),l=a.getLittleEndian32(),
l=a.getBytes(l);this.putFont(b,d,new k(c,g,h,e,l))}}},S=new function(){var a=[],b=[];this.putBitmap=function(d,c,g){if(32767==c)b[d]&&(b[d].data=null,b[d]=null),b[d]=g;else{var h=a[d];h?h[c]&&(h[c].data=null,h[c]=null):a[d]=h=[];h[c]=g}};this.getBitmap=function(d,c){return 32767==c?b[d]:a[d]?a[d][c]:null};this.forEach=function(b){for(var d=a.length,c=0;c<d;c++)b(a[c],c,a)}}}this.displayMsg=this.reconnectOnResize=!0;this.appTimeout=1600;this.reconnectTimes=0;this.windowState=3;this.setTitle=this.openLink=
!0;this.audioBuffer=0;this.sessionInfo={domain:"",userName:"",sessionId:0,joinedSessions:[],suppressOutput:!1,appInfo:null};this.mode=0;this.remoteAppLogin=!0;var za=!1,ea={},fa={},ta=null,f=this,Qa=!1,V=!1,X=0,ua=null,va=null,t=hi5.appcfg||{img:{},toolbar:{fadable:!0}};this.setConfig=function(a){t=a};var ba="object"==typeof m?m:null,k=ba?{}:hi5.tool.queryToObj(m.substring(m.indexOf("?")+1)),D=0,K=0,ma=(N||k.color||k.server_bpp||16)|0,oa=null,tb=null,O=null,La=hi5.browser.isIE||hi5.browser.isEdge;
this.protocol=ba?"":m.substring(0,m.indexOf("://")).toLowerCase();this.setProfiler=function(a){tb=a};this.getProfiler=function(){return tb};this.gateway=function(){if(ba)return"";var a=m.lastIndexOf("/RDP?");-1==a&&(a=m.lastIndexOf("/JOIN?"));-1==a&&(a=m.lastIndexOf("/PLAY?"));return m.substring(0,a).replace(/wss\:\/\//ig,"https://").replace(/ws\:\/\//ig,"http://")}();svGlobal.logger.warn("Ver:"+svGlobal.version+" build:"+svGlobal.build);this.getGatewayAddr=pa;var ga="object"==typeof m||0<m.indexOf("/PLAY?"),
ub=!ga&&0<m.indexOf("invitation=");if(ub){var Ta=decodeURIComponent(m),wa=Ta.indexOf(' USERNAME="');if(0<wa){var wa=wa+11,vb=Ta.substring(wa,Ta.indexOf('"',wa));m+="&novice="+vb+"&server="+vb}m+="&mapClipboard=on"}if(ga)this.mode=1,ba?m="":(D=640,K=480),m+="&touchpad=on",this.reconnectOnResize=!1;else if(0<m.indexOf("/JOIN?")||ub)this.mode=2,this.reconnectOnResize=!1;z?D=parseInt(z):k.width&&(D=parseInt(k.width));I?K=parseInt(I):k.height&&(K=parseInt(k.height));-1==D&&(D=hi5.browser.getScreenWidth());
-1==K&&(K=hi5.browser.getScreenHeight());k.symlink&&k.parameters&&hi5.tool.queryToObj(k.parameters,k);k.gateway||(m+="&gateway="+encodeURIComponent(f.gateway));!k.minWidth&&t.minWidth&&(rdArgs.minWidth=t.minWidth);!k.minHeight&&t.minHeight&&(rdArgs.minHeight=t.minHeight);k.minWidth&&(k.minWidth=parseInt(k.minWidth));k.minHeight&&(k.minHeight=parseInt(k.minHeight));k.waWidth=k.waWidth?parseInt(k.waWidth):hi5.browser.isAndroid||hi5.browser.isiOS?Math.max(screen.width,screen.height):screen.width;k.waWidth&=
-4;k.waHeight=k.waHeight?parseInt(k.waHeight):hi5.browser.isAndroid||hi5.browser.isiOS?Math.max(screen.width,screen.height):screen.height;k.waHeight&=-4;"useSSL"in k||(m+="&useSSL="+("wss"==f.protocol));hi5.storage.isAvailable&&(Z(k.shareClipboard)||k.shareClipboardId)&&(m+="&shareClipboardId="+(k.shareClipboardId||wb()));t&&(void 0!=t.displayMsg?this.displayMsg=t.displayMsg:t.displayMsg=this.displayMsg,t.appTimeout&&(this.appTimeout=t.appTimeout),void 0!=t.reconnectOnResize&&(this.reconnectOnResize=
t.reconnectOnResize),t.reconnectTimes&&(this.reconnectTimes=t.reconnectTimes),void 0!=t.windowState&&(this.windowState=t.windowState),void 0!=t.openLink&&(this.openLink=t.openLink),void 0!=t.setTitle&&(this.setTitle=t.setTitle),t.audioBuffer&&(this.audioBuffer=t.audioBuffer),"boolean"==typeof t.useWSS&&(m=(t.useWSS?"wss":"ws")+m.substring(m.indexOf("://"))),"boolean"==typeof t.remoteAppLogin&&(this.remoteAppLogin=t.remoteAppLogin,za=!t.remoteAppLogin,svGlobal.logger.warn("remoteAppLogin deprecated, use hideLogin in appcfg.js instead")),
"boolean"==typeof t.hideLogin&&(za=t.hideLogin));m.indexOf("nocurosr=on");var U=0<m.indexOf("startProgram=app"),Ra=0<m.indexOf("mapDisk=on"),R=null;U&&(this.reconnectOnResize=!1);void 0==t.useWorker&&(t.useWorker=!0);t.useWorker&&(!window.Worker||hi5.browser.isFirefox||U&&!La||"file:"==location.protocol||0<navigator.userAgent.indexOf("MSIE 10."))&&(t.useWorker=!1);void 0==hi5.libMin&&(hi5.libMin=!0);var L=t.useWorker?new Worker(hi5.libPath+(t.rdpworker||(hi5.libMin?"rdpworker_min.js":"rdpworker.js"))):
null,na=this.reconnectTimes,Ga=L?{type:5,data:null}:null;this.getDisplayName=qa;this.server=qa();this.port=parseInt(k.port,10);this.loadbalanceToken=t.loadbalanceTokenName?t.loadbalanceTokenName+"="+hi5.tool.uuid():"";this.modifyURL=function(a){f.loadbalanceToken&&(a+="&"+f.loadbalanceToken);return a};this.getURL=function(){return m};this.getColor=function(){return ma};this.changeTitle=Ba;hi5.browser.isTouch&&Math.max(D,K)>Math.max(window.innerWidth,window.innerHeight)&&(this.reconnectOnResize=!1);
this.isRemoteApp=function(){return U};var C=null,J=!1,ia=!1,Sa=!1,F=new function(a){var b=null;this.available=!1;this.delay=a;this.supportWebAudio=!1;if(0==k.playSound||0<f.mode)if(b=hi5.audio.getAudioContext())this.supportWebAudio=this.available=!0;this.getContext=function(){return b};this.getBuffer=function(a){return b.createBuffer(2,a,ka)};var c=0,e=null,d=null;this.setVolume=function(a){1==a?e=null:(e||(e=b.createGain()),e.gain.value=a)};this.playBuffer=function(g){d=b.createBufferSource();d.buffer=
g;e?(d.connect(e),e.connect(b.destination)):d.connect(b.destination);var h=b.currentTime,f=0<c?c:h+a;f<h&&(f=h);c=f+g.duration;d.start?d.start(f):d.noteOn(f);return c-h};this.iOSFix=function(){if(b&&hi5.browser.isTouch&&hi5.browser.isSafari){var a=this.getBuffer(1024),d=b.createBufferSource();d.buffer=a;d.connect(b.destination);d.start?d.start(0):d.noteOn(0)}};this.close=function(){b&&(e&&e.disconnect(),d&&d.disconnect(),hi5.audio.releaseAudioContext())}}(f.audioBuffer),hb=F.available,x=new Wa(200,
200);x.onSetCursor=ib;this.setVolume=function(a){F&&F.setVolume(a)};this.setAudioBuffer=function(a){f.audioBuffer=a;F.delay=a};var Da=0,Ca=0,Ea=D-1,Fa=K-1,rb="";window.$rdp=this;ra(ma);this.running=function(){return J};this.setJoinMode=function(a){J&&A("8E1"+a)};this.setJoinCloseMode=function(a){J&&A("8EB3\t"+a)};this.refuseControl=function(a){J&&A("8E3"+a)};this.giveControl=function(a){J&&A("8E4"+a)};this.pauseSession=function(a,b){J&&A("8EB"+(b?1:0)+"\t"+a)};this.closeSession=function(a){J&&A("8EB2\t"+
a)};this.requestControl=function(){J&&A("8E2")};this.saveSession=function(a){J&&A("8E9"+(a.save?1:0)+"\t"+(a.timeout||0)+"\t"+(a.id||0))};this.allowJoin=function(a,b){J&&A("8EA"+a+"\t"+(b?1:0))};var Aa=new function(){function a(){if(c&&0<c.length){var b=c.shift();b.key?Aa.sendSingleKey(b.down,b.key):b["char"]&&Ya(b["char"]);0<c.length?setTimeout(a,e):(d&&d(),c=null)}}var b={" ":57,space:57,pgup:201,pageup:201,pgdn:209,pagedown:209,end:207,home:199,left:203,up:200,right:205,down:208,printscreen:183,
insert:210,del:211,"delete":211,altgr:184,windows:219,windowsright:220,context:221,esc:1,backspace:14,tab:15,enter:28,meta:29,command:29,ctrl:29,shift:42,alt:56,capslock:58,f1:59,f2:60,f3:61,f4:62,f5:63,f6:64,f7:65,f8:66,f9:67,f10:68,f11:87,f12:88,numlock:69,scrolllock:70,add:78};this.sendSingleKey=function(a,d){var c=b[d.toLowerCase()];c?f.writeScancode(a,c):(c=d.length,0!=c&&(1==c?f.writeKeyCode(a,d.toUpperCase().charCodeAt(0)):a&&f.writeText(d)))};var c=null,e=0,d=null;this.sendKeyComb=function(b,
h,f){if(V){b=b.split("+");var g=b.length,p;if(0!=g){var r=null,k=[];for(p=0;p<g;p++){var l=b[p];""==l&&""==r&&(l="Add");""!=l&&k.push({key:l,down:!0});r=l}g=k.length;for(p=g-1;0<=p;p--)k.push({key:k[p].key,down:!1});if(h)c=k,e=h,d=f,a();else for(p=0,g=k.length;p<g;p++)Aa.sendSingleKey(k[p].down,k[p].key)}}};this.sendText=function(b,h,f){for(var g=[],p=0,r=b.length;p<r;p++)g.push({"char":b.charAt(p)});c=g;e=h;d=f;a()}};this.writeKeyComb=function(a,b,c){V&&Aa.sendKeyComb(a,b,c)};this.writeText=function(a,
b,c){if(V)if(b)Aa.sendText(a,b,c);else for(b=0,c=a.length;b<c;b++)Ya(a.charAt(b))};this.writeClipboard=function(a,b){a&&(b||(b="text/plain"),f.writeRawInput("880"+b+"\t"+a.hashCode()),va={type:b,text:a})};var q=new function(a,b){function c(){function b(a){for(;0<a.ownerWinid;){var b=p.getWinById(a.ownerWinid);if(b&&b.isVisible())a=b;else break}return a}function c(a){for(var b="";a;)a.titleInfo&&(b=a.titleInfo),a=p.getWinById(a.ownerWinid);return b}var h=[],e=[],f=0,p=this;this.mainWin=null;this.appId=
"";this.onchange=function(b){b.isVisible()||b!=p.mainWin?b.isVisible()&&!p.mainWin&&b.isMainWin()&&(p.mainWin=b,a.windowState&&b.exeCommand(61488)):p.mainWin=null};this.addWin=function(b){for(var d=h.length,c=!1,g=0;g<d;g++)if(b.id==h[g].id){h[g]=b;c=!0;break}c||h.push(b);1==h.length&&(f=Date.now());0<a.windowState&&(d=b.isMainWin(),svGlobal.logger.info("is main win:"+d+" id:"+b.id),d&&!p.mainWin&&(p.mainWin=b))};this.popWins=function(a){a=p.getWinById(a);var b=[];if(a){a=0<a.ownerWinid?a.ownerWinid:
a.id;for(var d=h.length-1;0<=d;d--)if(h[d].ownerWinid==a||h[d].id==a)b.push(h[d]),h.splice(d,1)}return b};this.hasApp=function(a){return-1!=e.indexOf(a)};this.addApp=function(a){return-1==e.indexOf(a)?(e.push(a),!0):!1};this.isNew=function(){return 3E4>Date.now()-f};this.getAll=function(){return h};this.hasWin=function(a){return 0<=h.indexOf(a)};this.close=function(){for(var a=0,b=h.length;a<b;a++)h[a].close()};this.clear=function(){h.length=0};this.delWin=function(a){for(var b=0,d=h.length;b<d;b++)if(h[b].id==
a)return h.splice(b,1),b;return-1};this.isRunning=function(){var a=h.length;if(1>a)return!1;for(var b=0,a=h.length;b<a;b++){var d=h[b];if(d.isVisible())return!0}return!1};this.getWinById=function(a){var b=h.length;if(1>b)return null;for(var d=0;d<b;d++){var c=h[d];if(c.id==a)return c}return null};this.getMainWinByAppId=function(a){var b=null,d=0;for(len=h.length;d<len;){b=h[d];if(b.appId==a&&b.isVisible()&&1>b.ownerWinid)break;d++}return b};this.getTopWin=function(a){var b=null,d,c=a.length;for(d=
0;d<c&&(!(b=p.getWinById(a[d]))||!b.isVisible());d++)b=null;if(!b)for(svGlobal.logger.warn("No win found"),c=h.length,d=c-1;0<=d&&(b=h[d],!b.isVisible());d--)b=null;return b};this.getMain=function(a){return(a=p.getTopWin(a))?b(a):null};this.getOtherApps=function(a,d,g){var e=h.length;if(0!=e&&h[e-1])if(e=h[e-1].appId,g||!e)setTimeout(function(){p.getOtherApps(a,d)},g||3E3);else{g=[];if(e=p.getTopWin(a)){for(var f=0<e.ownerWinid?e.ownerWinid:e.id,l=[],k=0,e=h.length;k<e;k++)h[k].ownerWinid!=f&&h[k].id!=
f&&h[k].isVisible()&&l.push(h[k]);k=0;for(e=l.length;k<e;k++)l[k].ownerWinid!=f&&l[k].id!=f&&(g.push({title:c(l[k]),win:b(l[k])}),f=0<l[k].ownerWinid?l[k].ownerWinid:l[k].id)}d(g)}};this.getFullTitle=function(a){for(var b,d="";;){b=p.getWinById(a);if(!b)break;b.titleInfo&&b.isVisible()&&(d&&(d=" > "+d),d=b.titleInfo+d);if(1>a)break;a=b.ownerWinid}return d}}var e=[];a.isRemoteApp();this.verifyMonitors=function(){var a=e[0].getMousePosition(),b,c=e.length;e[0].configMonitor();for(b=1;b<c;b++){e[b].configMonitor();
var f=e[b].getMousePosition();Math.abs(f.left)+Math.abs(f.top)<Math.abs(a.left)+Math.abs(a.top)&&(a=f)}0!=a.left&&(a.right-=a.left,a.left=0);0!=a.top&&(a.bottom-=a.top,a.top=0);for(b=0;b<c;b++)if(f=e[b].getMousePosition(),f!=a){if(0>f.right){var k=-f.right-1;0<k&&(f.left+=k,f.right+=k)}f.left>a.right&&(k=f.left-a.right-1,0<k&&(f.left-=k,f.right-=k));0>f.bottom&&(k=-f.bottom-1,0<k&&(f.top+=k,f.bottom+=k));f.top>a.bottom&&(k=f.top-a.bottom-1,0<k&&(f.top-=k,f.bottom-=k))}};this.repaint=function(a,b,
c,f){for(var d=0,g=e.length;d<g;d++)e[d].repaint(a,b,c,f)};this.size=function(){return e.length};this.getSurface=function(a){return e[a]};this.addSurface=function(a){e.push(a)};this.hasSurface=function(a){for(var b=e.length,d=0;d<b;d++)if(e[d].equals(a))return!0;return!1};this.fromSyncedSurface=function(a){var b=e.length;Date.now();for(var d=0;d<b;d++)if(e[d].isClipSynced(a))return!0;return!1};this.setSize=function(a,b,c){for(var d=0,g=e.length;d<g;d++)e[d].setSize(a,b,c)};this.zOrders=[];this.drawLicense=
function(a){for(var b=0,d=e.length;b<d;b++)e[b].drawLicense(a)};this.setReadOnly=function(a,b){for(var d=0,c=e.length;d<c;d++)e[d].setReadOnly(a,b)};this.setVisible=function(a,b){svGlobal.logger.info("TODO: setVisible")};this.copyToClip=function(a){1>e.length||e[0].copyToClip(a)};this.setCursor=function(a){for(var b=0,d=e.length;b<d;b++)e[b].setCursor(a)};this.hide=function(a){a=0;for(var b=e.length;a<b;a++)e[a].hide()};this.execute=function(a,b){for(var d=0,c=e.length;d<c;d++)e[d][a].apply(e[d],
b)};this.addWin=function(d){var g=this.getFocused();g||(svGlobal.logger.warn("Focused surface not found!"),g=e[e.length-1]);g?(g.railWin||(g.railWin=new c,g.onunload=function(){hi5.appcfg.closeRemoteApp&&g.railWin&&g.railWin.close();g.remoteApp&&g.remoteApp.close();g.railWin&&(g.railWin.clear(),g.railWin=null);e.removeElm(g)}),g.context&&b.setContext(g.context),g.railWin.addWin(d),a.windowState&&g.railWin.mainWin==d&&setTimeout(function(){var b=g.getFreeSpace();a.writeRawInput("8C661441\t"+b.width+
"\t"+b.height);setTimeout(function(){d.exeCommand(61488)},50)},111),La&&g.focus()):svGlobal.logger.warn("No surface available!")};this.delWin=function(b){for(var d,c=e.length-1;0<=c;c--){var f=e[c];d=f.railWin;var k=d.getWinById(b),p=k&&k.appId&&-1!=k.appId.toLowerCase().indexOf("runonce");if(0<=d.delWin(b)){if(k.isMainWin()&&f.onremoteappclose)f.onremoteappclose(k);k==d.mainWin&&(d.mainWin=null);if(!d.isRunning()){k=a.appTimeout;if(p||d.isNew())k*=10;svGlobal.logger.debug("Prepare del:"+Date.now());
setTimeout(function(a){return function(){svGlobal.logger.info("Start del:"+Date.now());a.railWin&&a.railWin.isRunning()||(a.remoteApp&&a.remoteApp.close(),q.delSurface(a))}}(f),k)}}}};this.popWins=function(a){return e[0]&&e[0].railWin?e[0].railWin.popWins(a):[]};this.getWinById=function(a){for(var b,d=0,c=e.length;d<c;d++)if(e[d].railWin&&(b=e[d].railWin.getWinById(a)))return b;return null};this.getMainWinByAppId=function(a){for(var b,d=0,c=e.length;d<c;d++)if(e[d].railWin&&(b=e[d].railWin.getMainWinByAppId(a)))return b;
return null};this.onWinChange=function(a){for(var b,d=0,c=e.length;d<c;d++)if(e[d].railWin&&(b=e[d].railWin.getWinById(a.id)))e[d].railWin.onchange(a)};this.setTitle=function(b){for(var d,c=0,f=e.length;c<f;c++)if(e[c].railWin){d=e[c].railWin.getWinById(b);var k=e[c].railWin.getFullTitle(b);if(k){a.changeTitle(k,e[c].getWindow(),d.appId);break}}};this.hasApp=function(a){for(var b=0,d=e.length;b<d;b++)if(e[b].railWin.hasApp(a))return!0;return!1};this.delSurface=function(b){!b||b.railWin&&b.railWin.isRunning()||
(svGlobal.logger.info("delete surface..."),e.removeElm(b),b.close(),0==e.length&&a._unload())};this.getOwnerSurface=function(a){for(var b=0,d=e.length;b<d;b++)if(e[b].railWin&&e[b].railWin.hasWin(a))return e[b];return null};this.getFocused=function(){for(var a=e.length,b=0;b<a;b++)if(e[b].focused)return e[b];return e[a-1]};this.close=function(){for(var a=0,b=e.length;a<b;a++)e[a]&&(e[a].remoteApp&&e[a].remoteApp.close(),e[a].close(),e[a]=null)};this.LocalWin=function(b){function d(){a.writeRawInput("8C0"+
b)}this.id=b;this.appId="";var c=this;this.resizable=function(){return 0!=(c.style&262144)||0!=(c.style&65536)||0!=(c.style&16777216)||3==c.showState};this.setShowState=function(a){c.showState=a};this.parent=function(){return q.getWinById(c.ownerWinid)};this.resize=function(b,d,g,e){hi5.appcfg.disableJoinedAppResize&&2==a.mode||a.writeRawInput("8C1"+c.id+"\t"+b+"\t"+d+"\t"+g+"\t"+e)};this.exeCommand=function(d){a.writeRawInput("8C4"+b+"\t"+d)};this.activate=function(d){2==c.showState?(c.exeCommand(61728),
setTimeout(function(){a.writeRawInput("8C3"+b+"\t"+d)},50)):a.writeRawInput("8C3"+b+"\t"+d)};this.close=function(){c.exeCommand(61536)};this.getAppId=d;this.isVisible=function(){return c.winWidth&&c.winHeight&&c.showState&&45<c.winHeight&&45<c.winWidth};this.isMainWin=function(){if(!(c.winWidth&&c.winHeight&&45<c.winHeight&&45<c.winWidth))return!1;var a=1>c.ownerWinid;if(!a)return a;var b=c.style;if(0!=(b&4194304))return!0;if(0!=(b&2147483648)&&(0==(b&8388608)||0==(b&12582912)))return!1;var d=0!=
(c.extStyle&128);(a=a&&!d)&&0!=(b&2147483648)&&0==(b&2156396544)&&(a=!1);return a};d()}}(f,x);this.getSurfaces=function(){return q};this.hide=function(){q&&q.hide()};this.getFileUrl=function(a){return f.modifyURL(pa()+"/DOWNLOAD?s="+rb+"&f="+a)};this.listFiles=function(a,b){R&&V&&R.list(a,b)};this.writeRawInput=function(a){if(V&&(A(a),f.onactivity))f.onactivity(a)};var Q=new function(a,b,c){this.setJoinMode=a.setJoinMode;this.requestControl=a.requestControl;this.writeKeyComb=a.writeKeyComb;this.writeText=
a.writeText;this.remoteLockFlags=this.localLockFlags=0;this.checkLockFlags=!0;this.reqCopyTime=0;this.draw=c.draw;var e=a.isRemoteApp();this.refresh=function(a,b,d,e){return c.repaint(a,b,d-a+1,e-b+1)};this.getAppMode=function(){return a.mode};this.send=a.writeRawInput;this.saveSession=function(b){a.saveSession(b)};this.sendInput=a.writeRawInput;var d=null;this.getAppInfo=function(){return a.sessionInfo.appInfo};this.onresize=function(b){if(b=b.target.svSurface){b=b.getFreeSpace();var c=b.width,g=
b.height;e?a.writeRawInput("8C661441\t"+c+"\t"+g):a.reconnectOnResize&&a.running()&&(d&&(clearTimeout(d),d=0),d=setTimeout(function(){a.reconnect(c,g)},555))}};this.onorientationchange=function(b){a.reconnectOnResize?a.reconnect(b.innerWidth,b.innerHeight):e&&b.svSurface&&a.windowState&&a.writeRawInput("8C661441\t"+b.innerWidth+"\t"+b.innerHeight)};this.getClipData=function(b,d){this.reqCopyTime=Date.now();var c=hi5.httpGet(a.modifyURL(a.getGatewayAddr()+"/CLIP?s="+a.sessionInfo.appInfo.session+"&t="+
Date.now()+"&type="+b),d);this.reqCopyTime=Date.now();return c};this.onfocus=function(d){var g=d.target;e&&g.svSurface&&g.svSurface.railWin&&(d=g.svSurface.railWin.getTopWin(b.zOrders))&&a.running()&&(g=g.svSurface.context)&&g!=c.getContext()&&(c.setContext(null),d.activate(1),svGlobal.logger.info("Activate win:"+d.id))};this.getShareFiles=a.listFiles;this.getFile=function(b){a.reconnectOnResize=!1;var d=a.getFileUrl(b);f.ondownload&&f.ondownload({fileName:b,url:d})||window.open(d)};this.getFileLink=
a.getFileUrl;this.getGateway=function(){return m};this.reconnect=function(b,d,c){k.symlink?(b="user="+b+"&pwd="+d,c&&(b+="&domain="+c),m=hi5.tool.replaceQuery(m,"parameters",b)):(m=hi5.tool.replaceQuery(m,"user",b),m=hi5.tool.replaceQuery(m,"pwd",d),m=hi5.tool.replaceQuery(m,"domain",c));a.run()};this.sendKeyboardSyncFlags=function(b){a.writeRawInput("8E5"+b);this.remoteLockFlags=this.localLockFlags=b};this.sendKeyboardSynchronize=function(a,b,d){var c=0;d&&(c|=4);b&&(c|=2);a&&(c|=1);this.sendKeyboardSyncFlags(c)};
this.fromSyncedSurface=function(a){return b.fromSyncedSurface(a)}}(f,q,x);this.sendKeyboardSynchronize=function(a,b,c){Q.sendKeyboardSynchronize(a,b,c)};var H=null,G={count:0,names:[],close:function(){for(var a=G.names,b=0,c=a.length;b<c;b++)G[a[b]].onclose&&(G[a[b]].onclose(),G[a[b]]=null);a.length=0},init:function(a,b,c,e){function d(){this.WAVE_FORMAT_PCM=1;this.WAVE_FORMAT_ADPCM=2;this.WAVE_FORMAT_ALAW=6;this.WAVE_FORMAT_MULAW=7;this.WAVE_FORMAT_GSM=49;this.WAVE_FORMAT_MPEGLAYER3=85;this.WAVE_FORMAT_AAC=
41222;this.bitsPerSample=this.nBlockAlign=this.nAvgBytesPerSec=this.nSamplesPerSec=this.nChannels=this.formatTag=0;this.hasLocalSupport=!1;this.cbSize=0;this.extenstion=null;var a=this;this.fromBuffer=function(b){a.formatTag=b.getLittleEndian16();a.nChannels=b.getLittleEndian16();a.nSamplesPerSec=b.getLittleEndian32();a.nAvgBytesPerSec=b.getLittleEndian32();a.nBlockAlign=b.getLittleEndian16();a.bitsPerSample=b.getLittleEndian16();var d=b.getLittleEndian16();a.cbSize=d;0<d&&(a.extenstion=Array(d),
b.copyToByteArray(a.extenstion,0,b.getPosition(),d),b.skipPosition(d))};this.toBuffer=function(b){b.setLittleEndian16(a.formatTag);b.setLittleEndian16(a.nChannels);b.setLittleEndian32(a.nSamplesPerSec);b.setLittleEndian32(a.nAvgBytesPerSec);b.setLittleEndian16(a.nBlockAlign);b.setLittleEndian16(a.bitsPerSample);b.setLittleEndian16(a.cbSize);0<a.cbSize&&b.setBytes(a.extenstion)};this.getSize=function(){return 18+a.cbSize};this.toString=function(){return"Audio Format, tag="+a.formatTag+" nChannels="+
a.nChannels+" nSamplesPerSec="+a.nSamplesPerSec+" nAvgBytesPerSec"+a.nAvgBytesPerSec+" nBlockAlign"+a.nBlockAlign+" bitsPerSample"+a.bitsPerSample+" cbSize="+a.cbSize}}function g(){H=new f.DynamicChannel;H.name="Microsoft::Windows::RDS::DisplayControl";H.enabled=!1;H.process=function(a){var b=a.getLittleEndian32();a.getLittleEndian32();switch(b){case 5:b=a.getLittleEndian32(),H.maxMonitorAreaFactorA=a.getLittleEndian32(),H.maxMonitorAreaFactorB=a.getLittleEndian32(),H.enabled=!0,svGlobal.logger.warn("Display control maxNumMonitors:"+
b+" factorA:"+H.maxMonitorAreaFactorA+" factorB:"+H.maxMonitorAreaFactorB),a=new Uint8Array(2),a[0]=146,a[1]=4,A(a.buffer),O&&setTimeout(function(){O.check(5E3)},1900)}};H.applyResolution=function(a,b){if(H.enabled){var d=new Uint8Array(56),c=new RdpBuffer(d,0,56);a=a>H.maxMonitorAreaFactorA?H.maxMonitorAreaFactorA:a&-4;b=b>H.maxMonitorAreaFactorB?H.maxMonitorAreaFactorB:b&-4;c.setLittleEndian32(2);c.setLittleEndian32(56);c.setLittleEndian32(40);c.setLittleEndian32(1);c.setLittleEndian32(1);c.setLittleEndian32(0);
c.setLittleEndian32(0);c.setLittleEndian32(a);c.setLittleEndian32(b);c.setLittleEndian32(.26458*a|0);c.setLittleEndian32(.26458*b|0);c.setLittleEndian32(a>b?0:90);c.setLittleEndian32(100);c.setLittleEndian32(100);H.send(d);svGlobal.logger.warn("Display control: "+a+"x"+b)}else svGlobal.logger.warn("Display control disabled.")};return H}if(!t.disableDVC){G.count=0;G.names.length=0;var h=new f.DynamicChannel;h.name="ECHO";h.process=function(a){var b=a.getPosition(),d=a.getEnd(),c=new Uint8Array(d-b);
c.set(a.getData().subarray(b,d));h.send(c)};f.addDynamicChannel(h);if(a){var k=new f.DynamicChannel;k.name="Microsoft::Windows::RDS::Input";k.process=function(a){var b=a.getLittleEndian16();a.getLittleEndian32();switch(b){case 1:a.skipPosition(4),a=new RdpBuffer(new Uint8Array(16),0,16),a.setLittleEndian16(2),a.setLittleEndian32(16),a.setLittleEndian32(3),a.setLittleEndian32(65536),a.setLittleEndian16(256),a.markEnd(),k.send(a);case 5:q.execute("setTouchRemoting",[!0]);G.isTouchReady=!0;svGlobal.logger.info("Touch remoting start");
break;case 4:q.execute("setTouchRemoting",[!1]),G.isTouchReady=!1,svGlobal.logger.info("Touch remoting suspend")}};f.addDynamicChannel(k)}if(c){svGlobal.logger.warn("Audio input on");var m=new f.DynamicChannel;(function(){function a(a){var b=new RdpBuffer(new Uint8Array(5),0,5);b.setByte(7);b.setLittleEndian32(a);b.markEnd();m.send(b)}function b(b){b.getLittleEndian32();var l=b.getLittleEndian32();(new d).fromBuffer(b);g=!0;h=f.reconnectOnResize;f.reconnectOnResize=!1;t.onopen||(t.onopen=function(b){if(J){c=
b;f.reconnectOnResize=h;a(l);var d=new RdpBuffer(new Uint8Array(5),0,5);d.setByte(4);d.setLittleEndian32(b?0:1);d.markEnd();m.send(d)}});t.ondata||(t.ondata=function(a,b){c&&(k.length!=b+1&&(k=new Uint8Array(b+1),k[0]=6),m.send(e),k.set(a,1),m.send(k))});t.start()}m.name="AUDIO_INPUT";m.process=function(c){var f=c.getByte();switch(f){case 1:var h=c.getLittleEndian32(),f=new RdpBuffer(new Uint8Array(5),0,5);f.setByte(1);f.setLittleEndian32(h);f.markEnd();m.send(f);break;case 2:var l=c.getLittleEndian32();
c.getLittleEndian32();for(var f=[],k=[],p=F.getContext().sampleRate,h=0;h<l;h++){var q=new d;q.fromBuffer(c);49==q.formatTag&&22050==q.nSamplesPerSec?(q.hasLocalSupport=!0,f.push(q)):1==q.formatTag&&q.nSamplesPerSec==p&&2==q.nChannels&&k.push(q)}m.send(e);l=0;c=f.length;0==c&&(f=k,c=k.length,t.directInput=!0);for(h=0;h<c;h++)l+=f[h].getSize();k=new RdpBuffer(new Uint8Array(1024),0,1024);k.setByte(2);k.setLittleEndian32(c);k.setLittleEndian32(l+9);for(h=0;h<c;h++)f[h].toBuffer(k);k.skipPosition(1024-
l-9);k.markEnd();m.send(k);break;case 3:b(c);break;case 7:f=c.getLittleEndian32();g||(a(f),g=!1);break;default:svGlobal.logger.warn("audioInpt: invalid tag:"+f)}};var c=!1;m.onclose=function(){c=!1;t&&t.close()};var e=new Uint8Array(1);e[0]=5;var g=!1,h=f.reconnectOnResize,k=new Uint8Array(0),q=null,t=new function(a){function b(b){m=!0;if(l.onopen)l.onopen(!0);q=new MSGSMEncoder;g=b;f=a.createMediaStreamSource(b);b=l.directInput?1024:4096;h=a.createJavaScriptNode?a.createJavaScriptNode(b,1,1):a.createScriptProcessor(b,
1,1);l.directInput&&!r&&(r=new Int16Array(2048));h.onaudioprocess=function(a){if(e){a=a.inputBuffer.getChannelData(0);if(l.directInput){for(var b=0,d,c=0;1024>c;c++)d=32767*a[c],r[b++]=d,r[b++]=d;t.ondata(new Uint8Array(r.buffer),4196)}else u.addData(a,k);a.fill(0)}};f.connect(h);h.connect(a.destination)}function d(a){e=m=!1;if(l.onopen)l.onopen(!1);svGlobal.logger.warn("Error on getUserMedia: "+a)}function c(){e||(g&&g.getTracks&&g.getTracks()[0].stop(),h&&h.disconnect(),f&&f.disconnect(),m=!1)}
var e=!1,g=null,f=null,h=null,l=this,k=a.sampleRate/22050,m=!1,p=0;this.directInput=!1;var l=this,r;this.start=function(){p&&clearTimeout(p);if(!m)navigator.getUserMedia?navigator.getUserMedia({audio:!0},b,d):navigator.mediaDevices.getUserMedia({audio:!0}).then(b)["catch"](d);else if(l.onopen)l.onopen(!0);e=!0};this.stop=function(){e=!1};this.close=function(){e=!1;u&&u.reset();q=new MSGSMEncoder;p=setTimeout(c,3E5)};var u=new function(){function a(a){for(var h=c/160|0,k=0;k<h;k++){var m=q.encode(a,
d,f,e);e+=m;e==g&&(e=0,l.ondata(f,g));d+=160;c-=160}b=0<c?a:null}var b=null,d=0,c=0,e=0,g=65*Math.floor(Math.floor(Math.floor(4096/k)/160)/2),f=new Uint8Array(g);this.reset=function(){c=d=e=0;b=null};this.addData=function(e,g){var f=e;if(1==g)e=f;else if(1>g)console.error("rate must be smaller than the original rate"),e=void 0;else{for(var h=new Float32Array(Math.round(f.length/g)),l=0,k=0;l<h.length;){for(var m=Math.round((l+1)*g),n=0,p=0;k<m&&k<f.length;k++)n+=f[k],p++;h[l]=n/p;l++;k=m}e=h}0==c?
(c=e.length,d=0,a(e)):(f=e,h=c+f.length,l=new Float32Array(h),l.set(b.subarray(d)),l.set(f,c),d=0,c=h,a(l))}}}(F.getContext())})();f.addDynamicChannel(m)}f.addDynamicChannel(function(){var a=new f.DynamicChannel;a.name="TSMF";var b={type:"image/jpeg"},d=Array(1);a.process=function(c){c.getPosition();var e=c.getLittleEndian32()&1073741823;var g=c.getLittleEndian32();var f=c.getLittleEndian32();switch(e){case 2:if(256==f){c.getLittleEndian32();f=new Uint8Array(16);var h=new RdpBuffer(f,0,16);h.setLittleEndian32(2);
h.setLittleEndian32(g);h.setLittleEndian32(1);h.setLittleEndian32(0);a.send(f)}break;case 0:switch(f){case 257:c.getBytes(16);c.getLittleEndian32();break;case 256:e=c.getPosition();h=c.getLittleEndian32();for(f=0;f<h;f++){c.getLittleEndian32();var k=c.getLittleEndian32();c.getLittleEndian32();c.skipPosition(k-4)}f=c.getPosition()-e;h=f+8+4;f=new Uint8Array(h);h=new RdpBuffer(f,0,h);h.setLittleEndian32(-2147483648);h.setLittleEndian32(g);f.set(c.getData().subarray(e,c.getPosition()),8);a.send(f);break;
case 261:c.getBytes(16);c.getLittleEndian32();break;case 264:e=c.getLittleEndian32();c.skipPosition(4);c.getLittleEndian32();k=c.getBytes(16);var l=c.getBytes(16);c.getLittleEndian32();c.getLittleEndian32();c.getLittleEndian32();var m=c.getBytes(16);f=c.getLittleEndian32();c.skipPosition(f);f=new Uint8Array(20);h=new RdpBuffer(f,0,20);h.setLittleEndian32(-2147483648);h.setLittleEndian32(g);hi5.Arrays.equals([118,105,100,115,0,0,16,0,128,0,0,170,0,56,155,113],k)&&hi5.Arrays.equals([77,74,80,71,0,0,
16,0,128,0,0,170,0,56,155,113],l)&&hi5.Arrays.equals([128,159,88,5,86,195,206,17,191,1,0,170,0,85,89,90],m)?h.setLittleEndian32(1):(h.setLittleEndian32(0),svGlobal.logger.warn("Format is not supported:"),svGlobal.logger.warn(k),svGlobal.logger.warn(l),svGlobal.logger.warn(m));h.setLittleEndian32(e);a.send(f);break;case 258:c.getBytes(16);c.getLittleEndian32();e=c.getLittleEndian32();c.skipPosition(e);break;case 263:c.getBytes(16),f=new Uint8Array(16),h=new RdpBuffer(f,0,16),h.setLittleEndian32(-2147483648),
h.setLittleEndian32(g),h.setLittleEndian32(1),a.send(f);case 277:c.getBytes(16);c.getLittleEndian32();break;case 262:c.getBytes(16);x.flushImgs();x.setImgRect(0,0,0,0);f=new Uint8Array(12);h=new RdpBuffer(f,0,12);h.setLittleEndian32(-2147483648);h.setLittleEndian32(g);a.send(f);break;case 278:c.getBytes(16);g=c.getLittleEndian32();f=c.getLittleEndian32();e=c.getLittleEndian32();c=c.getLittleEndian32();x.setImgRect(g,f,e-g,c-f);break;case 265:c.getBytes(16);c.getLittleEndian64();c.getLittleEndian32();
break;case 266:c.getBytes(16);break;case 268:c.getBytes(16);break;case 267:c.getBytes(16);break;case 269:c.getBytes(16);c.getLittleEndian32();break;case 274:break;case 275:break;case 259:c.getBytes(16);c.getLittleEndian32();c.getLittleEndian32();c.skipPosition(32);f=c.getLittleEndian32();g=new Image;e=c.getPosition();d[0]=c.getData().subarray(e,e+f);c=new Blob(d,b);g.src=URL.createObjectURL(c);x.addImg(g);break;case 270:x.flushImgs();break;case 273:break;case 260:break;case 276:c.getBytes(16);f=c.getLittleEndian32();
e=c.getPosition()+f;c.skipPosition(8);g=c.getLittleEndian32();svGlobal.logger.info("window state:"+g);h=c.getLittleEndian32();k=c.getLittleEndian32();g=c.getLittleEndian32();f=c.getLittleEndian32();c.skipPosition(8);l=c.getLittleEndian32();m=c.getLittleEndian32();svGlobal.logger.info("Window rect, left:"+g+" top:"+f+" w:"+h+" h:"+k+" cl:"+l+" ct:"+m);c.setPosition(e);e=c.getLittleEndian32();for(e=c.getPosition()+e;c.getPosition()<e;){l=c.getLittleEndian32();m=c.getLittleEndian32();var p=c.getLittleEndian32(),
q=c.getLittleEndian32();svGlobal.logger.info("visible region, l:"+m+" t:"+l+" r:"+q+" b:"+p)}x.setImgRect(g,f,h,k);break;case 1:case 2:break;default:svGlobal.logger.warn("unknown function:"+f)}break;default:svGlobal.logger.warn("unkown interface:"+e)}};return a}());ga||f.addDynamicChannel(g())}}};this.resetStatus=Ja;this.exeAppCmd=function(a){var b=q.getFocused();b&&b.exeCommand(a)};this.activateApp=function(a){var b;(b=hi5.tool.isNumber(a)?q.getWinById(a):q.getMainWinByAppId(a))?b.activate(1):svGlobal.logger.warn("No window found in "+
a)};this.reconnect=function(a,b,c){void 0==c&&(c=t.forceReconnect||!1);if(!J&&!c)return!1;k.minWidth&&a<k.minWidth&&(a=k.minWidth);k.minHeight&&b<k.minHeight&&(b=k.minHeight);a&=-4;b&=-4;if(!c&&4>Math.abs(a-D)&&4>Math.abs(b-K))return!1;if(H&&H.enabled)H.applyResolution(a,b);else if(Sa&&ia||c||V&&!Sa)ia=!1,svGlobal.logger.info("reconnecting..."),A("8E0"+a+"\t"+b),Q&&(Q.remoteLockFlags=0,Q.checkLockFlags=!0);return!0};this.notify=function(a,b){a="8E6"+a;b&&(a+="\t"+b.join(";"));A(a)};this.getUploadManager=
function(){return R};this.addSurface=function(a){if(!q.hasSurface(a)&&(za||x.setContext(a.context),!q.hasSurface(a)||!a.railWin)){ga&&a.setPlayerMode();k.mouseMoveEmu&&(a.mouseMoveEmu=Z(k.mouseMoveEmu));a.setSize(50,50,"hidden");var b=a.getFreeSpace();0==D&&(D=b.width);0==K&&(K=b.height);a.setConfig(t);q.addSurface(a);ha(D,K,!1,k.monitorDef?!0:!1);a.setController(Q);a.setTouchpad(Z(k.touchpad));var c=b=Z(k.mapClipboard),e=b;void 0!=k.copyToLocal?c=Z(k.copyToLocal):void 0!=t.copyToLocal&&(c=t.copyToLocal);
void 0!=k.copyToRemote?e=Z(k.copyToRemote):void 0!=t.copyToRemote&&(e=t.copyToRemote);a.setClipboard(b,c,e);Ra&&Za(a);k.invitation&&(q.setReadOnly(!0),b=hi5.$("requestControl"))&&(b.disabled=!1);a.run(parseInt(k.keyboard||1033,10))}};this.getRunninApps=this.getRunningApps=function(){for(var a=[],b=0,c=q.size();b<c;b++)q.getSurface(b).railWin.getMain(q.zOrders)&&a.push(q.getSurface(b).railWin.getMain(q.zOrders).titleInfo);return a};this.startApp=function(a,b,c){b=b||"";c=c||"";A("8C2"+a+"\t"+b+"\t"+
c);var e=q.getSurface(q.size()-1);e&&(e.remoteApp=new $a(a,b,c))};this.startExitingApp=function(a){a=q.popWins(a);for(var b=a.length-1;0<=b;b--)q.addWin(a[b])};this.VirtualChannel=function(){return new Ka(143)};this.GatewayChannel=function(){return new Ka(28)};this.DynamicChannel=function(){return new Ka(64)};this.addChannel=function(a){ea[a.name]=a};this.addGatewayChannel=function(a){fa[a.name]=a};this.addDynamicChannel=function(a){G.names.push(a.name);G[a.name]=a;G.count++};if(Z(k.smartCard)){var xa=
new f.GatewayChannel,Ua=null;xa.name="SCARDSTB";xa.onopen=function(){Ua=document.getElementById(hi5.appcfg.clientAppletId||"clientApplet")};xa.process=function(a){var b=null;if(Ua){var c=a.getPosition();a=hi5.Base64.enc(a.getData(),a.getEnd()-c,c);try{a=Ua.deviceControl(a),b=hi5.Base64.dec(a,0)}catch(e){svGlobal.logger.warn(e)}}b||(b=[0]);a=new hi5.DataBuffer(b);a.markEnd(b.length);xa.send(a)};f.addGatewayChannel(xa)}var Na={type:6,data:null};this.run=function(){bb();F.supportWebAudio&&F.iOSFix()};
this.getDesktop=function(){return x};this.mouseDown=function(a,b,c){V&&A("80"+a+"\t"+b+"\t"+c)};this.mouseMove=function(a,b){V&&A("82"+a+"\t"+b)};this.mouseUp=function(a,b,c){V&&A("81"+a+"\t"+b+"\t"+c)};this.writeKeyCode=function(a,b){V&&A("8B"+(a?0:49152)+"\t"+b)};this.writeScancode=function(a,b){V&&("number"==typeof a?(A("840\t"+a),A("8449152\t"+a)):A("84"+(a?0:49152)+"\t"+b))};var P=new RdpBuffer([],0,0);this.suppressOutput=function(a){if(!f.sessionInfo.suppressOutput)return!1;void 0==a&&(a=!0);
var b=new Uint8Array(a?3:11);b[0]=146;b[1]=3;b[2]=a?1:0;a||(b[3]=Da,b[4]=Da>>8,b[5]=Ca,b[6]=Ca>>8,b[7]=Ea,b[8]=Ea>>8,b[9]=Fa,b[10]=Fa>>8);A(b.buffer);return!0};this.refreshOutput=function(a,b,c,e){var d=new Uint8Array(c?11:3);d[0]=146;d[1]=3;d[2]=2;c&&(d[3]=a,d[4]=a>>8,d[5]=b,d[6]=b>>8,d[7]=c,d[8]=c>>8,d[9]=e,d[10]=e>>8);A(d.buffer)};this.sendPing=function(a){var b=new Uint8Array(a?2+a.length:2);b[0]=146;b[1]=0;a&&b.set(a,2);A(b.buffer)};this.startPing=function(a,b){b=b||0;O||(O=new hi5.tool.ResponseMonitor(function(){V&&
f.sendPing()},function(){if(V&&f.onnoresponse)return f.onnoresponse()}));O.setInterval(a,b);var c=new Uint8Array(4);c[0]=146;c[1]=2;c[2]=a;c[3]=b;A(c.buffer);setTimeout(function(){O.check()},1E3*(a+b));L?L.postMessage({type:0,cmd:6,start:1}):(C.onSlowPath=C.onFastPath=jb,C.onReqHistory=function(){jb(15555)})};this.stopPing=function(){O&&O.stop();L?L.postMessage({type:0,cmd:6,start:0}):C.onSlowPath=C.onFastPath=C.onReqHistory=null};var W=null,qb=0;this.play=function(){A("F3")};this.pause=function(){A("F2")};
this.scan=function(a){A("F4"+(a?"1":"0"))};this.seek=function(a){var b=q.getFocused();b&&J&&(A("F4"+(a?"1":"0")+"\t"+(a/b.getScale().x|0)),x.pause(!0))};var la=Y=S=0;var ka=22050;var pb=!1;this.showMessage=function(a,b,c){f&&f.displayMsg&&a&&((b=b||q.getFocused())?b.showMessage(a,c):hi5.notifications.notify({msg:a,timeout:c||0}))};this._unload=sa;this.close=function(){svGlobal.logger.info("closing...");x&&x.isSendingHistory()?(svGlobal.logger.warn("In the middle of sending history, close delayed"),
setTimeout(sb,2222)):sb()};hi5.browser.isChromeApp?chrome.runtime.onSuspend.addListener(f.close):window.addEventListener("unload",f.close,!1)}
Rdp.languageToKeyboard={af:0,sq:0,ar:1025,"ar-SA":1025,"ar-IQ":0,"ar-EG":0,"ar-LY":0,"ar-DZ":0,"ar-MA":0,"ar-TN":0,"ar-OM":0,"ar-YE":0,"ar-SY":0,"ar-JO":0,"ar-LB":0,"ar-KW":0,"ar-AE":0,"ar-BH":0,"ar-QA":0,eu:0,bg:0,be:0,ca:0,zh:2052,"zh-TW":1028,"zh-CN":2052,"zh-HK":1028,"zh-SG":2052,hr:0,cs:0,da:0,nl:1043,"nl-BE":2067,en:1033,"en-US":1033,"en-GB":2057,"en-AU":0,"en-CA":4105,"en-NA":0,"en-IE":0,"en-ZA":0,"en-JM":0,"en-BZ":0,et:0,fo:0,fa:0,fi:0,fr:1036,"fr-BE":2060,"fr-CA":3084,"fr-CH":4108,"fr-LU":0,
gd:0,"gd-IE":0,de:1031,"de-CH":2055,"de-AT":0,"de-LU":0,"de-LI":0,el:0,he:1037,hi:0,hu:0,is:1039,id:0,it:1040,"it-CH":66576,ja:3758162961,ko:3758162962,lv:0,lt:0,mk:0,mt:0,nb:1044,nn:1083,no:1044,pl:1045,pt:2070,"pt-BR":1046,rm:0,ro:0,"ro-MO":0,ru:1049,"ru-MO":0,sr:0,sk:0,sl:0,sb:0,es:1034,"es-AR":0,"es-GT":0,"es-CR":0,"es-PA":0,"es-DO":0,"es-MX":2058,"es-VE":0,"es-CO":0,"es-PE":0,"es-EC":0,"es-CL":0,"es-UY":0,"es-PY":0,"es-BO":0,"es-SV":0,"es-HN":0,"es-NI":0,"es-PR":0,sx:0,sv:1053,"sv-FI":0,th:0,
ts:0,tn:0,tr:1055,uk:0,ur:0,ve:0,vi:0,xh:0,ji:0,zu:0,detect:function(){var m=navigator&&(navigator.language||navigator.userLanguage),z=Rdp.languageToKeyboard[m];if(!z){var I=m.indexOf("-");I&&(z=Rdp.languageToKeyboard[m.substring(0,I)])}z||(console.log("No valid layout for "+m),z=1033);return z}};svGlobal.Rdp||(svGlobal.Rdp=Rdp);var RdpBuffer=hi5.DataBuffer;
